/*!
 * chessCommonLib - compressed JS
 * @licence chessCommonLib - v0.1.0 (2018-12-11)
 *  qq:93749937 | Licence: helojo
 */

var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(t,i,n){void 0===i&&(i=100),void 0===n&&(n=100);var o=e.call(this)||this;return o.skinName=t||"chessCommonLib.HeadSkin",o.width=i,o.height=n,o}return __extends(i,e),i.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i)},Object.defineProperty(i.prototype,"headUrl",{get:function(){return this._headUrl},set:function(t){this._headUrl=t;try{this.avar_img&&(this.avar_img.source=this._headUrl)}catch(t){this.avar_img.source=i.DefaultHead}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frame",{get:function(){return this._frame},set:function(t){i.DefaulVip&&(this._frame=t,this.avarFrame_img&&(this.avarFrame_img.source=this._frame,this.avarFrame_img.scaleX=this.avarFrame_img.scaleY=this.headScale)),this.avarFrame_img.visible=i.DefaulVip},enumerable:!0,configurable:!0}),i.prototype.setVipAnim=function(t,e,i,n){this._vipAnim=t,i||(i=this.width/2),n||(n=this.height/2),void 0!=this.anim&&(uniLib.DragonUtils.removeFastDragonbyContainer(this),this.anim=null),"vip9"==e?this.anim=uniLib.DragonUtils.showFastDragon(this._vipAnim,e,uniLib.DragonType.ARMATURE,i,n,this):(this.anim=uniLib.DragonUtils.showFastDragon(this._vipAnim,"newAnimation",uniLib.DragonType.MovieClip,i,n,this),e&&this.anim.play(e,0)),this.anim.scaleX=this.anim.scaleY=this.headScale,this.anim.touchEnabled=!1},i.prototype.setHeadFrame=function(e,n){var o;if(n&&i.PersonalImageAble&&(o=t.FashionDataUtils.getPersonVipLevel(n)),void 0==o)this.vipLevel=e;else if(o<30)this.vipLevel=o;else{var s=t.ConfigMgr.getInstance().getheadMcById(o);s&&this.setVipAnim(s.head_mc[0],s.head_mc[1])}},Object.defineProperty(i.prototype,"vipLevel",{set:function(e){e||(e=0);var n=t.ConfigMgr.getInstance().getVipByLevel(e);if(n)if(n.head_mc&&i.PersonalImageAble){var o=t.ConfigMgr.getInstance().getheadMcById(n.head_mc);o&&this.setVipAnim(o.head_mc[0],o.head_mc[1])}else this.frame=n.head_frame},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){if(e.prototype.childrenCreated.call(this),this.headScale=this.width/i.DefaultWH,this._headUrl)try{this.avar_img?this.avar_img.source=this._headUrl:this.avar_img.source=i.DefaultHead}catch(t){console.error(this._headUrl+" error.."),this.avar_img.source=i.DefaultHead}else this.avar_img.source=i.DefaultHead;this._frame&&(this.avarFrame_img.source=this._frame,this.avarFrame_img.scaleX=this.avarFrame_img.scaleY=this.headScale),i.DefaultIcon||(this.gift_icon.visible=!1),i.DefaulInfoBg&&(this.info_bg.visible=!0,this.info_bg.scaleX=this.info_bg.scaleY=this.headScale),this.touchChildren=!0,this.touchEnabled=!1,this.avar_img.touchEnabled=!0,this.avarFrame_img.touchEnabled=!1,this.gift_icon.scaleX=this.gift_icon.scaleY=this.headScale,this.gift_icon.x=this.gift_icon.y=-20*this.headScale},i.prototype.destroy=function(){this.frame=null,this.anim&&uniLib.DragonUtils.removeFastDragonbyContainer(this)},i.PersonalImageAble=!0,i.DefaultHead="default_avar_png",i.DefaultIcon=!0,i.DefaulVip=!0,i.DefaulInfoBg=!1,i.DefaultWH=106,i}(eui.Component);t.Head=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=!1,i=!1;t.init=function(i,n,o){if(1!=e){e=!0;var s,r;if(i||(i=new t.initOptions),null==i.resConfig&&(i.resRoot="chessCommonLib/resource/",i.resConfig="chessCommonLib/resource/chessCommonLib.res.json",i.thmConfig="chessCommonLib/resource/chessCommonLib.thm.json",i.gameEui="chessCommonEui.json",1!=i.remoteMode&&(i.remoteMode=!1)),1==uniLib.Global.isH5&&(i.remoteMode=!0),1==i.remoteMode){var h=uniLib.Global.CdnDomains[0];i.resConfig=h+i.resConfig,i.resRoot=h+i.resRoot,i.thmConfig=h+i.thmConfig}var a=function(t){void 0===t&&(t=null),s=!0,1==r&&n.call(o)},c=function(){uniLib.ResUtils.getTheme(i.thmConfig,function(){a()},function(){egret.Capabilities.engineVersion<"5.1.0"?uniLib.TipsUtils.showConfirm("chessCommon 皮肤初始化失败,是否重试？取消将返回大厅","提示","确定",c):l()},this,"","content")},l=function(){uniLib.ResUtils.getTheme(i.resConfig.substring(0,i.resConfig.lastIndexOf("/")+1)+i.gameEui,function(){a()},function(){window.DEBUG?(console.error("找不到游戏的gameEui文件,请检查该游戏引擎是否已经升级到5.1.x以上版本！！！"),c()):uniLib.TipsUtils.showConfirm("chessCommon 皮肤初始化失败,是否重试？取消将返回大厅","提示","确定",l)},this)};console.log("## chessConfig ##"+i.resConfig+":"+i.resRoot),uniLib.ResLoadMgr.instance.loadConfig(i.resConfig,i.resConfig.substring(0,i.resConfig.lastIndexOf("/")+1),function(t){r=!0,i.thmConfig&&""!=i.thmConfig?egret.Capabilities.engineVersion<"5.1.0"?c():window&&void 0!=window.JSONParseClass?l():c():s=!0,1==s&&n.call(o)},o),uniLib.Global.addEventListener(uniLib.ZqEvent.NATIVE_TO_EGERET,this.onExiteGame,this)}},t.onExiteGame=function(e){if(t.ConfigMgr.getInstance().tableInited()&&e.param.cmd==uniLib.ZQGameSdk.EXITGAME&&!i){i=!0;var n="退出",o="取消";t.LoadGameTipUtil.showExitConfrimTxt||(n=" ",o=" ");var s=new uniLib.MsgBox(t.LoadGameTipUtil.ExitTipText,"提示",n,function(){uniLib.ZQGameSdk.exit(),i=!1},o,function(){i=!1});uniLib.PopUpMgr.addPopUp(s,null,!0,!0,0,uniLib.PopUpEffect.CENTER)}}}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(i,n,o,s){var r=e.call(this)||this;return r._commonPanel=new t.CommonPanel(i,n,o,s),r}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addChildAt(this._commonPanel,0),this.initUI(),this.addEvent()},i.prototype.initUI=function(){},i.prototype.addEvent=function(){},i.prototype.removeEvent=function(){},i.prototype.destroy=function(){this.removeEvent(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i}(eui.Component);t.BaseEuiPanel=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(t){function e(i,n,o,s){var r=t.call(this)||this;return r.skinName=s||e.exml,r._titleStr=i,r._width=n,r._height=o,r}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initUI(),this.addEvent()},e.prototype.initUI=function(){this._width&&(this.width=this._width),this._height&&(this.height=this._height),this._titleStr&&(RES.getRes(this._titleStr)?this._title.source=this._titleStr:RES.getRes(this._titleStr+"_png")?this._title.source=this._titleStr+"_png":RES.getRes(this._titleStr+"_jpg")&&(this._title.source=this._titleStr+"_jpg"))},e.prototype.addEvent=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this)},e.prototype.removeEvent=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this)},e.prototype.destroy=function(){this.removeEvent(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},e.prototype.btnClick=function(t){switch(t.target){case this._closeBtn:uniLib.PopUpMgr.removePopUp(this.parent)}},e.setDefaultSkin=function(t){e.exml=t},e.exml="chessCommonLib.CommonPanelSkin",e}(eui.Component);t.CommonPanel=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i._noticeArr=[],i._isHundred=!0,i._isDestroy=!1,i.visible=!1,i.skinName="chessCommonLib.SysMsgMcSkin",i}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initUI()},i.prototype.initUI=function(){this._buffer=30,this.touchEnabled=!1,this.touchChildren=!0,this._worldchat.visible=!1,uniLib.Global.addEventListener(uniLib.ZqEvent.CHAT_IMPORTANT,this.onNoticeCome,this),this._msgContain=new egret.DisplayObjectContainer,this._msgContain.x=10,this._msgContain.y=7,this.addChild(this._msgContain),this._msgContain.scrollRect=new egret.Rectangle(0,0,540,25),this._noticePanel=new egret.DisplayObjectContainer,this._msgContain.addChild(this._noticePanel),this._msgTxt=this.createTextFeild(),this._noticePanel.addChild(this._msgTxt),this._vipIcon.parent.removeChild(this._vipIcon),this._noticePanel.addChild(this._vipIcon),this._noticeArr=[]},i.prototype.removeListen=function(){uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_IMPORTANT,this.onNoticeCome,this)},i.prototype.clickHandle=function(e){uniLib.Global.dispatchEvent(t.CommonModelEvent.SYSMSG_CLICK)},i.prototype.setDefaultMsg=function(t){this._defaultMsg=t,this.noticeTest()},i.prototype.setLoop=function(t){this._loop=t},i.prototype.noticeTest=function(){if(this._msgTxt&&t.ConfigMgr.getInstance().gameOptions.notice&&this._defaultMsg){var e=new Pmd.CommonChatUserPmd_CS;e.info=this._defaultMsg,e.name="系统公告",this._noticeArr.push(e),this.visible=!0,this.scrollNext()}},i.prototype.startScroll=function(){egret.Tween.removeTweens(this._noticePanel),this._noticePanel.x=540+this._buffer;var t=this._noticePanel.width<540?540:this._noticePanel.width;egret.Tween.get(this._noticePanel).to({x:-(this._noticePanel.width+this._buffer)},10*(t+this._buffer)).call(this.scrollNext,this)},i.prototype.scrollNext=function(){this._noticeArr.length>0?(this.operateText(this._noticeArr.shift()),this.startScroll()):this._loop?this.noticeTest():this.scrollEnd()},i.prototype.scrollEnd=function(){egret.Tween.removeTweens(this._noticePanel),this.visible=!1},i.prototype.onNoticeCome=function(t){var e=t.param;this._noticeArr.push(e),this.visible||(this.visible=!0),this.scrollNext()},i.prototype.operateText=function(t){var e=t.info.split("@!$#%^"),i=decodeURIComponent(e[0]),n=16711918;e.length>1&&!isNaN(Number(e[1]))?(this._vipIcon.visible=!0,this._vipIcon.source="vip_small"+Number(e[1])+"_png",this._vipIcon.x=0,this._noticePanel.addChild(this._vipIcon),this._msgTxt.x=this._vipIcon.x+this._vipIcon.width-10,n=16777086):(this._vipIcon.visible=!1,this._msgTxt.x=0),this._noticePanel.addChild(this._msgTxt),this._msgTxt.textFlow=new Array({text:"【"+t.name+"】：",style:{textColor:n}},{text:i})},i.prototype.destroy=function(){this._isDestroy||(this._isDestroy=!0,uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_IMPORTANT,this.onNoticeCome,this),this.scrollEnd(),this._msgTxt=null,this._noticeArr=null,this._msgContain=null,this._vipIcon=null,this._noticePanel=null)},i.prototype.createTextFeild=function(){var t=new egret.TextField;return t.fontFamily="Microsoft YaHei",t.textColor=16777215,t.textAlign=egret.HorizontalAlign.LEFT,t.size=24,t.multiline=!1,t.verticalAlign=egret.VerticalAlign.MIDDLE,t},i}(eui.Component);t.SysMsgImportant=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i._noticeArr=[],i._isDestroy=!1,i._isHundred=!0,void 0!=t&&(i._isHundred=t),i.visible=!1,i.skinName="chessCommonLib.SysMsgMcSkin",i}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initUI()},i.prototype.initUI=function(){this._buffer=30,this.touchEnabled=!1,this.touchChildren=!0,t.ConfigMgr.getInstance().gameOptions.notice&&(uniLib.Global.addEventListener(uniLib.ZqEvent.CHAT_GM,this.onNoticeCome,this),uniLib.Global.addEventListener(uniLib.ZqEvent.CHAT_SYSTEM,this.onNoticeCome,this),uniLib.Global.addEventListener(uniLib.ZqEvent.CHAT_HORN,this.onNoticeCome,this),uniLib.Global.addEventListener(uniLib.ZqEvent.CHAT_IMPORTANT,this.onNoticeCome,this),uniLib.Global.isInGame?this._isHundred?uniLib.Global.addEventListener(uniLib.ZqEvent.CHAT_HUNDRED,this.onNoticeCome,this):uniLib.Global.addEventListener(uniLib.ZqEvent.CHAT_COMMONGAME,this.onNoticeCome,this):uniLib.Global.addEventListener(uniLib.ZqEvent.CHAT_LOBBY,this.onNoticeCome,this)),(i.isShowWorldChat=t.ConfigMgr.getInstance().gameOptions.horn)&&this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this),this._worldchat.visible=i.isShowWorldChat,this._msgContain=new egret.DisplayObjectContainer,this._msgContain.x=10,this._msgContain.y=7,this.addChild(this._msgContain),this._msgContain.scrollRect=new egret.Rectangle(0,0,540,25),this._noticePanel=new egret.DisplayObjectContainer,this._msgContain.addChild(this._noticePanel),this._msgTxt=this.createTextFeild(),this._noticePanel.addChild(this._msgTxt),this._vipIcon.parent.removeChild(this._vipIcon),this._noticePanel.addChild(this._vipIcon),this._noticeArr=[]},i.prototype.removeListen=function(){uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_GM,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_HORN,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_COMMONGAME,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_SYSTEM,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_LOBBY,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_IMPORTANT,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_HUNDRED,this.onNoticeCome,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this)},i.prototype.clickHandle=function(e){uniLib.Global.dispatchEvent(t.CommonModelEvent.SYSMSG_CLICK)},i.prototype.setDefaultMsg=function(t){this._defaultMsg=t,this.noticeTest()},i.prototype.setLoop=function(t){this._loop=t},i.prototype.noticeTest=function(){if(this._msgTxt&&t.ConfigMgr.getInstance().gameOptions.notice&&this._defaultMsg){var e=new Pmd.CommonChatUserPmd_CS;e.info=this._defaultMsg,e.name="系统公告",this._noticeArr.push(e),this.visible=!0,this.scrollNext()}},i.prototype.startScroll=function(){egret.Tween.removeTweens(this._noticePanel),this._noticePanel.x=540+this._buffer;var t=this._noticePanel.width<540?540:this._noticePanel.width;egret.Tween.get(this._noticePanel).to({x:-(this._noticePanel.width+this._buffer)},10*(t+this._buffer)).call(this.scrollNext,this)},i.prototype.scrollNext=function(){this._noticeArr.length>0?(this.operateText(this._noticeArr.shift()),this.startScroll()):this._loop?this.noticeTest():this.scrollEnd()},i.prototype.scrollEnd=function(){egret.Tween.removeTweens(this._noticePanel),this.visible=!1},i.prototype.onNoticeCome=function(t){var e=t.param;console.log("notice："+e),this._noticeArr.push(e),this.visible||(this.visible=!0),this.scrollNext()},i.prototype.operateText=function(t){var e=t.info.split("@!$#%^"),i=decodeURIComponent(e[0]),n=16711918;e.length>1&&!isNaN(Number(e[1]))?(this._vipIcon.visible=!0,this._vipIcon.source="vip_small"+Number(e[1])+"_png",this._vipIcon.x=0,this._noticePanel.addChild(this._vipIcon),this._msgTxt.x=this._vipIcon.x+this._vipIcon.width-10,n=9==Number(e[1])?16711680:16777215):(this._vipIcon.visible=!1,this._msgTxt.x=0),this._noticePanel.addChild(this._msgTxt),this._msgTxt.textFlow=new Array({text:"【"+t.name+"】：",style:{textColor:n}},{text:i})},i.prototype.destroy=function(){this._isDestroy||(this._isDestroy=!0,uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_GM,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_HORN,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_COMMONGAME,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_SYSTEM,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_LOBBY,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_IMPORTANT,this.onNoticeCome,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.CHAT_HUNDRED,this.onNoticeCome,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandle,this),this.scrollEnd(),this._msgTxt=null,this._noticeArr=null,this._msgContain=null,this._vipIcon=null,this._noticePanel=null)},i.prototype.createTextFeild=function(){var t=new egret.TextField;return t.fontFamily="Microsoft YaHei",t.textColor=16777215,t.textAlign=egret.HorizontalAlign.LEFT,t.size=24,t.multiline=!1,t.verticalAlign=egret.VerticalAlign.MIDDLE,t},i.isShowWorldChat=!0,i}(eui.Component);t.SysMsgMc=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function n(t){var i=e.call(this)||this;return i.str="",i.offsetX=0,i.offsetY=0,i.isMutiLine=!1,i.inlineWidth=[0,0,0,0,0,0],i.data=t,i.touchEnabled=!1,i.touchChildren=!1,i.init(),console.error("this.chatComponent",i.data),i}return __extends(n,e),n.prototype.init=function(){this.emoj=new egret.Sprite,this.emoj.x=5,this.emoj.y=3,this.addChild(this.emoj),this._MaxWidth=1200},n.prototype.showContent=function(t){void 0===t&&(t=720),this.emoj||(this.emoj=new egret.Sprite,this.emoj.x=10,this.addChild(this.emoj)),this._MaxWidth=t,this.emojArr=[],this.textArr=[],this.contentArr=[],this._height=1;var e=/\([^\(\)]*\)/g,i=this.data,n=(i=this.data).match(e);if(Array.isArray(n))for(a=0;a<n.length;a++){var o=Number(n[a].substring(1,n[a].length-1));this.emojArr.push(o)}var s=i.replace(/\([^\(\)]*\)/g,"/,"),r=s.split("/,");this.textArr=s.split("/,"),uniLib.DisplayUtils.removeAllChildren(this.emoj),this.formatTxt(r,this.emojArr);for(var h=[],a=1;a<this.contentArr.length;a++)for(var c=this.contentArr[a],l=0;l<c.length;l++){var u=c[l];if(u.content){var p=this.getContent(u);u.type,p.y=32*(a-1),h[u.line]||(h[u.line]=0),p.x=h[u.line],h[u.line]=h[u.line]+p.width,this.emoj.addChild(p)}}return this.emoj},n.prototype.formatTxt=function(e,n){for(var o=0;o<e.length;o++){var s,r=!1,h=new t.ChatWordItem(e[o]),a=0;if(n[o]){var c=this.getRes(Number(n[o]));a=(s=new t.ChatImageItem(c)).width,s.destory()}for(var l=e[o].split(""),u=0,p="";h.width+this.inlineWidth[this._height]>this._MaxWidth;){var m=l;m.length=m.length-1,u=m.length,h.destory(),h=new t.ChatWordItem(m.join("")),p=m.join(""),r=!0}if(r){var d=e[o].match(/(<\w{1}>)/g);if(d){for(var _=e[o].replace(/<\w{1}>/g,"/,").split("/,"),f=p.replace(/<\w{1}>/g,"/,").split("/,"),v=void 0,b=0;b<_.length;b++)-1!=_[b].indexOf(f[f.length-1])&&(v=b);h=new t.ChatWordItem(p+d[v])}}var g=e[o].slice(u);if(this.contentArr[this._height]||(this.contentArr[this._height]=[]),this.inlineWidth[this._height]=this.toNumber(this.inlineWidth[this._height])+h.width,this.contentArr[this._height].push(new i(this._height,h.$children[0].text1,h.width,1)),r){this.textArr.splice(o+1,0,g);var C=g.split("");if(new t.ChatWordItem(g).width>this._MaxWidth)for(var L=this.sliceArray(C),y=0;y<L.length;y++){this._height=this._height+1,this.contentArr[this._height]||(this.contentArr[this._height]=[]);E=new t.ChatWordItem(L[y].join(""));this.contentArr[this._height].push(new i(this._height,L[y].join(""),E.width,1)),this.inlineWidth[this._height]=this.toNumber(this.inlineWidth[this._height])+E.width}else{this._height=this._height+1;var E=new t.ChatWordItem(g);this.contentArr[this._height]||(this.contentArr[this._height]=[]),this.contentArr[this._height].push(new i(this._height,g,E.width,1)),this.inlineWidth[this._height]=this.toNumber(this.inlineWidth[this._height])+E.width}}this.inlineWidth[this._height]+a>this._MaxWidth&&(this._height=this._height+1,this.contentArr[this._height]||(this.contentArr[this._height]=[])),this.contentArr[this._height].push(new i(this._height,n[o],a,2)),this.inlineWidth[this._height]=this.toNumber(this.inlineWidth[this._height])+a,h&&h.destory()}},n.prototype.toNumber=function(t){return t?Number(t):0},n.prototype.sliceArray=function(e){for(var i=0,n=[],o=e,s=0,r=0;r<e.length;r++)(i+=new t.ChatWordItem(e[r]).width)>=this._MaxWidth&&(i=0,n.push(o.slice(0,r-s+1)),s=r,o=e.slice(r+1,e.length)),r==e.length-1&&n.push(o.slice(0,r+1));return n},n.prototype.getContent=function(e){var i;if(1==e.type){var n=this.getColor(e.content);i=new t.ChatWordItem(n,!0)}else if(2==e.type){var o=this.getRes(Number(e.content));i=new t.ChatImageItem(o)}return i},n.prototype.getRes=function(t){return t<50?"face_Small_"+t:"min_vip"+(t-100)},n.prototype.getColor=function(t){var e=[],i="";return(t=t.replace(/(^\s*)|(\s*$)/g,"")).match(/<\w{1}>/g)?e=this.getHighOderColor(t):-1!=t.indexOf(this._nickName)&&0==t.indexOf(this._nickName)?(i="0xf8da94",e.push({text:t,color:i}),this.getColor=function(t){var e=[],i="";return(t=t.replace(/(^\s*)|(\s*$)/g,"")).match(/<\w{1}>/g)?e=this.getHighOderColor(t):(i="0xf1dbf8",e.push({text:t,color:i})),e}):(i="0xf1dbf8",e.push({text:t,color:i})),e},n.prototype.getHighOderColor=function(t){for(var e=t.match(/<\w{1}>/g),i=["0xffe097","0xf9e3ff","0xffd200","0x0aaee0"],n=(t=t.replace(/<\w{1}>/g,"/,")).split("/,"),o=[],s=0;s<n.length;s++){var r=e[s]?e[s]:"";o.push({text:n[s],color:i[Number(r[1]-1)]})}return o},n}(egret.Sprite);t.chatComponent=e;var i=function(){return function(t,e,i,n){this.line=t,this.content=e,this.width=i,this.type=n}}()}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function t(){}return t.SEND_SMILEY="send_smiley",t.CHAT_INIT="chat_init",t.WORLD_MSG="world_msg",t.WORLD_MSG_INGAME="world_msg_ingame",t.WORLD_MSG_SELF="world_msg_self",t.WORLD_MSG_SELF_FAIL="world_msg_self_fail",t}();t.ChatEventConsts=e;var i=function(){function t(){}return t.GET_USERINFO="get_userinfo",t.SEND_GIFT_NOTICE="send_gift_notice",t.VOICE_NOTICE="voice_notice",t.RECORD_TIME_OUT="RECORD_TIME_OUT",t.SEND_RECORD="SEND_RECORD",t}();t.ZhiMaEventConsts=i}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e}(egret.EventDispatcher);t.ChatEventDispatcher=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function e(){this.socketName=["SZLobby","uniLib"],this.showTreasure=!0,this.showSsc=!0,this.betLimit=!1,this.isForbidden=!1,this.init()}return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.init=function(){this.ExmlMap={},this.ExmlMap.noSeatExml="chessCommonLib.UserListSkin",this.ExmlMap.noSeatItemExml="chessCommonLib.UserListItemSkin",this.ExmlMap.chatExml="chessCommonLib.ChatListSkin",this.ExmlMap.chatItemExml="chessCommonLib.ChatListItemSkin"},e.handleString=function(t,e){void 0===e&&(e=6);for(var i,n=t;this.getStrRealLength(n)>e;)i=n.length,n=n.substr(0,i-1);return n},e.getStrRealLength=function(t){return Number(t.replace(/[\u0391-\uFFE5]/g,"aa").length)},e.add=function(t,e){if(Array.isArray(e)){for(;e.length>40;)e.shift();e.push(t)}},e.prototype.betHandle=function(e,i){return new Promise(function(e,i){var n=t.CommonVariable.getInstance().selfUserInfo;152!=n.platId&&264!=n.platId&&152!=t.CommonVariable.getInstance().selfUserInfo.originPlatId&&n.vip<1?(this.betLimit=!0,i()):e()})},e}();t.CommonVariable=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.sTime=0,t.startX=0,t.movX=0,t.isMove=!1,t.page=0,t.timeBo=!0,t.jianTime=0,t.pagWidth=888,t.maxPag=2,t.bo=!0,t.skinName="chessCommonLib.LobbyChatFcaePanelSkin",t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchBegin,t),t.addEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),t.scroll.addEventListener(eui.UIEvent.CHANGE_END,t.onScrollEnd,t),t.scroll.throwSpeed=30,t.scroll.bounces=!1,t.init(),t}return __extends(i,e),i.prototype.init=function(){for(var e=[],i=[],n=1;n<=27;n++)e.push(n);for(n=28;n<=48;n++)i.push(n);this.faceList.itemRenderer=t.LobbyChatFaceItem,this.arrCol1=new eui.ArrayCollection(e),this.faceList.dataProvider=this.arrCol1,this.faceList1.itemRenderer=t.LobbyChatFaceItem,this.arrCol2=new eui.ArrayCollection(i),this.faceList1.dataProvider=this.arrCol2,this.pointHandle(this.page)},i.prototype.moveStar=function(t){return 1==this.timeBo&&(this.jianTime=t,this.timeBo=!1),this.sTime=t-this.jianTime,!1},i.prototype.onTouchEnd=function(t){this.scroll.stopAnimation()},i.prototype.onTouchBegin=function(t){egret.startTick(this.moveStar,this),this.startX=this.scroll.viewport.scrollH},i.prototype.onScrollEnd=function(){this.movX=this.scroll.viewport.scrollH;var t=this;if(0!=t.bo){if(t.bo=!1,egret.stopTick(t.moveStar,t),t.timeBo=!0,t.sTime<=500)if(this.startX<this.movX)t.page++;else if(this.startX==this.movX);else{if(0==t.page)return void t.MovePanel();t.page--}else if(this.startX<this.movX){if(!(this.movX-this.startX>this.pagWidth/2))return void t.MovePanel();this.page++}else if(this.startX>this.movX){if(!(this.startX-this.movX>this.pagWidth/2))return void t.MovePanel();this.page--}t.MovePanel()}},i.prototype.test=function(){this.bo=!0},i.prototype.MovePanel=function(){var t=this;this.page<0||(this.page>=this.maxPag&&(this.page=this.maxPag-1),this.pointHandle(this.page),egret.Tween.get(this.scroll.viewport,{loop:!1}).to({scrollH:this.page*this.pagWidth},200).call(function(){return t.test()},this))},i.prototype.pointHandle=function(t){0==t?(this.page1Point1.visible=!1,this.page1Point2.visible=!0,this.page2Point1.visible=!0,this.page2Point2.visible=!1):(this.page1Point1.visible=!0,this.page1Point2.visible=!1,this.page2Point1.visible=!1,this.page2Point2.visible=!0)},i}(eui.Component);t.LobbyChatFaceComponent=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName="chessCommonLib.LobbyChatFcaeItemSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.faceIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showDetail,this)},i.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.faceIcon.source="face_Big_"+this.data,this.faceid=this.data},i.prototype.showDetail=function(){t.ChatEventDispatcher.instance.dispatchEventWith(t.ChatEventConsts.SEND_SMILEY,!1,this.faceid)},i}(eui.ItemRenderer);t.LobbyChatFaceItem=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.str="",t.offsetX=0,t.offsetY=0,t.isMutiLine=!1,t.inlineWidth=[0,0,0,0,0,0],t.skinName="chessCommonLib.LobbyChatListItemSkin",t}return __extends(n,e),n.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.emoj=new egret.Sprite,this.emoj.x=10,this.emoj.y=0,this.addChild(this.emoj),this._MaxWidth=this.chat_lb.width},n.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.Nickname=this.data.nickName,this.emoj&&(uniLib.DisplayUtils.removeAllChildren(this.emoj),uniLib.DisplayUtils.removeFromParent(this.emoj)),this.emoj||(this.emoj=new egret.Sprite,this.emoj.x=10),this.addChild(this.emoj),this.emojArr=[],this.textArr=[],this.contentArr=[],this._height=1;var t=/\([^\(\)]*\)/g,i=this.data.content;this._nickName=this.data.nickName,this.data.nickName&&void 0!=this.data.vip?i="("+Number(100+Number(this.data.vip))+")"+this.data.nickName+": ()"+this.data.content:(i="()"+this.data.content,this.data.nickName=""),this.data.type&&1==this.data.type&&uniLib.Global.isInGame&&(i="(49)"+i);var n=i.match(t);if(Array.isArray(n))for(a=0;a<n.length;a++){var o=Number(n[a].substring(1,n[a].length-1));this.emojArr.push(o)}var s=i.replace(/\([^\(\)]*\)/g,"/,"),r=s.split("/,");this.textArr=s.split("/,"),this.formatTxt(r,this.emojArr);for(var h=[],a=1;a<this.contentArr.length;a++)for(var c=this.contentArr[a],l=0;l<c.length;l++){var u=c[l];if(u.content){var p=this.getContent(u);u.type,p.y=32*(a-1),h[u.line]||(h[u.line]=0),p.x=h[u.line],h[u.line]=h[u.line]+p.width,this.emoj.addChild(p)}}var m="";this.data.vip>0&&(this.vipIcon.source=this.data.vip?"mid_vip"+this.data.vip:"big_vip0",m="占  占"),this.data.type&&1==this.data.type&&uniLib.Global.isInGame&&(m+=" 占");var d=m+this.data.nickName+this.data.content.replace(/\([^\(\)]*\)/g,"　 ");d=d.replace(/<\d{1}>/g,""),this.chat_lb.textFlow=[{text:d+"",style:{textColor:2332964}}],this.name_lb.text=this.data.nickName+":",Number(this.data.vip)<0&&(this.vipIcon.source="",this.chat_lb.text="",this.name_lb.text="",uniLib.DisplayUtils.removeAllChildren(this.emoj),uniLib.DisplayUtils.removeFromParent(this.emoj))},n.prototype.formatTxt=function(e,n){for(var o=0;o<e.length;o++){var s,r=!1,h=new t.ChatWordCalculateItem(e[o]),a=0;if(n[o]){var c=this.getRes(Number(n[o]));a=(s=new t.ChatImageItem(c)).width,s.destory()}for(var l=e[o].split(""),u=0,p="";h.width+this.inlineWidth[this._height]>this._MaxWidth;){var m=l;if(!m.length)return void(this.contentArr=[]);m.length=m.length-1,u=m.length,h.destory(),h=new t.ChatWordCalculateItem(m.join("")),p=m.join(""),r=!0}if(r){var d=e[o].match(/(<\w{1}>)/g);if(d){for(var _=e[o].replace(/<\w{1}>/g,"/,").split("/,"),f=p.replace(/<\w{1}>/g,"/,").split("/,"),v=void 0,b=0;b<_.length;b++)-1!=_[b].indexOf(f[f.length-1])&&(v=b);h=new t.ChatWordCalculateItem(p+d[v])}}var g=e[o].slice(u);if(this.contentArr[this._height]||(this.contentArr[this._height]=[]),this.inlineWidth[this._height]=this.toNumber(this.inlineWidth[this._height])+h.width,this.contentArr[this._height].push(new i(this._height,h.text1,h.width,1)),r){this.textArr.splice(o+1,0,g);var C=g.split("");if(new t.ChatWordCalculateItem(g).width>this._MaxWidth)for(var L=this.sliceArray(C),y=0;y<L.length;y++){this._height=this._height+1,this.contentArr[this._height]||(this.contentArr[this._height]=[]);E=new t.ChatWordCalculateItem(L[y].join(""));this.contentArr[this._height].push(new i(this._height,L[y].join(""),E.width,1)),this.inlineWidth[this._height]=this.toNumber(this.inlineWidth[this._height])+E.width}else{this._height=this._height+1;var E=new t.ChatWordCalculateItem(g);this.contentArr[this._height]||(this.contentArr[this._height]=[]),this.contentArr[this._height].push(new i(this._height,g,E.width,1)),this.inlineWidth[this._height]=this.toNumber(this.inlineWidth[this._height])+E.width}}this.inlineWidth[this._height]+a>this._MaxWidth&&(this._height=this._height+1,this.contentArr[this._height]||(this.contentArr[this._height]=[])),this.contentArr[this._height].push(new i(this._height,n[o],a,2)),this.inlineWidth[this._height]=this.toNumber(this.inlineWidth[this._height])+a,h&&h.destory()}},n.prototype.toNumber=function(t){return t?Number(t):0},n.prototype.sliceArray=function(e){for(var i=0,n=[],o=e,s=0,r=0;r<e.length;r++)(i+=new t.ChatWordCalculateItem(e[r]).width)>=this._MaxWidth&&(i=0,n.push(o.slice(0,r-s+1)),s=r,o=e.slice(r+1,e.length)),r==e.length-1&&n.push(o.slice(0,r+1));return n},n.prototype.getContent=function(e){var i;if(1==e.type){var n=this.getColor(e.content);i=new t.ChatWordItem(n,!0)}else if(2==e.type){var o=this.getRes(Number(e.content));i=new t.ChatImageItem(o)}return i},n.prototype.getRes=function(t){return t<50?"face_Small_"+t:"min_vip"+(t-100)},n.prototype.getColor=function(t){var e=[],i="";return(t=t.replace(/(^\s*)|(\s*$)/g,"")).match(/<\w{1}>/g)?e=this.getHighOderColor(t):-1!=t.indexOf(this._nickName)&&0==t.indexOf(this._nickName)?(i="0xf8da94",e.push({text:t,color:i}),this.getColor=function(t){var e=[],i="";return(t=t.replace(/(^\s*)|(\s*$)/g,"")).match(/<\w{1}>/g)?e=this.getHighOderColor(t):(i="0xf1dbf8",e.push({text:t,color:i})),e}):(i="0xf1dbf8",e.push({text:t,color:i})),e},n.prototype.getHighOderColor=function(t){for(var e=t.match(/<\w{1}>/g),i=["0xffe097","0xf9e3ff","0xffd200","0x0aaee0"],n=(t=t.replace(/<\w{1}>/g,"/,")).split("/,"),o=[],s=0;s<n.length;s++){var r=e[s]?e[s]:"";o.push({text:n[s],color:i[Number(r[1]-1)]})}return o},n}(eui.ItemRenderer);t.LobbyChatListItem=e;var i=function(){return function(t,e,i,n){this.line=t,this.content=e,this.width=i,this.type=n}}()}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.str="",t.offsetX=0,t.offsetY=0,t.isMutiLine=!1,t.inlineWidth=[0,0,0,0,0,0],t.skinName="chessCommonLib.LobbyChatListItemSkin",t}return __extends(n,e),n.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.emoj=new egret.Sprite,this.emoj.x=17,this.emoj.y=7,this.addChild(this.emoj),this._MaxWidth=this.chat_lb.width},n.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.Nickname=this.data.nickName,this.emoj||(this.emoj=new egret.Sprite,this.emoj.x=20,this.addChild(this.emoj)),this.emojArr=[],this.textArr=[],this.contentArr=[],this._height=1;var t=/\([^\(\)]*\)/g,i=this.data.content.match(t);if(Array.isArray(i))for(h=0;h<i.length;h++){var n=Number(i[h].substring(1,i[h].length-1));this.emojArr.push(n)}var o=this.data.content.replace(/\([^\(\)]*\)/g,"/,"),s=o.split("/,");this.textArr=o.split("/,"),uniLib.DisplayUtils.removeAllChildren(this.emoj),this.formatTxt(s,this.emojArr);for(var r=[0,0,0,0],h=1;h<this.contentArr.length;h++)for(var a=this.contentArr[h],c=0;c<a.length;c++){var l=a[c];if(l.content){var u=this.getContent(l);l.type,u.y=32*h,r[l.line]||(r[l.line]=0),u.x=r[l.line],r[l.line]=r[l.line]+u.width,this.emoj.addChild(u)}}this.data.vip>0&&(this.vipIcon.source=this.data.vip?"mid_vip"+this.data.vip:"big_vip0");var p=this.data.content.replace(/\([^\(\)]*\)/g,"　 ");this.chat_lb.textFlow=[{text:p+"",style:{textColor:16777215}}],this.name_lb.text=this.data.nickName,Number(this.data.vip)<0&&(this.vipIcon.source="",this.chat_lb.text="",this.name_lb.text="")},n.prototype.formatTxt=function(e,n){for(var o=0;o<e.length;o++){var s=!1,r=new t.ChatWordItem(e[o]),h=e[o].split(""),a=0,c=0;for(n[o]&&(c=new t.ChatImageItem("face_Small_"+n[o]).width);r.width+this.inlineWidth[this._height]>this._MaxWidth;){var l=h;l.length=l.length-1,a=l.length,r=new t.ChatWordItem(l.join("")),s=!0}var u=e[o].slice(a);r.$children[0].text;if(this.contentArr[this._height]||(this.contentArr[this._height]=[]),this.inlineWidth[this._height]=this.toNumber(this.inlineWidth[this._height])+r.width,this.contentArr[this._height].push(new i(this._height,r.$children[0].text,r.width,1)),s){this.textArr.splice(o+1,0,u);var p=u.split("");if(new t.ChatWordItem(e[o]).width>this._MaxWidth)for(var m=Math.floor(this._MaxWidth/this.chat_lb.size),d=this.sliceArray(p,m),_=0;_<d.length;_++){this._height=this._height+1,this.contentArr[this._height]||(this.contentArr[this._height]=[]);f=new t.ChatWordItem(d[_].join(""));this.contentArr[this._height].push(new i(this._height,d[_].join(""),f.width,1)),this.inlineWidth[this._height]=this.toNumber(this.inlineWidth[this._height])+f.width}else{this._height=this._height+1;var f=new t.ChatWordItem(u);this.contentArr[this._height]||(this.contentArr[this._height]=[]),this.contentArr[this._height].push(new i(this._height,u,f.width,1)),this.inlineWidth[this._height]=this.toNumber(this.inlineWidth[this._height])+f.width}}this.inlineWidth[this._height]+c>this._MaxWidth&&(this._height=this._height+1,this.contentArr[this._height]||(this.contentArr[this._height]=[])),this.contentArr[this._height].push(new i(this._height,n[o],c,2)),this.inlineWidth[this._height]=this.toNumber(this.inlineWidth[this._height])+c,console.error("目前的内容数组",this.contentArr)}},n.prototype.toNumber=function(t){return t?Number(t):0},n.prototype.sliceArray=function(t,e){for(var i=[],n=0;n<Math.ceil(t.length/e);n++){var o=n*e,s=o+e;i.push(t.slice(o,s))}return i},n.prototype.getContent=function(e){var i;return 1==e.type?i=new t.ChatWordItem(e.content):2==e.type&&(i=new t.ChatImageItem("face_Small_"+e.content)),i},n}(eui.ItemRenderer);t.LobbyChatListItemTemp=e;var i=function(){return function(t,e,i,n){this.line=t,this.content=e,this.width=i,this.type=n}}()}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(chessCommonLib){var LobbyChatPanel=function(_super){function LobbyChatPanel(){var t=_super.call(this)||this;return t.isTour=!1,t.once(eui.UIEvent.COMPLETE,t.uiCompHandler,t),t.skinName="chessCommonLib.LobbyChatPanelSkin",t}return __extends(LobbyChatPanel,_super),LobbyChatPanel.prototype.childrenCreated=function(){_super.prototype.childrenCreated.call(this)},LobbyChatPanel.prototype.uiCompHandler=function(){this.chatFacePanel=new chessCommonLib.LobbyChatFaceComponent,this.chatFacePanel.touchEnabled=!0,this.chatFacePanel.x=178,this.chatFacePanel.y=194,this.addChild(this.chatFacePanel),this.chatFacePanel.visible=!1,this.touchMask.touchEnabled=!1,this.init()},LobbyChatPanel.prototype.init=function(){var t=this;this.chatContentLable.text="",this.chatContentLable.restrict="^\r\n",this.chatData=[],this.chatList.useVirtualLayout=!1,this.chatList.itemRenderer=chessCommonLib.LobbyChatListItem,this.arrCol=new eui.ArrayCollection(this.chatData),this.chatList.dataProvider=this.arrCol,this.chatScroll.visible=!1,this.cartonControl(!0),this.tempTimer2=egret.setTimeout(function(){t.getChatData()},this,200),this.addEvent(),this.arrCol.removeAll(),this.arrCol.refresh()},LobbyChatPanel.prototype.isInGame=function(){uniLib.Global.isInGame&&(this.hornIcon.visible=!1,this.hornNum.visible=!1)},LobbyChatPanel.prototype.initView=function(){this.chatScroll.visible=!0,this.visible=!0,this.BtnHandle()},LobbyChatPanel.prototype.addEvent=function(){this.touchMask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showFacePanel,this),this.chatFaceIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showFacePanel,this),this.chatClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chatCloseHander,this),this.chatSend.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendChatMsg,this),this.chatContentLable.addEventListener(egret.Event.CHANGE,this.onChang,this),this.chatContentLable.addEventListener(eui.UIEvent.FOCUS_OUT,this.hidephonevc,this),chessCommonLib.ChatEventDispatcher.instance.addEventListener(chessCommonLib.ChatEventConsts.SEND_SMILEY,this.showFaceText,this),uniLib.Global.addEventListener(chessCommonLib.ChatEventConsts.CHAT_INIT,this.initData,this),uniLib.Global.addEventListener(chessCommonLib.ChatEventConsts.WORLD_MSG,this.onGetSZchatInfo,this),uniLib.Global.addEventListener(chessCommonLib.ChatEventConsts.WORLD_MSG_INGAME,this.onGetSZchatInfo,this),uniLib.Global.addEventListener(chessCommonLib.ChatEventConsts.WORLD_MSG_SELF,this.onGetSZchatInfoself,this),uniLib.Global.addEventListener(chessCommonLib.ChatEventConsts.WORLD_MSG_SELF_FAIL,this.selfFail,this)},LobbyChatPanel.prototype.removeEvent=function(){this.chatContentLable.removeEventListener(eui.UIEvent.FOCUS_OUT,this.hidephonevc,this),this.touchMask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showFacePanel,this),this.chatFaceIcon.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showFacePanel,this),this.chatClose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.chatCloseHander,this),this.chatSend.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendChatMsg,this),this.chatContentLable.removeEventListener(egret.Event.CHANGE,this.onChang,this),chessCommonLib.ChatEventDispatcher.instance.removeEventListener(chessCommonLib.ChatEventConsts.SEND_SMILEY,this.showFaceText,this),uniLib.Global.removeEventListener(chessCommonLib.ChatEventConsts.CHAT_INIT,this.initData,this),uniLib.Global.removeEventListener(chessCommonLib.ChatEventConsts.WORLD_MSG,this.onGetSZchatInfo,this),uniLib.Global.removeEventListener(chessCommonLib.ChatEventConsts.WORLD_MSG_INGAME,this.onGetSZchatInfo,this),uniLib.Global.removeEventListener(chessCommonLib.ChatEventConsts.WORLD_MSG_SELF,this.onGetSZchatInfoself,this),uniLib.Global.removeEventListener(chessCommonLib.ChatEventConsts.WORLD_MSG_SELF_FAIL,this.selfFail,this)},LobbyChatPanel.prototype.getChatData=function(){this.cartonControl(!0),this.chatScroll.visible=!1,this.chatList.once(egret.Event.ADDED,this.showRender,this),this.tempTimer=egret.setTimeout(function(){var req=new Cmd.GetCommonChatInfoLobby_C,socket=eval(chessCommonLib.CommonVariable.getInstance().socketName[0]);if(socket.NetMgr.tcpSend(req),uniLib.Global.isInGame&&chessCommonLib.CommonVariable.getInstance().socketName[1]){var reqLobby=new Cmd.GetCommonChatInfoLobby_C,socketLobby=eval(chessCommonLib.CommonVariable.getInstance().socketName[1]);socketLobby.NetMgr.tcpSend(reqLobby)}},this,0)},LobbyChatPanel.prototype.initData=function(t){var e=t.param,i=e.info;if(this.chatContentLable.prompt="请在此输入内容，总长度不超过40个字~",e.horn&&(this.hornNum.text="×"+e.horn,0==e.horn&&(this.chatContentLable.prompt="你没有喇叭，无法发布世界消息。请您先购买喇叭~！")),e.state&&1==e.state&&!uniLib.Global.isInGame?(this.chatContentLable.prompt="你是游客，无法发言，请绑定手机号！",this.isTour=!0):this.isTour=!1,Array.isArray(i))for(var n=0;n<i.length;n++)void 0==i[n].type&&(i[n].type=0),void 0==i[n].timestamp&&(i[n].timestamp=0),chessCommonLib.CommonVariable.add({nickName:i[n].nickName,vip:i[n].vipLevel,content:i[n].chatInfo.toString(),type:i[n].type.toString(),timestamp:i[n].timestamp.toString()},this.chatData);this.sortByTimestamp(),this.arrCol.removeAll(),this.arrCol.replaceAll(this.chatData),this.chatList.validateNow(),this.chatScroll.viewport.contentHeight>453&&(this.chatScroll.viewport.scrollV=this.chatScroll.viewport.contentHeight-this.chatScroll.height)},LobbyChatPanel.prototype.showRender=function(){console.error(" 将要更新和呈现显示列表时调度。"),this.cartonControl(!1),this.chatScroll&&(this.chatScroll.visible=!0)},LobbyChatPanel.prototype.sendChatMsg=function(){if(console.error("点击发送",this.chatContentLable.text),""!=this.chatContentLable.text)if(chessCommonLib.CommonVariable.getInstance().isForbidden)this.showFailToast();else{var req=new Cmd.LobbyCommonChatLobby_C;req.chatInfo=this.chatContentLable.text;var socket=eval(chessCommonLib.CommonVariable.getInstance().socketName[0]);socket.NetMgr.tcpSend(req)}else uniLib.TipsUtils.showTipsDownToUp("请输入聊天内容")},LobbyChatPanel.prototype.onGetSZchatInfoself=function(t){this.showRender();var e=t.param;this.chatContentLable.text="",this.counTime=e.remainder,this.counTime>1e3&&(this.counTime=parseInt(this.counTime/1e3+"")),void 0==this.counTime&&(this.counTime=10),this.timerComFunc(),e.horn&&(this.hornNum.text="×"+e.horn,0==e.horn&&(this.chatContentLable.prompt="你没有喇叭，无法发布世界消息。请您先购买喇叭~！")),this._countTime?this._countTime.stop():(this._countTime=new egret.Timer(1e3,this.counTime+1),this._countTime.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._countTime.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this)),this._countTime.start(),this.chatSend.skin.sendDisable.visible=!0,this.chatSend.touchEnabled=!1,this.chatSend.skin.sendClock.visible=!0},LobbyChatPanel.prototype.selfFail=function(){this.showFailToast(),chessCommonLib.CommonVariable.getInstance().isForbidden=!0},LobbyChatPanel.prototype.onTimer=function(){this.counTime<0&&this.timerComFunc(),this.chatSend.skin.send_word.visible=!1,this.chatSend.skin.sendClock.text=""+this.counTime,this.counTime--},LobbyChatPanel.prototype.timerComFunc=function(){this._countTime&&(this._countTime.stop(),this._countTime.reset(),this.chatSend.skin.sendDisable.visible=!1,this.chatSend.skin.sendClock.visible=!1,this.chatSend.skin.sendClock.text="",this.chatSend.touchEnabled=!0,this.chatSend.skin.send_word.visible=!0)},LobbyChatPanel.prototype.onGetSZchatInfo=function(t){this.chatScroll.visible=!0;var e=t.param;void 0==e.type&&(e.type=0),chessCommonLib.CommonVariable.add({nickName:e.nickName,vip:e.vipLevel,content:e.chatInfo,type:e.type.toString()},this.chatData),this.arrCol.refresh(),this.chatList.validateNow(),this.chatScroll.viewport.contentHeight>453&&(this.chatScroll.viewport.scrollV=this.chatScroll.viewport.contentHeight-this.chatScroll.height)},LobbyChatPanel.prototype.layoutRefresh=function(t){1===t?(chessCommonLib.CommonVariable.add({nickName:"",vip:-1,content:""},this.chatData),this.arrCol.refresh()):2===t&&this.chatData.pop()},LobbyChatPanel.prototype.showFacePanel=function(){this.chatFacePanel.visible=!this.chatFacePanel.visible,this.touchMask.touchEnabled=!this.touchMask.touchEnabled},LobbyChatPanel.prototype.showFaceText=function(t){chessCommonLib.CommonVariable.getStrRealLength(this.chatContentLable.text)>=80||(this.chatContentLable.text=this.chatContentLable.text+"("+t.data+")",this.BtnHandle())},LobbyChatPanel.prototype.onChang=function(t){this.chatContentLable.text=chessCommonLib.CommonVariable.handleString(this.chatContentLable.text,80),this.BtnHandle()},LobbyChatPanel.prototype.BtnHandle=function(){var t=this;this._countTime&&this._countTime.running||(this.chatContentLable.text&&this.chatContentLable.text.length>0&&!this.isTour?(this.chatSend.skin.sendDisable.visible=!1,this.chatSend.skin.send_wordDisable.visible=!1,this.chatSend.skin.send_word.visible=!0,this.chatSend.touchEnabled=!0):(this.chatSend.skin.sendDisable.visible=!0,this.chatSend.skin.send_wordDisable.visible=!0,this.chatSend.skin.send_word.visible=!1,this.chatSend.touchEnabled=!1),this.chatList.validateNow(),egret.setTimeout(function(){t.chatScroll.viewport.contentHeight>453&&(t.chatScroll.viewport.scrollV=t.chatScroll.viewport.contentHeight-t.chatScroll.height)},this,200))},LobbyChatPanel.prototype.sortByTimestamp=function(){this.chatData.sort(function(t,e){return t.timestamp<e.timestamp?-1:t.timestamp>e.timestamp?1:0})},LobbyChatPanel.prototype.cartonControl=function(t){t?(uniLib.DisplayUtils.playTweenGroup(this.loadingTip,!0),this.loading_img.visible=!0):(uniLib.DisplayUtils.stopTweenGroup(this.loadingTip),this.loading_img.visible=!1)},LobbyChatPanel.prototype.chatCloseHander=function(){this.dispatchEventWith("close"),uniLib.PopUpMgr.removePopUp(this),this.visible=!1,console.error("关闭当前面板")},LobbyChatPanel.prototype.destroy=function(){console.error("关闭当前面板-destroy111"),this._countTime,this.chatContentLable.text,this.tempTimer&&egret.clearTimeout(this.tempTimer),this.tempTimer2&&egret.clearTimeout(this.tempTimer2)},LobbyChatPanel.prototype.hidephonevc=function(){try{uniLib.ZQGameSdk.hideVk()}catch(t){}},LobbyChatPanel.prototype.showFailToast=function(){window.dynamicCode='SZLobby.LobbyPopupManager.showMildWarnShow("你已经被禁言，请联系客服");',window.eval.call(window,window.dynamicCode)},LobbyChatPanel.prototype.dispose=function(){uniLib.PopUpMgr.removePopUp(this),this.removeEvent(),this.chatData=[],this._countTime&&this._countTime.stop(),this.tempTimer&&egret.clearTimeout(this.tempTimer),this.tempTimer2&&egret.clearTimeout(this.tempTimer2),this.arrCol.removeAll(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},LobbyChatPanel}(eui.Component);chessCommonLib.LobbyChatPanel=LobbyChatPanel}(chessCommonLib||(chessCommonLib={}));var Cmd;!function(t){t.OnGetCommonChatInfoLobby_S=function(t){t&&(Array.isArray(t.info)||(t.info=[])),uniLib.Global.isInGame&&t.info.length>20&&(t.info.length=20),uniLib.Global.dispatchEvent(chessCommonLib.ChatEventConsts.CHAT_INIT,t)},t.OnLobbyCommonChatLobby_S=function(t){t.resultCode&&0!=t.resultCode?2===t.resultCode&&uniLib.Global.dispatchEvent(chessCommonLib.ChatEventConsts.WORLD_MSG_SELF_FAIL,t):uniLib.Global.dispatchEvent(chessCommonLib.ChatEventConsts.WORLD_MSG_SELF,t)},t.OnLobbyCommonChatLobby_Brd=function(t){t&&1==t.type?uniLib.Global.dispatchEvent(chessCommonLib.ChatEventConsts.WORLD_MSG,t.info):(chessCommonLib.CommonVariable.getInstance().chatInfo=t.info,uniLib.Global.dispatchEvent(chessCommonLib.ChatEventConsts.WORLD_MSG_INGAME,t.info))}}(Cmd||(Cmd={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.labeTxt=i.createBitmap(e),i.addChild(i.labeTxt),i}return __extends(e,t),e.prototype.createBitmap=function(t){var e=new egret.Bitmap;return e.texture=RES.getRes(t),e},e.prototype.destory=function(){uniLib.DisplayUtils.removeFromParent(this),uniLib.DisplayUtils.removeAllChildren(this),delete this.labeTxt},e}(egret.Sprite);t.ChatImageItem=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function t(t,e){if(void 0===e&&(e=!1),this.isSpecil=!1,this.text1="",this.text="",this.isSpecil=e,e){this.labeTxt=this.createTextLabel("left",27);for(var i=[],n=0;n<t.length;n++)i.push({text:t[n].text,style:{textColor:t[n].color}});this.labeTxt.textFlow=i}else this.text=t.replace(/<\d{1}>/g,""),this._width=egret.sys.measureText(this.text,"",27,!1,!1),this.text1=t}return Object.defineProperty(t.prototype,"width",{get:function(){return this.isSpecil?this.labeTxt.measuredWidth:this._width},enumerable:!0,configurable:!0}),t.prototype.createTextLabel=function(t,e){var i=new eui.Label;return i.fontFamily="null1",i.textAlign=t,i.lineSpacing=10,i.size=e,i},t.prototype.destory=function(){delete this.labeTxt},t}();t.ChatWordCalculateItem=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(t){function e(e,i){void 0===i&&(i=!1);var n=t.call(this)||this;if(n.labeTxt=n.createTextLabel("left",27),i){for(var o=[],s=0;s<e.length;s++)o.push({text:e[s].text,style:{textColor:e[s].color}});n.labeTxt.textFlow=o}else n.labeTxt.text=e.replace(/<\d{1}>/g,""),n.labeTxt.text1=e;return n.addChild(n.labeTxt),n}return __extends(e,t),e.prototype.createTextLabel=function(t,e){var i=new eui.Label;return i.fontFamily="null1",i.textAlign=t,i.lineSpacing=10,i.size=e,i},e.prototype.destory=function(){uniLib.DisplayUtils.removeFromParent(this),uniLib.DisplayUtils.removeAllChildren(this),delete this.labeTxt},e}(eui.Component);t.ChatWordItem=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._hornNum=0,i.skinName="chessCommonLib.ChatListSkin"+t.ModuleMgr.getInstance().skinType,i}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this);var i=t.ConfigMgr.getInstance().gameOptions.horn;this.chat_select_grp.visible=i,this.labaType_btn.visible=i,this.roomType_btn.touchEnabled=i,this.chat_etxt.maxChars=60,this._chatBtns=[this.roomType_btn,this.labaType_btn],this._chatDropBtns=[this.roomDrop_btn,this.labaDrop_btn],this.hideChatTypeSelectGrp(),this.data=[],this.chat_lst.itemRendererFunction=this.chatListItemRendererFunc,this.addEvents(),this.currentChatType=Cmd.CHAT_TYPE.ROOM},i.prototype.chatListItemRendererFunc=function(e){return e.chatType==Cmd.CHAT_TYPE.HORN?t.ChatListLabaItemRenderer:e.chatType==Cmd.CHAT_TYPE.ROOM?t.ChatListItemRenderer:(e.chatType,void Cmd.CHAT_TYPE.VOICE)},i.prototype.showChatTypeSelectGrp=function(t){1!=this.chat_select_grp.visible?(t==Cmd.CHAT_TYPE.ROOM?(this.roomDrop_btn.visible=!1,this.labaDrop_btn.visible=!0):(this.roomDrop_btn.visible=!0,this.labaDrop_btn.visible=!1),this.chat_select_grp.visible=!0):this.hideChatTypeSelectGrp()},i.prototype.hideChatTypeSelectGrp=function(){this.chat_select_grp.visible=!1},Object.defineProperty(i.prototype,"currentChatType",{set:function(t){this._currentChatType=t,this._currentChatType==Cmd.CHAT_TYPE.ROOM?(this.roomType_btn.visible=!0,this.labaType_btn.visible=!1):(this.roomType_btn.visible=!1,this.labaType_btn.visible=!0)},enumerable:!0,configurable:!0}),i.prototype.update=function(){},i.prototype.reset=function(){},i.prototype.addEvents=function(){uniLib.Global.addEventListener(t.ChatUserEvent.CHAT_INFO,this.onGetChatInfo,this),uniLib.Global.addEventListener(t.ChatUserEvent.HORN_CHANGE,this.sethornNum,this),this.send_bt.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendHandler,this),this.roomDrop_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChatTypeHandle,this),this.labaDrop_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChatTypeHandle,this),this.roomType_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowDropHandle,this),this.labaType_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowDropHandle,this),this.chat_etxt.addEventListener(egret.Event.CHANGE,this.onChang,this)},i.prototype.onShowDropHandle=function(t){this.showChatTypeSelectGrp(this._currentChatType)},i.prototype.onTouchChatTypeHandle=function(t){this.hideChatTypeSelectGrp(),this._currentChatType==Cmd.CHAT_TYPE.ROOM?(this.currentChatType=Cmd.CHAT_TYPE.HORN,this.chat_etxt.prompt="可免费发送"+this._hornNum+"次",this.chat_etxt.maxChars=60,this._hornNum>10&&(this.chat_etxt.prompt="喇叭无限使用")):(this.currentChatType=Cmd.CHAT_TYPE.ROOM,this.chat_etxt.prompt="请输入,最多60字",this.chat_etxt.maxChars=60)},i.prototype.sethornNum=function(t){this.hornNum=t.param},Object.defineProperty(i.prototype,"hornNum",{set:function(t){this._hornNum=t,this._currentChatType==Cmd.CHAT_TYPE.HORN&&(this.chat_etxt.prompt="可免费发送"+this._hornNum+"次",this._hornNum>10&&(this.chat_etxt.prompt="喇叭无限使用"))},enumerable:!0,configurable:!0}),i.prototype.onGetChatInfo=function(t){var e=t.param;t.param.data.uid===uniLib.NetMgr.UID&&(this.chat_etxt.text=""),this._data.addItem(e),this._data.refresh(),this.scroll2Bottom()},i.prototype.onSendHandler=function(t){var e=this.chat_etxt.text;if(e){var i=new Cmd.UI_CommonChat_C;if(i.words=e,this._currentChatType==Cmd.CHAT_TYPE.HORN&&this._hornNum<0)return void uniLib.TipsUtils.showTipsDownToUp("喇叭数量不够",!0);i.brdType=this._currentChatType,uniLib.NetMgr.tcpSend(i)}},i.prototype.onVoiceHandle=function(t){uniLib.TipsUtils.showTipsDownToUp("暂时没有语音效果图,后续再做",!0)},i.prototype.onVoiceEndHandle=function(t){},Object.defineProperty(i.prototype,"data",{set:function(t){this._data=new eui.ArrayCollection(t),this.refreshView()},enumerable:!0,configurable:!0}),i.prototype.refreshView=function(){this._data?(this.chat_lst.dataProvider=this._data,this.chat_lst.visible=!0):this.chat_lst.visible=!1},i.prototype.changeChatType=function(){},i.prototype.scroll2Bottom=function(){this.chat_scr.validateNow(),this.chat_scr.viewport.contentHeight>618&&(this.chat_scr.viewport.scrollV=this.chat_scr.viewport.contentHeight-395)},i.prototype.onChang=function(t){60===t.target.text.length&&uniLib.TipsUtils.showTipsDownToUp("字数超出限制")},i.prototype.destroy=function(){uniLib.Global.removeEventListener(t.ChatUserEvent.CHAT_INFO,this.onGetChatInfo,this),this.send_bt.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendHandler,this),uniLib.Global.removeEventListener(t.ChatUserEvent.HORN_CHANGE,this.sethornNum,this),this.roomDrop_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChatTypeHandle,this),this.labaDrop_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChatTypeHandle,this),this.roomType_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowDropHandle,this),this.labaType_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowDropHandle,this),this.chat_etxt.removeEventListener(egret.Event.CHANGE,this.onChang,this)},i}(eui.Component);t.ChatList=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.changeTimeToStr=function(t){if(null==t)return"";t=10==t.toString().length?1e3*t:t;var e=new Date;return e.setTime(t),this.getNumStr(e.getHours())+":"+this.getNumStr(e.getMinutes())+":"+this.getNumStr(e.getSeconds())},i.getNumStr=function(t){return t<10?"0"+t:t.toString()},i.skinName="chessCommonLib.ChatListItemSkin"+t.ModuleMgr.getInstance().skinType,i}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.avar_img.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showUserinfoPanel,this),this.vip_img.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showUserinfoPanel,this),this.vip_img.x=-9,this.vip_img.y=-1,this.vip_img.width=105,this.vip_img.height=90,this.once(egret.Event.REMOVED_FROM_STAGE,this.removeListen,this)},i.prototype.showUserinfoPanel=function(){uniLib.Global.dispatchEvent(t.CommonModelEvent.USERINFO,{uid:this.data.data.uid,gameId:0})},i.prototype.removeListen=function(){this.vip_img.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showUserinfoPanel,this),this.avar_img.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showUserinfoPanel,this)},i.prototype.dataChanged=function(){this.data.data;this.time_txt.text=this.changeTimeToStr(this.data.data.time);var e,i=this.data.data.vipLevel;"number"==typeof i?e=i:"string"==typeof i&&(e=-1==i.indexOf("mjl_vip_icon")?Number(i):Number(i.substr(12,i.length))),this.name_txt.textColor=t.ConfigMgr.getInstance().getNameColor(e);t.ConfigMgr.getInstance().getVipByLevel(e);this.vip_img.source="info_img_bg_png",this.vip_img.width=50,this.vip_img.height=47,this.vip_img.x=20,this.vip_img.y=19},i}(eui.ItemRenderer);t.ChatListItemRenderer=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.skinName="chessCommonLib.ChatLabaItemSkin"+t.ModuleMgr.getInstance().skinType,i}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},i.prototype.dataChanged=function(){var e,i=this.data.data.vipLevel;"number"==typeof i?e=i:"string"==typeof i&&(e=-1==i.indexOf("mjl_vip_icon")?Number(i):Number(i.substr(12,i.length))),this.notice_lb.text="　　"+this.data.data.words,this.notice_lb.textFlow=[{text:this.data.data.nickName+"：",style:{textColor:t.ConfigMgr.getInstance().getNameColor(e)}},{text:this.data.data.words,style:{textColor:16777215}}],this.chat_laba_vip_img.source="vip_small"+e+"_png"},i}(eui.ItemRenderer);t.ChatListLabaItemRenderer=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function t(){}return t.CHAT_INFO="chat_Info",t.HORN_CHANGE="horn_change",t.MOVE_LEFT="move_left",t.MOVE_RIGHT="move_right",t.CHAT_USER_COUNT="chat_user_count",t.SEATNUM_CHANGE="seatnum_change",t}();t.ChatUserEvent=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function n(i,n){var o=e.call(this)||this;return o._isMove=!1,i&&(o._currentPage=i),n&&(t.ModuleMgr.getInstance().skinType=n),o.skinName="chessCommonLib.ChatUserSkin"+t.ModuleMgr.getInstance().skinType,o}return __extends(n,e),n.prototype.childrenCreated=function(){var n=this;e.prototype.childrenCreated.call(this),this.scaleY=t.LoadGameTipUtil.gameScaleY,this.btns=[this.chat_btn,this.noseat_btn],this.touchChildren=!0,uniLib.Global.addEventListener(t.ChatUserEvent.CHAT_INFO,this.onGetChatInfo,this),uniLib.Global.addEventListener(t.ChatUserEvent.CHAT_USER_COUNT,this.onUserCount,this),this.chat_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatBtnHandler,this),this.noseat_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatBtnHandler,this),this.bg_layer=uniLib.DisplayUtils.createMask(0,1.5*uniLib.Global.screenWidth,uniLib.Global.screenHeight),this.bg_layer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.bg_layer.touchEnabled=!1,this.bg_layer.visible=!1,this.addChildAt(this.bg_layer,0),null==this._currentPage&&(this._currentPage=i.CHAT),this.onChatReady(this._currentPage),this._currentPage==i.CHAT&&this.noseat_btn.visible&&egret.setTimeout(function(){n.getUserList()},this,800)},n.prototype.getUserList=function(){var t=new Cmd.UI_GetNotSeatUserListRoomCmd_C;t.curPage=1,uniLib.NetMgr.httpSend(t,function(t){if(!t||0==t.resultCode)t.users.length})},n.prototype.onChatReady=function(e){switch(this._curentBtn&&(this._curentBtn.selected=!1,this._curentBtn.enabled=!0),this._currentView&&this._currentView.parent&&this._currentView.parent.removeChild(this._currentView),e){case i.CHAT:this._currentView&&(this._currentView==this._chatListView||this._currentView.destroy()),this._chatListView?this._chatListView.addEvents():this._chatListView=new t.ChatList,this._currentView=this._chatListView,this._curentBtn=this.chat_btn,this.chatAnim&&(this.chatAnim.visible=!1,this.chatAnim.stop());break;case i.NOSEAT:this._currentView&&(this._currentView==this._userList||this._currentView.destroy()),this._userList?this._userList.update():this._userList=new t.UserList,this._currentView=this._userList,this._curentBtn=this.noseat_btn}this._curentBtn.selected=!0,this._currentView&&this.addChild(this._currentView)},n.prototype.onGetChatInfo=function(e){if(this._currentView!=this._chatListView||0!=this.x){if(void 0==this.chatAnim){var i="",n=t.ModuleMgr.getInstance().skinType;n>1&&(i=n+""),this.chatAnim=uniLib.DragonUtils.showFastDragon("chat_mess"+i,"newAnimation",uniLib.DragonType.MovieClip,this.chat_btn.x+(this.chat_btn.width>>1),this.chat_btn.y+(this.chat_btn.height>>1),this)}this.chatAnim.visible=!0,this.chatAnim.play()}},n.prototype.onUserCount=function(t){t.param},n.prototype.onChatBtnHandler=function(t){if(this.onClick(t),t.currentTarget==this._curentBtn)return this._curentBtn.selected=!0,void(this._curentBtn==this.chat_btn&&this.chatAnim&&this.chatAnim.visible&&(this.chatAnim.stop(),this.chatAnim.visible=!1));switch(t.currentTarget){case this.chat_btn:this._currentPage=i.CHAT;break;case this.noseat_btn:this._currentPage=i.NOSEAT}this.onChatReady(this._currentPage)},Object.defineProperty(n.prototype,"hornNum",{set:function(e){null==this._chatListView&&(this._chatListView=new t.ChatList),this._chatListView.hornNum=e},enumerable:!0,configurable:!0}),n.prototype.onTouch=function(e){console.error("点击空白聊天框隐藏",this.chat_btn.touchEnabled),this.bg_layer.touchEnabled=!1,this.bg_layer.visible=!1,this.dispatchEventWith(t.ChatUserEvent.MOVE_LEFT,!1),this.moveLeft(e)},n.prototype.onClick=function(e){this.bg_layer.touchEnabled=!0,this.bg_layer.visible=!0,this.dispatchEventWith(t.ChatUserEvent.MOVE_RIGHT,!1),this.moveRight(e)},n.prototype.moveLeft=function(t){var e=this;t.stopPropagation(),this._isMove||-408!=this.x&&(this._userList,this.touchEnabled=!1,this.touchChildren=!1,this._isMove=!0,egret.Tween.get(this).to({x:-408},300).call(function(){e.touchEnabled=!0,e.touchChildren=!0,e._isMove=!1,egret.Tween.removeTweens(e)},this))},n.prototype.moveRight=function(t){var e=this;t.stopPropagation(),0!=this.x&&(this._isMove||(this.touchEnabled=!1,this.touchChildren=!1,this._isMove=!0,egret.Tween.get(this).to({x:0},300).call(function(){e.touchEnabled=!0,e.touchChildren=!0,e._isMove=!1,e._curentBtn.enabled=!0,egret.Tween.removeTweens(e),e._currentPage==i.NOSEAT&&e._userList.update()},this)))},n.prototype.destroy=function(){uniLib.Global.removeEventListener(t.ChatUserEvent.CHAT_USER_COUNT,this.onUserCount,this),uniLib.Global.removeEventListener(t.ChatUserEvent.CHAT_INFO,this.onGetChatInfo,this),this.bg_layer.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.chat_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatBtnHandler,this),this.noseat_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatBtnHandler,this),this._userList&&this._userList.destroy(),this._chatListView&&this._chatListView.destroy()},n}(eui.Component);t.ChatUserView=e;var i;!function(t){t[t.CHAT=1]="CHAT",t[t.NOSEAT=2]="NOSEAT"}(i=t.CHAT_PAGE||(t.CHAT_PAGE={}))}(chessCommonLib||(chessCommonLib={}));var Cmd;!function(t){t.OnUI_CommonChat_S=function(t){t.resultCode&&2==t.resultCode?uniLib.Global.dispatchEvent(chessCommonLib.ChatUserEvent.SEATNUM_CHANGE,t.noSeatUserNum):t.resultCode&&0!=t.resultCode?2!=t.resultCode&&uniLib.TipsUtils.showTipsDownToUp(t.desc):void 0!=t.horn&&uniLib.Global.dispatchEvent(chessCommonLib.ChatUserEvent.HORN_CHANGE,t.horn)},t.OnUI_CommonChat_Brd=function(t){var e=new chessCommonLib.ChatVo;e.chatType=t.brdType,e.data=t,uniLib.Global.dispatchEvent(chessCommonLib.ChatUserEvent.CHAT_INFO,e)},t.OnUI_VoiceChat_S=function(t){t.resultCode&&0!=t.resultCode&&uniLib.TipsUtils.showTipsDownToUp("发送语音信息失败,错误码:"+t.resultCode)},t.OnUI_VoiceChat_Brd=function(e){var i=new chessCommonLib.ChatVo;i.chatType=t.CHAT_TYPE.VOICE,i.data=e,uniLib.Global.dispatchEvent(chessCommonLib.ChatUserEvent.CHAT_INFO,i)}}(Cmd||(Cmd={}));var chessCommonLib;!function(t){var e=function(){return function(){}}();t.ChatVo=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(){var i=e.call(this)||this;i.skinName="chessCommonLib.UserListItemSkin"+t.ModuleMgr.getInstance().skinType;return i}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.avar_img.touchEnabled=!0,this.avar_img.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showUserinfoPanel,this),this.vip_img.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showUserinfoPanel,this),this.vip_img.x=-15,this.vip_img.y=-7,this.vip_img.width=115,this.vip_img.height=105,this.once(egret.Event.REMOVED_FROM_STAGE,this.removeListen,this)},i.prototype.showUserinfoPanel=function(){uniLib.Global.dispatchEvent(t.CommonModelEvent.USERINFO,{uid:this.data.uid,gameId:0})},i.prototype.removeListen=function(){this.vip_img.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showUserinfoPanel,this),this.avar_img.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showUserinfoPanel,this)},i.prototype.dataChanged=function(){this.gold_lb.text=""+uniLib.StringUtils.formatCurrencyByTotalLen(this.data.remainder,!0,6);var e,i=this.data.vipLevel;"number"==typeof i?e=i:"string"==typeof i&&(e=-1==i.indexOf("mjl_vip_icon")?Number(i):Number(i.substr(12,i.length))),this.name_lb.textColor=t.ConfigMgr.getInstance().getNameColor(Number(e)),this.vip_img.source="info_img_bg_png",this.vip_img.width=50,this.vip_img.height=47,this.vip_img.x=20,this.vip_img.y=19},i}(eui.ItemRenderer);t.UserItemRenderer=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.skinName="chessCommonLib.UserListSkin"+t.ModuleMgr.getInstance().skinType,i}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.update(),this.noseat_lst.itemRenderer=t.UserItemRenderer},Object.defineProperty(i.prototype,"data",{set:function(t){this._data=t,this.refreshView()},enumerable:!0,configurable:!0}),i.prototype.refreshView=function(){this._data?(this.noseat_lst.dataProvider=new eui.ArrayCollection(this._data),this.noseat_lst.visible=!0,this.loading_img.visible=!1,uniLib.DisplayUtils.stopTweenGroup(this.loadingTip),uniLib.Global.dispatchEvent(t.ChatUserEvent.CHAT_USER_COUNT,this._data.length)):(this.noseat_lst.visible=!1,this.loading_img.visible=!0,uniLib.DisplayUtils.playTweenGroup(this.loadingTip,!0))},i.prototype.update=function(){this.data=[],this.getUserList()},i.prototype.reset=function(){this.noseat_lst.dataProvider=new eui.ArrayCollection([])},i.prototype.getUserList=function(){var t=this,e=new Cmd.UI_GetNotSeatUserListRoomCmd_C;e.curPage=1,uniLib.NetMgr.httpSend(e,function(e){e&&0!=e.resultCode?uniLib.TipsUtils.showTipsDownToUp(e.desc):t.data=e.users})},i.prototype.destroy=function(){this.loadingTip&&uniLib.DisplayUtils.stopTweenGroup(this.loadingTip)},i}(eui.Component);t.UserList=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(t,i,n){void 0===t&&(t="chessCommonLib.BrSeatSkin"),void 0===i&&(i=100),void 0===n&&(n=100);var o=e.call(this)||this;return o.DEFAULT_BG="br_seatHead_png",o.skinName=null!=t?t:"chessCommonLib.BrSeatSkin",o.width=i,o.height=n,o}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.touchChildren=!0,this.touchEnabled=!1,this.head.touchEnabled=!1,this.head.touchChildren=!0,this.lb_bg_img.touchEnabled=!1,this.chips_lbl.y=90,this.chips_lbl.x=this.width>>1},i.prototype.stand=function(){this.empty_bg&&(this.empty_bg.visible=!0),this.lb_bg_img&&(this.lb_bg_img.visible=!1),this.nickName="",this.chips_lbl&&(this.chips_lbl.text=""),this.head&&(this.head.visible=!1)},i.prototype.sit=function(t){t.uid&&this.updateSeat(t)},i.prototype.updateSeat=function(t){this.head&&(this.head.visible=!0,this.head.headUrl=t.headUrl),this.lb_bg_img&&(this.lb_bg_img.visible=!0),this.empty_bg&&(this.empty_bg.visible=!1),this.setHeadFrame(t.vipLevel,t.personalImage),this.nickName=t.nickName,this.chips=t.remainder},Object.defineProperty(i.prototype,"nickName",{set:function(t){this.nickName_lbl&&(this.nickName_lbl.visible=!0,this.nickName_lbl.text=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"chips",{set:function(e){null!=e?this.chips_lbl&&(this.chips_lbl.visible=!0,this.chips_lbl.text=i.CHIPCHANCE?e.toFixed(2)+"元":e>=1e5?t.NumberUtil.numberFormat(e):e+"",this.chips_lbl.anchorOffsetX=this.chips_lbl.width>>1,console.log(12)):console.error("chips is underfind")},enumerable:!0,configurable:!0}),i.prototype.setHeadFrame=function(t,e){this.head&&(this.head.visible=!0,this.head.destroy(),e?this.head.setHeadFrame(t,e):this.head.vipLevel=t),this.nickName_lbl.textColor=9==t?16711680:16777215},i.CHIPCHANCE=!1,i}(eui.Component);t.BrSeat=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(uniLib.Reflect);t.BrSeatVo=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.gameId=0,t&&(i.gameId=t),i.skinName="GameTaskButtonSkin",i}return __extends(i,e),i.prototype.addEvents=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandle,this),uniLib.Global.addEventListener(t.CommonModelEvent.RESPOND_TASK_SCHEDULE,this.onEventHandler,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this)},i.prototype.onRemoveFromStage=function(t){this.destroy()},i.prototype.removeEvents=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandle,this),uniLib.Global.addEventListener(t.CommonModelEvent.RESPOND_TASK_SCHEDULE,this.onEventHandler,this)},i.prototype.onTouchHandle=function(e){uniLib.Global.dispatchEvent(t.CommonModelEvent.TASK,this.gameId)},i.prototype.onEventHandler=function(t){var e=t.param;this.progress_text.textFlow=[{text:"(",style:{size:24}},{text:e.pre+"",style:{size:24,textColor:11454206}},{text:"/"+e.back+")",style:{size:24}}],1==e.receive?this.startRoate():this.stopRoate()},i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addEvents(),uniLib.Global.dispatchEvent(t.CommonModelEvent.REQUEST_TASK_SCHEDULE,this.gameId)},i.prototype.startRoate=function(){var t=this;egret.setTimeout(function(){t.light_rotate.visible=!0,egret.Tween.get(t.light_rotate,{loop:!0}).to({rotation:359},4e3)},this,200)},i.prototype.stopRoate=function(){egret.Tween.removeTweens(this.light_rotate),this.light_rotate.visible=!1},i.prototype.destroy=function(){this.removeEvents(),this.stopRoate(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i}(eui.Component);t.GameTaskButton=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName="ShiShiCaiButtonSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addEvent(),uniLib.Global.dispatchEvent(t.CommonModelEvent.REQUEST_SHISHICAI_INFO)},i.prototype.addEvent=function(){this.once(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this),uniLib.Global.addEventListener(t.CommonModelEvent.RESPOND_SHISHICAI_INFO,this.getSscStatus,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},i.prototype.onRemoveFromStage=function(t){this.destroy()},i.prototype.removeEvent=function(){uniLib.Global.removeEventListener(t.CommonModelEvent.RESPOND_SHISHICAI_INFO,this.getSscStatus,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},i.prototype.touchHandle=function(){uniLib.Global.dispatchEvent(t.CommonModelEvent.SSC)},i.prototype.getSscStatus=function(t){this._data=t.param,1==this._data.status?(0==this._data.time&&(this._data.time=0),this._timer.text="倒计时:"+this._data.time.toString()):2==this._data.status&&(this._timer.text="结算中"),this.timer||(this.timer=new egret.Timer(1e3),this.timer.addEventListener(egret.TimerEvent.TIMER,this.runTime,this),this.timer.start())},i.prototype.runTime=function(){this._data.time<=0?this._data.time=0:--this._data.time<=0&&(this._data.time=0),1==this._data.status?this._timer.text="倒计时:"+this._data.time.toString():2==this._data.status&&(this._timer.text="结算中")},i.prototype.destroy=function(){this.removeEvent(),this.timer&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.runTime,this),this.timer=null)},i}(eui.Component);t.ShiShiCaiButton=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="AutoChipChoicePanel",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){this.fiveChipValueArray=[],this.isFirstEnterGame,this.addEvent()},e.prototype.addEvent=function(){this.chipClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chipCloseHander,this),this.chip_1.addEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_2.addEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_5.addEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_10.addEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_50.addEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_100.addEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_250.addEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_500.addEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_1000.addEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_2000.addEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_5000.addEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_10000.addEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.confirmBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.confirmBtnClick,this)},e.prototype.removeEvent=function(){this.chipClose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.chipCloseHander,this),this.chip_1.removeEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_2.removeEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_5.removeEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_10.removeEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_50.removeEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_100.removeEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_250.removeEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_500.removeEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_1000.removeEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_2000.removeEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_5000.removeEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.chip_10000.removeEventListener(eui.UIEvent.CHANGE,this.chipOnChange,this),this.confirmBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.confirmBtnClick,this)},e.prototype.chipCloseHander=function(t){this.closeFun&&this.closeFun.apply(this)},e.prototype.chipOnChange=function(t){if(this.fiveChipValueArray.length>4&&t.target.selected)return uniLib.TipsUtils.showTipsDownToUp("请选择5个下注筹码~",16777215),void(t.target.selected&&(t.target.selected=!1));switch(t.target){case this.chip_1:this.chip_1.selected?this.fiveChipValueArray.push(1):this.removeObjectFromArray(1);break;case this.chip_2:this.chip_2.selected?this.fiveChipValueArray.push(2):this.removeObjectFromArray(2);break;case this.chip_5:this.chip_5.selected?this.fiveChipValueArray.push(5):this.removeObjectFromArray(5);break;case this.chip_10:this.chip_10.selected?this.fiveChipValueArray.push(10):this.removeObjectFromArray(10);break;case this.chip_50:this.chip_50.selected?this.fiveChipValueArray.push(50):this.removeObjectFromArray(50);break;case this.chip_100:this.chip_100.selected?this.fiveChipValueArray.push(100):this.removeObjectFromArray(100);break;case this.chip_250:this.chip_250.selected?this.fiveChipValueArray.push(250):this.removeObjectFromArray(250);break;case this.chip_500:this.chip_500.selected?this.fiveChipValueArray.push(500):this.removeObjectFromArray(500);break;case this.chip_1000:this.chip_1000.selected?this.fiveChipValueArray.push(1e3):this.removeObjectFromArray(1e3);break;case this.chip_2000:this.chip_2000.selected?this.fiveChipValueArray.push(2e3):this.removeObjectFromArray(2e3);break;case this.chip_5000:this.chip_5000.selected?this.fiveChipValueArray.push(5e3):this.removeObjectFromArray(5e3);break;case this.chip_10000:this.chip_10000.selected?this.fiveChipValueArray.push(1e4):this.removeObjectFromArray(1e4)}},e.prototype.confirmBtnClick=function(t){if(this.fiveChipValueArray.length<5)uniLib.TipsUtils.showTipsDownToUp("请选择5个下注筹码~",16777215);else if(5==this.fiveChipValueArray.length){var e=new Cmd.CustomBetChipsCmd_C;e.betchips=this.fiveChipValueArray,uniLib.NetMgr.tcpSend(e),this.closeFun&&this.closeFun.apply(this)}else uniLib.TipsUtils.showTipsDownToUp("请选择5个下注筹码~",16777215)},e.prototype.removeObjectFromArray=function(t){for(var e=0;e<this.fiveChipValueArray.length;e++)t==this.fiveChipValueArray[e]&&this.fiveChipValueArray.splice(e,1)},e.prototype.destory=function(){this.removeEvent(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},e}(eui.Component);t.AutoChipChoicePanel=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){return function(){}}();t.Panel=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._items={},e}return __extends(e,t),e.prototype.setdata=function(t,e,i){null==this._menuCollection&&(this._menuCollection=new eui.ArrayCollection);var o=t.length;if(e&&(this._containerOrThis=e),i&&(this._index=i),"string"==typeof t[0]){for(s=0;s<o;s++)(r={}).index=s,r.label=t[s],0==s?r.skin=n.FIRST:s==o-1&&(r.skin=n.LAST),this._menuCollection.addItem(r);this._menuCollection&&(this.dataProvider=this._menuCollection)}else{for(var s=0;s<o;s++){var r=t[s];r.index=s,0==s?r.skin=n.FIRST:s==o-1&&(r.skin=n.LAST),this._menuCollection.addItem(r)}this.dataProvider=this._menuCollection,this.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onMenuItemTap,this),this._index||(this._index=0),this.showItem(this._menuCollection.getItemAt(this._index))}this.selectedIndex=this._index},e.prototype.onMenuItemTap=function(t){var e=t.item;this.showItem(e)},e.prototype.showItem=function(t){if(t.func)t.func.call(this._containerOrThis,t);else{if(this._currentPage&&uniLib.DisplayUtils.removeFromParent(this._currentPage),null==this._items[t.index]){var e=t.cls;this._items[t.index]=new e}this._currentPage=this._items[t.index],this._containerOrThis.addChild(this._items[t.index])}},Object.defineProperty(e.prototype,"itemsSkin",{set:function(t){this.itemRendererFunction=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._menuCollection&&(this.dataProvider=this._menuCollection)},e.prototype.destroy=function(){this.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onMenuItemTap,this);for(var t in this._items)this._items[t].destroy&&this._items[t].destroy(),this._items[t]=null,delete this._items[t];this._items=null},e}(eui.TabBar);t.TabBar=e;var i=function(){return function(){}}();t.TabBarVO=i;var n;!function(t){t[t.FIRST=0]="FIRST",t[t.LAST=1]="LAST"}(n=t.TabBarLst||(t.TabBarLst={}))}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="TabItemCenterSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){},e}(eui.ItemRenderer);t.TabBarItemCenter=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="TabItemLeftSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){},e}(eui.ItemRenderer);t.TabBarItemLeft=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="TabItemRightSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){},e}(eui.ItemRenderer);t.TabBarItemRight=e}(chessCommonLib||(chessCommonLib={}));var Cmd;!function(t){t.OnGetPersonalPanel_S=function(t){t.resultCode||uniLib.Global.dispatchEvent(chessCommonLib.ZhiMaEventConsts.GET_USERINFO,t.userInfo)},t.OnSendGiftRoomCmd_Brd=function(t){uniLib.Global.dispatchEvent(chessCommonLib.ZhiMaEventConsts.SEND_GIFT_NOTICE,t)},t.OnSendGiftRoomCmd_S=function(t){t.resultCode},t.OnVoiceChat_Brd=function(t){uniLib.Global.dispatchEvent(chessCommonLib.ZhiMaEventConsts.VOICE_NOTICE,t)}}(Cmd||(Cmd={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(t){var i=e.call(this,"zm_chat_title_png")||this;return i._ShortTalkArr=t,i.skinName="chessCommonLib.zm_ChatSkin",i}return __extends(i,e),i.prototype.initUI=function(){for(e=1;e<=18;e++){var t=new eui.RadioButton;t.skinName="chessCommonLib.zm_FaceButtonSkin",t.iconDisplay.texture=RES.getRes("zmgame_face"+e),t.groupName="face",t.value=e,this.faceGroup.addChild(t)}for(var e=0;e<this._ShortTalkArr.length;e++){var i=new eui.RadioButton;i.skinName="chessCommonLib.zm_ChatRadioButtonSkin",i.groupName="chat",i.value=e,i.label=e+1+"."+this._ShortTalkArr[e],i.y=56*e,this.chatGroup.addChild(i)}this.faceScroller.visible=!0,this.chatScroller.visible=!0,this.faceGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFaceGroupTap,this),this.chatGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatGroupTap,this),this.touchEnabled=!0,this.sendBtn.name="short_send",this.sendBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendClickHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.textField.addEventListener(egret.TextEvent.FOCUS_OUT,uniLib.ZQGameSdk.hideVk,this)},i.prototype.onChatGroupTap=function(e){if(t.UserInfoMgr.isClick){var i=e.target;if(i instanceof eui.RadioButton){var n="2"+i.value,o=new Cmd.CommonChat_C;o.voiceId=Number(n),uniLib.NetMgr.tcpSend(o),uniLib.PopUpMgr.removePopUp(this),t.UserInfoMgr.isClick=!1,setTimeout(function(){t.UserInfoMgr.isClick=!0},3e3)}}else uniLib.TipsUtils.showTipsDownToUp("您的操作太频繁了！请休息一下吧")},i.prototype.onFaceGroupTap=function(e){if(t.UserInfoMgr.isClick){var i=e.target;if(i instanceof eui.RadioButton){var n=new Cmd.CommonChat_C,o="1"+i.value;n.voiceId=Number(o),uniLib.NetMgr.tcpSend(n),uniLib.PopUpMgr.removePopUp(this),t.UserInfoMgr.isClick=!1,setTimeout(function(){t.UserInfoMgr.isClick=!0},3e3)}}else uniLib.TipsUtils.showTipsDownToUp("您的操作太频繁了！请休息一下吧")},i.prototype.onTouchTap=function(t){t.target==this.textField&&t.target.setFocus()},i.prototype.sendClickHandler=function(e){if(""==this.textField.text)return t.UserInfoMgr.isClick=!0,void uniLib.TipsUtils.showTipsDownToUp("聊天内容不能为空",!0);var i=new Cmd.CommonChat_C;i.words=this.textField.text,uniLib.NetMgr.tcpSend(i),this.textField.text="",uniLib.PopUpMgr.removePopUp(this)},i.prototype.destroy=function(){this.textField.removeEventListener(egret.TextEvent.FOCUS_OUT,uniLib.ZQGameSdk.hideVk,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.faceGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onFaceGroupTap,this),this.chatGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatGroupTap,this),this.sendBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendClickHandler,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.sendBtn=null,this.textField.text="",uniLib.DisplayUtils.removeAllChildren(this._content),uniLib.DisplayUtils.removeFromParent(this._content),e.prototype.destroy.call(this)},i}(t.BaseEuiPanel);t.zm_ChatPanel=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.index=0,e}return __extends(e,t),e.prototype.initUI=function(){},Object.defineProperty(e.prototype,"giftId",{set:function(t){this._giftId=t,this._effectMc||(this._effectMc=uniLib.DragonUtils.createDragonBonesDisplay("gift_effect_drag_ske_json","gift_effect_drag_tex_json","gift_effect_drag_tex_png","MovieClip"),dragonBones.WorldClock.clock.add(this._effectMc),this._effectMc.addEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onAnimationEvent,this)),this._effectMc.animation.gotoAndStopByFrame("gift"+this._giftId,0),this.addChild(this._effectMc.display)},enumerable:!0,configurable:!0}),e.prototype.onAnimationEvent=function(){this.index++,this._effectMc&&(this._effectMc.animation.stop("gift"+this._giftId),this.destory(),this.index=0)},e.prototype.play=function(){if(null!=this._effectMc){dragonBones.WorldClock.clock.contains(this._effectMc)||dragonBones.WorldClock.clock.add(this._effectMc),this._effectMc.animation.play("gift"+this._giftId);var t="zm_GiftSound"+this._giftId+"_mp3";""!=t&&uniLib.SoundMgr.instance.playSound(t)}},e.prototype.destory=function(){this._effectMc&&(this._effectMc.animation.stop(),this._effectMc.removeEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onAnimationEvent,this),uniLib.DragonUtils.destoryDragonBonesArmature(this._effectMc,"gift"+this._giftId),this._effectMc.display&&this.removeChild(this._effectMc.display)),this._effectMc=null,uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},e}(egret.DisplayObjectContainer);t.zm_GiftAnItem=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(t){function e(e,i,n){var o=t.call(this,"zm_help_title_png")||this;return o._typetext=i,o._contenttext=n,o._titletext=e,o.skinName="chessCommonLib.zm_HelpSkin",o}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.initUI=function(){this._titleTxt.text=this._titletext,this._typeTxt.text=this._typetext,this._contenttext=this._contenttext.replace(/#113780/g,"#e9dd1d"),this._contenttext||(this._contenttext="暂无"),this._contentTxt.textFlow=(new egret.HtmlTextParser).parser(this._contenttext)},e.prototype.loadTable=function(){return RES.getRes("TableGift_json")},e.prototype.destory=function(){this.removeEvent(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._titleTxt=null,this._typeTxt=null,this._contentTxt=null,this._contenttext=null,this._typetext=null,this._titletext=null},e}(t.BaseEuiPanel);t.zm_HelpPanel=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e;!function(t){t[t.BtnMusic=0]="BtnMusic",t[t.BtnSound=1]="BtnSound",t[t.BtnLocalSound=2]="BtnLocalSound"}(e=t.zm_SetPanelBtnType||(t.zm_SetPanelBtnType={}));var i=function(t){function i(e){var i=t.call(this,"game_sp_title_png",690,403)||this;if(i._index=0,i._bgImgArr=[],i.skinName="chessCommonLib.zm_SetPanelSKin",!e||0==e.length)throw new Error("小图资源数组不能为空");return i._bgResArr=e,i}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this)},i.prototype.onComplete=function(){},i.prototype.initUI=function(){for(var t=0,e=this._bgResArr;t<e.length;t++){var n=e[t],o=RES.getRes(n);if(!o)throw new Error("小图资源没有获取到,资源名:"+n);var s=new eui.Image;s.texture=o,s.name=n,s.width=this._imgGroup.width,s.height=this._imgGroup.height,this._bgImgArr.push(s)}var r=new egret.Rectangle(0,0,this._imgGroup.width,this._imgGroup.height);if(this._imgGroup.mask=r,Number(uniLib.Utils.getLocalStorage("SoundVolime"))||(this.soundBtn.selected=!0),Number(uniLib.Utils.getLocalStorage("MusicVolime"))||(this.musicBtn.selected=!0),i.LocalSoundStatus||(this.musicBtn.selected=!0),i.BgResName){var h=this._bgResArr.indexOf(i.BgResName);-1!=h&&(this._imgGroup.addChild(this._bgImgArr[h]),this._index=h)}else this._imgGroup.addChild(this._bgImgArr[0]);this.musicBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSoundHandle,this),this.soundBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSoundHandle,this),this.localSoundBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSoundHandle,this),this.leftBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBgCh,this),this.rightBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBgCh,this)},i.prototype.onSoundHandle=function(t){var e;t.target==this.musicBtn?t.target.selected?(uniLib.Utils.setLocalStorage("MusicVolime",0),e={evtType:i.SetPanelEvtTypeMusicOff}):(uniLib.Utils.setLocalStorage("MusicVolime",.7),e={evtType:i.SetPanelEvtTypeMusicOn}):t.target==this.soundBtn?t.target.selected?(uniLib.Utils.setLocalStorage("SoundVolime",0),e={evtType:i.SetPanelEvtTypeSoundOff}):(uniLib.Utils.setLocalStorage("SoundVolime",1),e={evtType:i.SetPanelEvtTypeSoundOn}):t.target==this.localSoundBtn&&(t.target.selected?(i.LocalSoundStatus=!1,e={evtType:i.SetPanelEvtTypeLocalSoundOff}):(i.LocalSoundStatus=!0,e={evtType:i.SetPanelEvtTypeLocalSoundOn})),this.dispatchEventWith(i.SetPanelEvtOccur,!1,e)},i.prototype.disableBtn=function(t){var i;switch(t){case e.BtnMusic:i=this.musicBtn;break;case e.BtnSound:i=this.soundBtn;break;case e.BtnLocalSound:i=this.localSoundBtn}i.enabled=!1},i.prototype.onBgCh=function(t){if(1!=this._bgImgArr.length){var e,n;t.target==this.leftBtn?(n=this._bgImgArr[this._index+1]?this._index+1:0,(e=this._bgImgArr[n]).x=this._imgGroup.width,this._imgGroup.addChild(e),this.moveEffect(this._bgImgArr[this._index],!1,n,!1),this.moveEffect(e,!1,n,!0)):t.target==this.rightBtn&&(n=this._bgImgArr[this._index-1]?this._index-1:this._bgImgArr.length-1,(e=this._bgImgArr[n]).x=-this._imgGroup.width,this._imgGroup.addChild(e),this.moveEffect(this._bgImgArr[this._index],!0,n,!1),this.moveEffect(e,!0,n,!0)),i.BgResName=this._bgResArr[n]}},i.prototype.moveEffect=function(t,e,n,o){var s,r=this;e?(s=1,this.rightBtn.touchEnabled=!1,this.leftBtn.touchEnabled=!1):(s=-1,this.rightBtn.touchEnabled=!1,this.leftBtn.touchEnabled=!1),egret.Tween.get(t).to({x:t.x+this._imgGroup.width*s},300,egret.Ease.sineInOut).call(function(){if(r._index=n,r.rightBtn.touchEnabled=!0,r.leftBtn.touchEnabled=!0,o){var t={index:n,resName:r._bgResArr[n],evtType:i.SetPanelEvtChBg};r.dispatchEventWith(i.SetPanelEvtOccur,!1,t)}})},i.prototype.removeEvent=function(){this.musicBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSoundHandle,this),this.soundBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSoundHandle,this),this.localSoundBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSoundHandle,this),this.leftBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBgCh,this),this.rightBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBgCh,this)},i.SetPanelEvtOccur="EvtOccur",i.BgResName="",i.LocalSoundStatus=!0,i.SetPanelEvtTypeMusicOff="music_off",i.SetPanelEvtTypeMusicOn="music_on",i.SetPanelEvtTypeSoundOff="sound_off",i.SetPanelEvtTypeSoundOn="sound_on",i.SetPanelEvtTypeLocalSoundOff="local_sound_off",i.SetPanelEvtTypeLocalSoundOn="local_sound_on",i.SetPanelEvtChBg="chBg",i}(t.BaseEuiPanel);t.zm_SetPanel=i}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(t){var i=e.call(this,"zm_userinfo_title_png")||this;return i._uid=t,i.skinName="chessCommonLib.zm_UserInfoSKin",i}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},i.prototype.initUI=function(){this._gift_group=new eui.Group,this._gift_group.x=39,this._gift_group.y=323,this._gift_group.width=712,this._gift_group.height=169,this.addChild(this._gift_group);for(var e,i=this.loadTable(),n=0;n<i.length;n++)(e=new t.zm_GiftItem).data=i[n],e.x=6+120*n,e.y=0,this._gift_group.addChild(e),e.name=i[n].giftId+"",e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendGiftHandle,this)},i.prototype.loadTable=function(){return RES.getRes("TableGift_json")},i.prototype.addEvent=function(){uniLib.Global.addEventListener(t.ZhiMaEventConsts.GET_USERINFO,this.showUserInfo,this);var e=new Cmd.GetPersonalPanel_C;e.uid=this._uid,uniLib.NetMgr.tcpSend(e)},i.prototype.removeEvent=function(){uniLib.Global.removeEventListener(t.ZhiMaEventConsts.GET_USERINFO,this.showUserInfo,this)},i.prototype.showUserInfo=function(e){this._data=e.param,this._data.nickname&&(this._name_lbl.text=this._data.nickname),this._data.uid&&(this._id_lbl.text="帐号："+this._data.uid),"nv"==this._data.gender?this._gender_img.source="zm_userinfo_famale_png":this._gender_img.source="zm_userinfo_male_png",this._data.ip?this._ip_lbl.text="地址："+this._data.ip:this._ip_lbl.text="未获取IP信息",this._data.headurl&&(this._head_img.source=this._data.headurl),this._data.diamond?this._data.chips>=1e5?this._diamond_lbl.text=t.NumberUtil.numFormat2(this._data.diamond):this._diamond_lbl.text=this._data.diamond+"":this._diamond_lbl.text="0",this._data.chips?this._data.chips>=1e5?this._bean_lbl.text=t.NumberUtil.numFormat2(this._data.chips):this._bean_lbl.text=this._data.chips+"":this._bean_lbl.text="0",this._data.address?this._gps_lbl.text=this._data.address:this._gps_lbl.text=""},i.prototype.sendGiftHandle=function(t){var e=t.currentTarget.name;if(null!=this._data){if(this._data.uid==uniLib.UserInfo.uid)(i=new Cmd.GiftsInfo).giftsId=Number(e),i.toUid=0,i.fromUid=this._data.uid,i.giftsNum=1;else{var i=new Cmd.GiftsInfo;i.giftsId=Number(e),i.toUid=this._data.uid,i.fromUid=uniLib.UserInfo.uid,i.giftsNum=1}var n=new Cmd.SendGiftRoomCmd_C;n.gift=i,uniLib.NetMgr.tcpSend(n),this.destory()}},i.prototype.destory=function(){uniLib.PopUpMgr.removePopUp(this),this.removeEvent(),this._head_img=null,uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._data=null,this._id_lbl=null,this._ip_lbl=null,this._gps_lbl=null,this._name_lbl=null,this._gender_img=null,this._bean_lbl=null,this._diamond_lbl=null},i}(t.BaseEuiPanel);t.zm_UserInfoPanel=e;var i=function(t){function e(){var e=t.call(this)||this;return e.skinName="chessCommonLib.zm_GiftItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.name=t.giftId.toString(),this._gift_img.texture=RES.getRes("zm_userinfo_gift"+t.giftId+"_png"),this._gift_name.text=null!=t.giftName?t.giftName:""},e.prototype.destory=function(){uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},e}(eui.ItemRenderer);t.zm_GiftItem=i}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(e){function i(t,i,n,o){var s=e.call(this)||this;return s._isCancel=!1,s.initUI(t,i,n,o),s}return __extends(i,e),i.prototype.initUI=function(e,i,o,s){this._startBtn=new uniLib.CommonButton(e,i),this._startBtn.x=o,this._startBtn.y=s,this.addChild(this._startBtn),this._startBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startRecord,this),this._recording=new n,this.addChild(this._recording),this._recording.x=(uniLib.Global.screenWidth-this._recording.width)/2,this._recording.y=(uniLib.Global.screenHeight-this._recording.height)/2,this._recording.addEventListener(t.ZhiMaEventConsts.RECORD_TIME_OUT,this.recordEvent,this),this._voiceArr=[],this.getContainer().addChild(this._recording)},i.prototype.getWidth=function(){return this._startBtn.width},i.prototype.getHeight=function(){return this._startBtn.height},i.prototype.recordEvent=function(t){this.stopRecord()},i.prototype.startRecord=function(t){this._isCancel=!1,this._curPosY=t.localY,egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),uniLib.ZQGameSdk.startRecord(),this._recording.startTimer()},i.prototype.checkCancel=function(t){t.localY>this._curPosY+20&&(this._isCancel=!0,egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),uniLib.ZQGameSdk.stopRecord(),this._recording.stopTimer())},i.prototype.stopRecord=function(t){if(void 0===t&&(t=null),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),this._recording.stopTimer()<1e3){setTimeout(function(){uniLib.ZQGameSdk.stopRecord()},1e3)}else uniLib.ZQGameSdk.stopRecord(this.onRecordBack,this)},i.prototype.onRecordBack=function(e){var i=e.data;if(0==e.code){var n=new o;n.url=i.voiceUrl,n.time=Math.round(i.voiceDuration/1e3),n.nickName=uniLib.UserInfo.uid.toString(),n.text=i.text,n.status=0,isNaN(n.time)?t.PublicTipMgr.getInstance().showMildWarnShow("语音发送失败"):0==this._isCancel&&this.dispatchEventWith(t.ZhiMaEventConsts.SEND_RECORD,!1,n)}else t.PublicTipMgr.getInstance().showMildWarnShow(e.errMsg)},i.prototype.getContainer=function(){return uniLib.SceneMgr.instance.currentScene.topLayer?uniLib.SceneMgr.instance.currentScene.topLayer:uniLib.SceneMgr.instance.currentScene},i.prototype.destory=function(){egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),this._startBtn&&(this._startBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startRecord,this),this._startBtn.destroy()),this._startBtn=null,this._recording&&(this._recording.removeEventListener(t.ZhiMaEventConsts.RECORD_TIME_OUT,this.recordEvent,this),this._recording.dispose()),this._recording=null;for(var e,i=0;i<this._voiceArr.length;i++)(e=this._voiceArr[i])&&e.destory();this._voiceArr=null,uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i}(egret.DisplayObjectContainer);t.zm_VoiceChat=e;var i=function(t){function e(){var e=t.call(this)||this;return e._ifFlip=!1,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this._bg=uniLib.DisplayUtils.createBitmapByName("zm_voice_paopao_png"),this._bg.scale9Grid=new egret.Rectangle(50,10,30,20),this.addChild(this._bg),this._soundIcon=uniLib.DisplayUtils.createBitmapByName("zm_voice_icon_png"),this._soundIcon.x=24,this._soundIcon.y=11,this.addChild(this._soundIcon),this._timeTxt=uniLib.DisplayUtils.createTextLabel(16777215,egret.HorizontalAlign.RIGHT,"",18,50),this._timeTxt.x=48,this._timeTxt.y=13,this.addChild(this._timeTxt)},e.prototype.onTimer=function(t){this._soundIcon.visible=!this._soundIcon.visible;var e=(new Date).getTime();Math.floor((e-this._startTime)/1e3)>=this._soundTime&&this.stopTimer()},e.prototype.stopTimer=function(){this._soundIcon.visible=!0,this.visible=!1,this._timer&&(this._timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer.stop(),this._timer=null)},e.prototype.flip=function(){this._ifFlip=!0,this._timeTxt.skewY=180,this._timeTxt.textAlign=egret.HorizontalAlign.LEFT},e.prototype.setData=function(t){t.uid!=uniLib.UserInfo.uid&&uniLib.ZQGameSdk.playRecord(t.url,this.playEndBack,this),t.time?this._timeTxt.text=t.time+"''":this._timeTxt.text="",this._soundTime=t.time?t.time:10,t.time<=3?this._bg.width=100:this._bg.width=100+5*(t.time-3),this._ifFlip?this._timeTxt.x=this._bg.width-12:this._timeTxt.x=this._bg.width-60,this.stopTimer(),this.visible=!0,this._timer=new egret.Timer(200),this._timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer.start();var e=new Date;this._startTime=e.getTime()},e.prototype.playEndBack=function(t){this.stopTimer()},e.prototype.destory=function(){this.stopTimer(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._bg=null,this._soundIcon=null},e}(egret.DisplayObjectContainer);t.VoiceMc=i;var n=function(e){function i(){var t=e.call(this)||this;return t._maxTime=15,t._msTime=0,t.initUI(),t}return __extends(i,e),i.prototype.initUI=function(){var t=uniLib.DisplayUtils.createBitmapByName("zm_voice_recording_png");this.addChild(t),this._moving=new egret.DisplayObjectContainer,this._moving.x=104,this._moving.y=102;var e=uniLib.DisplayUtils.createBitmapByName("zm_voiceloading_png");e.x=-e.width/2,e.y=-e.height/2,this._moving.addChild(e),this.addChild(this._moving),this._time=uniLib.DisplayUtils.createTextLabel(13031390,egret.HorizontalAlign.CENTER,"8''",22,75),this._time.x=74,this._time.y=136,this.addChild(this._time),this.visible=!1},i.prototype.startTimer=function(){this.stopTimer(),this.visible=!0,this._startTimer=new egret.Timer(50,0);var t=new Date;this._startTime=t.getTime(),this._startTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._startTimer.start()},i.prototype.stopTimer=function(){return this.visible=!1,this._startTimer&&(this._startTimer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._startTimer.stop(),this._startTimer=null),this._msTime},i.prototype.onTimer=function(e){var i=(new Date).getTime(),n=Math.floor((i-this._startTime)/1e3);this._time.text=n+1+"''",this._moving.rotation+=15,n>=this._maxTime&&this.dispatchEventWith(t.ZhiMaEventConsts.RECORD_TIME_OUT),this._msTime=i-this._startTime},i.prototype.dispose=function(){this.stopTimer(),this._moving&&(uniLib.DisplayUtils.removeAllChildren(this._moving),uniLib.DisplayUtils.removeFromParent(this._moving)),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._moving=null,this._time=null},i}(egret.DisplayObjectContainer);t.RecordingMc=n;var o=function(){return function(){}}();t.VoiceDataVo=o}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function t(){}return t.CHESS_COMMON_VIP="chess_common_vip",t.CHESS_COMMON_HEAD="chess_common_head",t.CHESS_COMMON_TEST="chess_common_test",t.CHESS_COMMON_CHAT="chess_common_chat",t.CHESS_COMMON_CHAT3="chess_common_chat3",t.CHESS_COMMON_GIFT_SOUND="chess_common_gift_sound",t.CHESS_COMMON_ANIM_VIP="chess_common_anim_vip",t.CHESS_COMMON_OTHER="chess_common_other",t.CHESS_COMMON_SANZHANG="chess_common_sanzhang",t.CHESS_COMMON_ZHIMA="chess_common_zhima",t.CHESS_COMMON_ZHANGZHOU="chess_common_zhangzhou",t.CHESS_COMMON_ZHIMA_MAHJONG_RESULT="chess_common_zhima_mahjong_result",t.CHESS_COMMON_EMOJCHAT="chess_common_emojchat",t.CHESS_COMMON_GIFT_EFFECT="chess_common_gift_effect",t}();t.GrpConsts=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function t(){}return t.USERINFO="userInfo",t.SHOP="shop",t.FULI="fuli",t.ACTIVITY="activity",t.TASK="task",t.SAFEBOX="safebox",t.MAIL="mail",t.VIP="vipinfo",t.NOTICE="notice",t.CHAT="chat",t.FREECHIP="freeChip",t.REDPACKAGE="redpackage",t.FRIEND="friend",t.RANK="rank",t.REQUEST_TASK_SCHEDULE="request_task_schedule",t.RESPOND_TASK_SCHEDULE="respond_task_schedule",t.REQUEST_SHISHICAI_INFO="request_shishicai_info",t.RESPOND_SHISHICAI_INFO="respond_shishicai_info",t.SYSMSG_CLICK="sysmsg_click",t.GAME_WATER="game_water",t.GAME_HELP="game_help",t.SSC="ssc",t.SUPRISE_GIFT_CMD_BRD="suprise_gift_cmd_Brd",t.SUPRISE_GIFT_RECHARGED="suprise_gift_recharged",t.BAOJI_REDPACK="baoji_redpack",t.NO_SEAT_USER="no_seat_user",t.GAME_SETTING="game_setting",t.GAME_RECORD="game_record",t}();t.CommonModelEvent=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function e(){this.sign={},this.goods={},this.shop={},this.task={},this.lobbyGameList={},this.gameList={},this.limit={},this.luck={},this.playTypeList={},this.headMc={},this.vip={},this._tableInited=!1,this.gameOptions=new t.gameOptions,this.getPlayTypeDes=function(t){return this.playTypeList[t]?this.playTypeList[t].desc:""}}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.getLoginCfg=function(t){return void 0===t&&(t="default"),null==this.loginData&&(uniLib.Global.gameConfig?(uniLib.Global.gameConfig.lobbyId||(uniLib.Global.gameConfig.lobbyId=31),this.loginData=uniLib.Global.gameConfig):this.loginData=RES.getRes("config_json")[t]),this.loginData},e.prototype.tableInited=function(){return this._tableInited},e.prototype.initTables=function(){var t=this;if(1!=this._tableInited){this._tableInited=!0;var e=RES.getRes("TableSignIn_json");e&&e.forEach(function(e){t.sign[e.lobbyId]=e});var i=RES.getRes("LobbyTaskConfig_json");i&&i.forEach(function(e){t.task[e.id]=e});var n=RES.getRes("TableGoodsConfig_json");n&&n.forEach(function(e){t.goods[e.goodId]=e});var o=RES.getRes("TableLobbyGameList_json");o&&o.forEach(function(e){t.lobbyGameList[e.id]=e});var s=RES.getRes("gameList_json");s&&s.forEach(function(e){t.gameList[e.gameId]=e});var r=RES.getRes("TableShopConfig_json");r&&r.forEach(function(e){t.shop[e.shopId]=e});var h=RES.getRes("TableLimitOfferConfig_json");h&&h.forEach(function(e){t.limit[e.id]=e});var a=RES.getRes("TableVip_json");a&&a.forEach(function(e){(!t.vip[e.level]||t.vip[e.level]&&0==t.vip[e.level].lobbyId)&&(t.vip[e.level]=e)});var c=RES.getRes("headMc_json");c&&c.forEach(function(e){t.headMc[e.id]=e});var l=RES.getRes("TablePlayTypeList_json");l&&l.forEach(function(e){t.playTypeList[e.id]=e}),Object.freeze(this.sign),Object.freeze(this.task),Object.freeze(this.goods),Object.freeze(this.lobbyGameList),Object.freeze(this.gameList),Object.freeze(this.shop),Object.freeze(this.limit),Object.freeze(this.vip),Object.freeze(this.headMc),Object.freeze(this.playTypeList),console.log("table load success")}},e.prototype.getPlayTypeByList=function(t){if(!RES.hasRes("TablePlayTypeList_json"))return"";var e="";t&&t.length&&0!=t.length||(t=[]),t.sort(function(t,e){return t>e?1:t==e?0:-1});for(var i=0;i<t.length;i++){if(-1!=t[i].toString().indexOf(".")){var n=t[i].toString().split(".");e+=this.getPlayTypeDes(Number(n[0]))+n[1].substr(0,n[1].length-1)}e=e+this.getPlayTypeDes(t[i])+"   "}return e},e.prototype.getSignCfgById=function(t){return this.sign[t]?this.sign[t]:null},e.prototype.getTaskCfgById=function(t){return this.task[t]?this.task[t]:null},e.prototype.getShopCfgById=function(t){return this.shop[t]?this.shop[t]:null},e.prototype.getGoodCfgById=function(t){return this.goods[t]?this.goods[t]:null},e.prototype.getLimitCfgById=function(t){return this.limit[t]?this.limit[t]:null},e.prototype.getGameListCfgById=function(t){return this.lobbyGameList[t]?this.lobbyGameList[t]:null},e.prototype.getGameCfgById=function(t){return this.gameList[t]?this.gameList[t]:null},e.prototype.getVipByLevel=function(t){return void 0===t&&(t=0),this.vip[t]?this.vip[t]:null},e.prototype.getheadMcById=function(t){return void 0===t&&(t=0),this.headMc[t]?this.headMc[t]:null},e.prototype.getNameColor=function(t){return 9==t?16711680:16777215},e.prototype.getGameListCfg=function(t,e){var i;try{i=JSON.parse(uniLib.Utils.getLocalStorage("gameList_cfg"))}catch(t){}i||(i=RES.getRes("gameList_json"));var n;uniLib.Global.CdnDomains&&uniLib.GameModuleUtils.gameRemotePaths&&(n=uniLib.Global.CdnDomains[0]+uniLib.GameModuleUtils.gameRemotePaths[0]+"gameList.json?v="+Math.random());uniLib.ResUtils.getRes(n,function(n){var o=JSON.stringify(uniLib.Utils.sortJson(n));uniLib.StringUtils.MD5(o)!=uniLib.StringUtils.MD5(JSON.stringify(uniLib.Utils.sortJson(i)))&&(uniLib.Utils.setLocalStorage("gameList_cfg",o),t&&t.call(e,n))},this,RES.ResourceItem.TYPE_JSON);return i},e}();t.ConfigMgr=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function t(){this.skinType=3,this.isFullScreen=!1}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.showConfirm=function(t,e,i,n,o,s,r,h){void 0!=i&&""==i.trim()&&(i="确定"),""==o&&(o="取消");var a=new uniLib.MsgBox(t,e,i,n,o,s,r);h=h||null,uniLib.PopUpMgr.addPopUp(a,h,!0,!0,!1,uniLib.PopUpEffect.CENTER)},t}();t.ModuleMgr=e}(chessCommonLib||(chessCommonLib={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),chessCommonLib;!function(t){var e=function(){function t(){this.showList=[]}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.showTipsShow=function(t){this._tipsPanel=new egret.Sprite,this.getContainer().addChild(this._tipsPanel);var e=uniLib.DisplayUtils.createBitmapByName("zm_notice_bg_png");this._tipsPanel.addChild(e);var i=uniLib.DisplayUtils.createTextLabel(11250603,egret.HorizontalAlign.CENTER,t,20,e.width);i.y=(e.height-i.height)/2,this._tipsPanel.addChild(i),this._tipsPanel.x=(uniLib.Global.screenWidth-e.width)/2,this._tipsPanel.y=-e.height,egret.Tween.get(this._tipsPanel).to({y:0},200).wait(1e3).to({y:-e.height},200).call(this.destory,this)},t.prototype.destory=function(){this._tipsPanel&&(egret.Tween.removeTweens(this._tipsPanel),uniLib.DisplayUtils.removeAllChildren(this._tipsPanel),uniLib.DisplayUtils.removeFromParent(this._tipsPanel)),this._tipsPanel=null},t.prototype.getContainer=function(){return uniLib.SceneMgr.instance.currentScene.topLayer?uniLib.SceneMgr.instance.currentScene.topLayer:uniLib.SceneMgr.instance.currentScene},t.prototype.showMildWarnShow=function(t){var e=new i;if(e.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeStage,this),e.setText(t),this.getContainer().addChild(e),this.showList.length>0)for(var n=0;n<this.showList.length;n++)this.showList[n].y-=e.height;this.showList.push(e)},t.prototype.removeStage=function(t){var e=t.currentTarget;e.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeStage,this),this.showList.splice(this.showList.indexOf(e),1),e.destory(),e=null},t}();t.PublicTipMgr=e;var i=function(t){function e(){var e=t.call(this)||this;return e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this._bg=uniLib.DisplayUtils.createBitmapByName("zm_notice_bg_png"),this.addChild(this._bg),this._text=uniLib.DisplayUtils.createTextLabel(16777215,egret.HorizontalAlign.CENTER,"",30,88,10,786),this._text.multiline=!0,this.addChild(this._text)},e.prototype.setText=function(t){t&&(this._text.text=t,this._bg.height=2*this._text.textHeight,this.x=Math.round((uniLib.Global.screenWidth-this.width)/2),this.y=uniLib.Global.screenHeight,egret.Tween.get(this).to({y:Math.round((uniLib.Global.screenHeight-this.height)/2)-60},500,egret.Ease.circOut).call(this.showDelay,this))},e.prototype.showDelay=function(){egret.Tween.get(this).wait(2e3).to({y:-this.height},500,egret.Ease.circOut).call(this.destory,this)},e.prototype.destory=function(){egret.Tween.removeTweens(this),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._bg=null,this._text=null},e}(egret.Sprite);t.MildAlertVC=i}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"ol_Time",{get:function(){return this._ol_Time},set:function(t){this._ol_Time=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"fangka",{get:function(){return this._fangka},set:function(t){this._fangka!=t&&(this._fangka=t,uniLib.Global.dispatchEvent(uniLib.ZqEvent.USER_INFO,uniLib.UserInfoEnum.FANGKA))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isClick",{get:function(){return this._isClick},set:function(t){this._isClick!=t&&(this._isClick=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"diamond",{get:function(){return this._diamond},set:function(t){this._diamond!=t&&(this._diamond=t,uniLib.Global.dispatchEvent(uniLib.ZqEvent.USER_INFO,uniLib.UserInfoEnum.DIAMOND))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.init=function(t,e){void 0===e&&(e=!0),this._data=t,this.uid=t.uid,t.headUrl||t.headurl?this._headUrl=t.headUrl||t.headurl:this._headUrl="",this.nickName=t.nickName||t.nickname,this.gender=t.gender,this.platId=t.platId,this.subPlatId=t.subPlatId,1==e&&t.remainder&&(this._chips=t.remainder,this._goldChips=t.remainder),t.hasOwnProperty("chips")&&(this._chips=t.chips),t.goldcoin&&(this._goldChips=t.goldcoin),t.trailscore&&(this._chips=t.trailscore),t.bankChips&&(this._bankChips=t.bankChips),t.sumRecharge&&(this.sumRecharge=t.sumRecharge),t.signature&&(this.signature=t.signature),t.hasOwnProperty("giftCoupon")?this._giftCoupon=t.giftCoupon:t.hasOwnProperty("ticket")&&(this._giftCoupon=t.ticket),t.trailcoin&&(this._freeChips=t.trailcoin),t.hasOwnProperty("fangka")?this._fangka=t.fangka:t.hasOwnProperty("card")&&(this.fangka=t.card),t.hasOwnProperty("diamond")&&(this._diamond=t.diamond)},Object.defineProperty(t,"chips",{get:function(){return this._chips},set:function(t){this._chips!=t&&(this._chips=t,uniLib.Global.dispatchEvent(uniLib.ZqEvent.USER_INFO,uniLib.UserInfoEnum.CHIPS))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"goldChips",{get:function(){return this._goldChips},set:function(t){this._goldChips!=t&&(this._goldChips=t,uniLib.Global.dispatchEvent(uniLib.ZqEvent.USER_INFO,uniLib.UserInfoEnum.GOLDCHIPS))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"freeChips",{get:function(){return this._freeChips},set:function(t){this._freeChips!=t&&(this._freeChips=t,uniLib.Global.dispatchEvent(uniLib.ZqEvent.USER_INFO,uniLib.UserInfoEnum.FREECHIPS))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"headUrl",{get:function(){return this._headUrl},set:function(t){this._headUrl!=t&&(this._headUrl=t,uniLib.Global.dispatchEvent(uniLib.ZqEvent.USER_INFO,uniLib.UserInfoEnum.HEADURL))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"platPoint",{get:function(){return this._platPoint},set:function(t){this._platPoint=t,uniLib.Global.dispatchEvent(uniLib.ZqEvent.USER_INFO,uniLib.UserInfoEnum.PLAT_POINT)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"bankChips",{get:function(){return this._bankChips},set:function(t){this._bankChips=t,uniLib.Global.dispatchEvent(uniLib.ZqEvent.USER_INFO,uniLib.UserInfoEnum.BANK_CHIPS)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"nickname",{get:function(){return this.nickName},set:function(t){this.nickName=t,uniLib.Global.dispatchEvent(uniLib.ZqEvent.USER_INFO,uniLib.UserInfoEnum.NICKNAME)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"giftCoupon",{get:function(){return this._giftCoupon?this._giftCoupon:0},set:function(t){this._giftCoupon=t,uniLib.Global.dispatchEvent(uniLib.ZqEvent.USER_INFO,uniLib.UserInfoEnum.GIFTCOUPON)},enumerable:!0,configurable:!0}),t._chips=0,t._goldChips=0,t._freeChips=0,t._giftCoupon=0,t._ol_Time=-1,t._isClick=!0,t.slipStatus=1,t._platPoint=0,t}();t.UserInfoMgr=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){return function(){this.leftChat=!0,this.notice=!0,this.market=!0,this.task=!0,this.bank=!0,this.rank=!0,this.ssc=!1,this.fupack=!0,this.user=!0,this.horn=!0,this.share=!0,this.lobbyMode=!0}}();t.gameOptions=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function t(){this.remoteMode=!0}return t.fullScreen=function(){(t.isFullScreen=!t.isFullScreen)?window.fullscreen():window.cancelfullscreen()},t.isFullScreen=!1,t}();t.initOptions=e}(chessCommonLib||(chessCommonLib={}));var table;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableVip"},t}();t.TableVip=e}(table||(table={}));var table;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.headMc"},t}();t.headMc=e}(table||(table={}));var chessCommonLib;!function(t){var e=function(){function t(){}return t.getPersonHeadMcId=function(t){var e;return t&&t.length>0&&t.forEach(function(i){1==i.typ&&1==i.optyp&&(e=t[0].id)}),e},t.getPersonVipLevel=function(t){var e;return t&&t.length>0&&t.forEach(function(i){1==i.typ&&(1==i.optyp?e=t[0].id:2==i.optyp&&(e=t[0].vip))}),e},t}();t.FashionDataUtils=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"loadingCls",{set:function(t){this._loadingCls=t},enumerable:!0,configurable:!0}),e.reg=function(t,e,n,o,s,r){null==this._positionDic[t.hashCode]&&(this._positionDic[t.hashCode]=new i),this._positionDic[t.hashCode].position=n&&null!=n?new egret.Point(n,o):t.parent.localToGlobal(t.x,t.y),this._positionDic[t.hashCode].ui=t,s&&(this._positionDic[t.hashCode].loadend=s),r&&(this._positionDic[t.hashCode].thisObj=r),e&&(this._positionDic[t.hashCode].gameId=e),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandle,this)},Object.defineProperty(e,"loadingGameId",{get:function(){return this._loadingGameId},enumerable:!0,configurable:!0}),e.loadGameById=function(t,e,n,o,s,r){this.isLoadingOther()||(this._currentLoadGame=new i,this._currentLoadGame.gameId=e,this._currentLoadGame.loadend=n,this._currentLoadGame.position=t.parent.localToGlobal(t.x,t.y),o&&(this._currentLoadGame.position.x=o+this.offsetX),s&&(this._currentLoadGame.position.y=s),this.loadGame(this._currentLoadGame.gameId,this.onLoadGame,this.onLoadFail,this.onProcess,this))},e.isLoadingOther=function(){return 0!=this._loadingGameId?(uniLib.TipsUtils.showTipsDownToUp("当前正在加载游戏,请等待",!1),!0):t.LoadPanelTipMgr.getInstance().isLoading()?(uniLib.TipsUtils.showTipsDownToUp("正在加载面板资源,请等待"),!0):0==t.ResLoadUitl.hasLoad()&&(uniLib.TipsUtils.showTipsDownToUp("正在加载公共资源,请等待"),!0)},e.loadGame=function(e,i,n,o,s){var r=this;if(0!=e&&e||0!=this.fastGameId&&(e=this.fastGameId),!this.isLoadingOther()){var h=t.ConfigMgr.getInstance().getGameCfgById(e);if(null!=h){var a=function(){console.log(r._loadingGameId+"下载完成！"),r._loadingGameId=0,i&&i.call(s,h)},c=function(){o&&o.call(s,0),h&&(r._loadingGameId=h.gameId,0!=r.fastGameId&&(r.fastGameId=h.gameId),console.log(r._loadingGameId+"开始下载！")),0==uniLib.GameModuleUtils.gameDownloaded(h.gameCodeUrl)?(o&&o.call(s,1),uniLib.GameModuleUtils.downloadGame(h,function(){a()},function(t){var e=(t.itemsLoaded/t.itemsTotal*100).toFixed(0);o&&o.call(s,e)},function(){egret.hasDefinition("egret_native")&&egret_native.deleteUpdateFile(h.gameCodeUrl),console.log(r._loadingGameId+"下载失败！"),r._loadingGameId=0,n&&n.call(s)},r)):a()};uniLib.GameModuleUtils.gameDownloaded(h.gameCodeUrl)||uniLib.ZQGameSdk.netState==uniLib.NetState.WIFI||uniLib.Global.isH5?c():t.ModuleMgr.getInstance().showConfirm("您处于非wifi状态下，是否继续下载？","","确定",c,"取消",null,this)}else uniLib.TipsUtils.showTipsDownToUp("游戏ID不存在")}},e.onTouchHandle=function(e){var i=e.target;0==this._loadingGameId?t.LoadPanelTipMgr.getInstance().isLoading()?uniLib.TipsUtils.showTipsDownToUp("正在加载面板资源,请等待"):this._positionDic[i.hashCode]&&(this._currentLoadGame=this._positionDic[i.hashCode],this.loadGame(this._currentLoadGame.gameId,this.onLoadGame,this.onLoadFail,this.onProcess,this)):uniLib.TipsUtils.showTipsDownToUp("当前正在加载游戏,请等待",!1)},e.onProcess=function(t){uniLib.UIMgr.instance.showUI(this._loadingCls,t,null,!1,!1,this._currentLoadGame.position.x,this._currentLoadGame.position.y*this.gameScaleY)},e.onLoadGame=function(){uniLib.UIMgr.instance.hideUI(this._loadingCls),this._currentLoadGame.gameId||(this._currentLoadGame.gameId=this.fastGameId),this._currentLoadGame.loadend&&(egret.is(this._currentLoadGame.loadend.prototype,"egret.DisplayObjectContainer")?uniLib.PopUpMgr.addPopUp(this._currentLoadGame.loadend,null,!0,!0):this._currentLoadGame.loadend.call(this._currentLoadGame.thisObj,this._currentLoadGame))},e.onLoadFail=function(){uniLib.ZQGameSdk.restart("资源下载失败,请检查网络连接","确定")},e.destroy=function(){for(var t in this._positionDic)this._positionDic[t]&&(this._positionDic[t].ui.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandle,this),this._positionDic[t]=null,delete this._positionDic[t])},e._loadingCls=uniLib.UIMgr.instance.tipsLoadUI,e.fastGameId=0,e.gameScaleY=1,e.offsetX=0,e.ExitTipText="不想连本带利赢回来了吗？就这样退出游戏？",e.showExitConfrimTxt=!0,e._positionDic={},e._loadingGameId=0,e}();t.LoadGameTipUtil=e;var i=function(){return function(){}}();t.LoadGameVo=i}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.loadRes=function(e,n,o){if(uniLib.Global.isH5&&!o)n.call(null);else{if(0!=t.LoadGameTipUtil.loadingGameId)return void uniLib.TipsUtils.showTipsDownToUp("正在加载游戏资源,请等待");if(0==t.ResLoadUitl.hasLoad())return void uniLib.TipsUtils.showTipsDownToUp("正在加载公共资源,请等待");null==this._loadPanelVo?(this._loadPanelVo=new i,this._loadPanelVo.resouceId=e,this._loadPanelVo.succ=n,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.loadGroup(this._loadPanelVo.resouceId)):uniLib.TipsUtils.showTipsDownToUp("正在加载面板资源,请等待")}},e.prototype.onResourceProgress=function(t){},e.prototype.onResourceLoadComplete=function(t){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),this._loadPanelVo.succ.call(null),this._loadPanelVo=null},e.prototype.onResourceLoadError=function(e){t.ModuleMgr.getInstance().showConfirm("资源下载失败,请检查网络？","","确定"),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this)},e.prototype.isLoading=function(){return null!=this._loadPanelVo},e}();t.LoadPanelTipMgr=e;var i=function(){return function(){}}()}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function t(){}return t.numberFormat=function(t){return t<1e5?""+t:t>=1e5&&t<1e6?(t/1e4).toFixed(0)+"万":t>=1e6&&t<1e7?(t/1e4).toFixed(0)+"万":t>=1e7&&t<1e8?(t/1e4).toFixed(0)+"万":(t/1e8).toFixed(2)+"亿"},t.numFormat2=function(t){if(!(t<0)){if("number"!==this.getType(t))return console.error("wocao,不是个数字，它是个",this.getType(t)),"0";if(t<=1e4)return t+"";var e=0,i="";Math.abs(t)>=1e4&&Math.abs(t)<1e8?(e=1e4,i="万"):(e=1e8,i="亿");var n=""+t/e,o=(n=-1!=n.lastIndexOf(".")?n.substring(0,n.lastIndexOf(".")+4):n.substring(0,n.lastIndexOf(".")+5)).split(".")[0],s=n.split(".")[1];if(Number(s)){var r=4-o.length>0?4-o.length:0,h=s.split("");h.length=r,s=h.join("");var a=Number("0."+s).toString();return o+(a=Boolean(a.split(".")[1])?"."+a.toString().split(".")[1]:"")+i}return o+i}},t.getType=function(t){var e=Object.prototype.toString,i={undefined:"undefined",number:"number",boolean:"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object error]":"error","[object Boolean]":"boolean","[object String]":"string","[object Number]":"number"},n=i[typeof t]||i[e.call(t)]||(t?"object":"null");return"number"===n&&(t=+t)!==t?"NaN":n},t}();t.NumberUtil=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function t(){}return t.load=function(t){var e="merge_"+t.join("|");RES.createGroup(e,t,!0),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onUniLibResLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onUniLibResLoadError,this),RES.loadGroup(e)},t.removeEvent=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onUniLibResLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onUniLibResLoadError,this)},t.onUniLibResLoadComplete=function(e){console.warn("Group:"+e.groupName+" loaded"),uniLib.ResUtils.removeGroup(e.groupName),t.isLoad=!0,t.removeEvent()},t.hasLoad=function(){return 0==t.Enable||t.isLoad},t.onUniLibResLoadError=function(e){t.removeEvent(),console.warn("Group:"+e.groupName+" has failed to load")},t.Enable=!1,t.isLoad=!1,t}();t.ResLoadUitl=e}(chessCommonLib||(chessCommonLib={}));var chessCommonLib;!function(t){var e=function(){function t(){}return t.sendGift=function(t,e,i,n,o){void 0===o&&(o="newAnimation");var s=uniLib.DragonUtils.createDragonBonesDisplay("gift_effect_"+t+"_ske_json","gift_effect_"+t+"_tex_json","gift_effect_"+t+"_tex_png",uniLib.DragonType.ARMATURE);s.display.x=i.x,s.display.y=i.y,s.animation.hasAnimation(o)?(s.animation.gotoAndStopByFrame(o,1),null==n&&(n=uniLib.SceneMgr.instance.currentScene?uniLib.SceneMgr.instance.currentScene.effectLayer:egret.MainContext.instance.stage),n.addChild(s.display),egret.Tween.get(s.display).to({x:e.x,y:e.y*uniLib.ScreenUtils.scaleFactor},400,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(s.display),uniLib.SoundMgr.instance.playSound("GiftSound"+t+"_mp3"),uniLib.DragonUtils.runDragonBonesArmature(s,o,1),s.addEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,function(){uniLib.DisplayUtils.removeFromParent(s.display),uniLib.DragonUtils.destoryDragonBonesArmature(s,o)},this)})):egret.log(o+" not-existent")},t}();t.SendGiftUtils=e}(chessCommonLib||(chessCommonLib={}));