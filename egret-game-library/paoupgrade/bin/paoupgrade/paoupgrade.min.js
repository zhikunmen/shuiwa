var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},paoupgrade;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return t&&(i._guninfo=t),i.skinName="PaoBeiPanelSkin",i}return __extends(i,e),i.prototype.childrenCreated=function(){if(e.prototype.childrenCreated.call(this),uniLib.Global.addEventListener(t.CmdConstant.UNLOCK_FISHGUN,this.onMsgReceiveHandler,this),this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchChange,this),this._upBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchChange,this),this.paobei_lst.itemRenderer=t.PaoBeiItem,this._guninfo)this.gunTimeChange(this._guninfo);else{uniLib.Global.addEventListener(t.CmdConstant.GET_FISH_GUNINFO,this.onMsgReceiveHandler,this);var i=new Cmd.RequestFishGunInfoCmd_C;NetMgr.tcpSend(i)}},i.prototype.touchChange=function(t){if(t.target==this._closeBtn)uniLib.PopUpMgr.removePopUp(this);else if(t.target==this._upBtn){var e=this._guninfo.cost-this._guninfo.itemnum,i="是否使用"+e+"钻石替代"+e+"升级水晶进行炮台升级？";uniLib.UserInfo.chips<e&&(i="还差"+e+"个钻石才能替代升级水晶进行炮倍升级，是否前往购买？");var n=new commonConfirm.ConfirmPanel(i,null,null,function(){if(uniLib.UserInfo.chips<e)LobbyModuleMgr.getInstance().showMarketPanel(0);else{var t=new Cmd.UnlockFishGunCmd_C;NetMgr.tcpSend(t)}},function(){},this);uniLib.PopUpMgr.addPopUp(n,null,!0,!0,0,uniLib.PopUpEffect.CENTER)}},i.prototype.onMsgReceiveHandler=function(e){if(e.type==t.CmdConstant.GET_FISH_GUNINFO){var i=e.param;this._guninfo=i.guninfo,this.gunTimeChange(this._guninfo)}else if(e.type==t.CmdConstant.UNLOCK_FISHGUN){var i=e.param;this._guninfo=i.guninfo,this.gunTimeChange(this._guninfo)}},i.prototype.gunTimeChange=function(t){for(var e=[],i=RES.getRes("TableFishGun_json"),n=0;n<i.length;n++)if(i[n].gunTime>t.ctimes){var s=new table.TableFishGun;if(s.unlockDiamon=i[n-1].unlockDiamon,s.unlockGold=i[n-1].unlockGold,s.gunTime=i[n].gunTime,e.push(s),3==e.length)break}this.paobei_lst.dataProvider=new eui.ArrayCollection(e),this.pao_bar.minimum=0,this.pao_bar.maximum=t.cost,this.pao_bar.value=t.itemnum,this.progress_txt.text=t.itemnum+"/"+t.cost,this.progress_txt.anchorOffsetX=this.progress_txt.width>>1},i.prototype.destroy=function(){uniLib.Global.removeEventListener(t.CmdConstant.GET_FISH_GUNINFO,this.onMsgReceiveHandler,this),uniLib.Global.removeEventListener(t.CmdConstant.UNLOCK_FISHGUN,this.onMsgReceiveHandler,this),this._closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchChange,this),this._upBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchChange,this)},i}(eui.ItemRenderer);t.PaoBeiPanel=e,__reflect(e.prototype,"paoupgrade.PaoBeiPanel")}(paoupgrade||(paoupgrade={}));var paoupgrade;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.initUI(),t}return __extends(i,e),i.prototype.initUI=function(){null==this.upgrade&&(this.upgrade=new t.PaoTaiUpgrade,this.upgrade.y=93,this.addChild(this.upgrade)),null==this.redpack&&0==uniLib.Global.is_sandbox&&(this.redpack=new t.TakeRedPack,this.addChild(this.redpack),this.redpack.y=207),null==this.turntable&&0==uniLib.Global.is_sandbox&&(this.turntable=new t.GameInTurnTable,this.addChild(this.turntable),this.turntable.y=320),null==this.award&&0==uniLib.Global.is_sandbox&&(this.award=new t.UpgradeOtherAward,this.award.x=37,this.addChild(this.award))},i.prototype.destroy=function(){this.award&&(this.award.destroy(),this.award=null),this.upgrade&&(this.upgrade.destroy(),this.upgrade=null),this.redpack&&(this.redpack.destroy(),this.redpack=null),this.turntable&&(this.turntable.destroy(),this.turntable=null),this.removeChildren()},i}(egret.DisplayObjectContainer);t.FishPerComponent=e,__reflect(e.prototype,"paoupgrade.FishPerComponent")}(paoupgrade||(paoupgrade={}));var paoupgrade;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.posX=[-239,0,239],e._reqType=0,e.effectType=0,e.skinName="GameInTaskSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.taskItems=[this.item1,this.item2],this.addEvents(),this.initData(1)},e.prototype.addEvents=function(){this.close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),this.open_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),this.left_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),this.right_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),this.scroll.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),uniLib.Global.addEventListener("OnceTaskLobby",this.onMsgReceiveHandler,this),uniLib.Global.addEventListener("IntoFreeGold",this.onMsgReceiveHandler,this)},e.prototype.initData=function(t){if(1==t){var e=new Cmd.RequestOnceTaskLobbyCmd_C;NetMgr.tcpSend(e)}else if(2==t){var i=new Cmd.IntoFreeGoldLobbyCmd_C;NetMgr.tcpSend(i)}this._reqType=t},e.prototype.onMsgReceiveHandler=function(t){if("OnceTaskLobby"==t.type){var e=t.param,i=e.fktasks.concat(e.qhtasks).concat(e.diamondtasks);this.updateTaskList(i)}else if("IntoFreeGold"==t.type){var n=t.param;n.otherTaskInfo&&n.otherTaskInfo.length>0?this.updateTaskList(n.otherTaskInfo):this.destroy()}},e.prototype.updateTaskList=function(t){this.allTasks=[];for(var e=0;e<t.length;e++)t[e]&&t[e].taskStatus<3&&this.allTasks.push(t[e]);if(this.allTasks.sort(function(t,e){return 2==t.taskStatus?t.taskId>e.taskId?-2:-3:t.taskId>e.taskId?1:t.taskId==e.taskId?0:-1}),this.allTasks.length>0){if(this._curTaskId){var i=this.getIndex(this._curTaskId);this.index=-1==i?0:i}else this.index=0,this.item_index=0;this._curTaskId=this.allTasks[this.index].taskId;var n=this.taskItems[this.item_index].setInfo(this.allTasks[this.index]);n?this._receivedTaskId==this._curTaskId?2!=this.effectType&&this.playWanchenEffect(2):(this._receivedTaskId=this._curTaskId,this.playWanchenEffect(1)):this.effectStop()}else 1==this._reqType?this.initData(2):2==this._reqType&&this.destroy()},e.prototype.getIndex=function(t){for(var e=0;e<this.allTasks.length;e++)if(this.allTasks[e].taskId==t)return e;return-1},e.prototype.onTouchTapHandler=function(t){var e=this,i=t.currentTarget;if(i==this.left_btn){if(0==this.index||this.isTween)return;this.index--,this.item_index=1-this.item_index,this.taskItems[this.item_index].x=this.posX[2],this._curTaskId=this.allTasks[this.index].taskId;var n=this.taskItems[this.item_index].setInfo(this.allTasks[this.index]);this.isTween=!0,egret.Tween.get(this.taskItems[this.item_index]).to({x:this.posX[1]},200).call(function(){e.isTween=!1,n?e.playWanchenEffect(2):e.effectStop()}),egret.Tween.get(this.taskItems[1-this.item_index]).to({x:this.posX[0]},200)}else if(i==this.right_btn){if(this.allTasks.length<2||this.index==this.allTasks.length-1||this.isTween)return;this.index++,this.item_index=1-this.item_index,this.taskItems[this.item_index].x=this.posX[0],this._curTaskId=this.allTasks[this.index].taskId;var s=this.taskItems[this.item_index].setInfo(this.allTasks[this.index]);this.isTween=!0,this.effectStop(),egret.Tween.get(this.taskItems[this.item_index]).to({x:this.posX[1]},200).call(function(){e.isTween=!1,s?e.playWanchenEffect(2):e.effectStop()}),egret.Tween.get(this.taskItems[1-this.item_index]).to({x:this.posX[2]},200)}else i==this.scroll?LobbyModuleMgr.getInstance().showNewFuliPanel(this.allTasks[this.index].taskId):i==this.close_btn?egret.Tween.get(this.group).to({y:-112},200).call(function(){e.open_btn.visible=!0}):i==this.open_btn&&(this.open_btn.visible=!1,egret.Tween.get(this.group).to({y:0},200))},e.prototype.playWanchenEffect=function(t){null==this._wanchengEffect&&(this._wanchengEffect=uniLib.DragonUtils.createDragonBonesDisplay("renwuwancheng_ske_json","renwuwancheng_tex_json","renwuwancheng_tex_png",uniLib.DragonType.ARMATURE),this._wanchengEffect.touchEnabled=!1),1==this.effectType&&this._wanchengEffect.removeEventListener(egret.Event.LOOP_COMPLETE,this.effectComplete,this),this.effectType=t,this._wanchengEffect.display.x=135,this._wanchengEffect.display.y=42,this.group.addChild(this._wanchengEffect.display),1==this.effectType&&this._wanchengEffect.addEventListener(egret.Event.LOOP_COMPLETE,this.effectComplete,this),uniLib.DragonUtils.runDragonBonesArmature(this._wanchengEffect,this.effectType+"",1==this.effectType?1:0)},e.prototype.effectComplete=function(t){this._wanchengEffect.removeEventListener(egret.Event.LOOP_COMPLETE,this.effectComplete,this),this.effectType=2,uniLib.DragonUtils.runDragonBonesArmature(this._wanchengEffect,this.effectType+"",0)},e.prototype.effectStop=function(){this._wanchengEffect&&(this._wanchengEffect.animation.stop(),uniLib.DisplayUtils.removeFromParent(this._wanchengEffect.display))},e.prototype.removeEvents=function(){this.close_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),this.open_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),this.left_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),this.right_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),this.scroll.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),uniLib.Global.removeEventListener("OnceTaskLobby",this.onMsgReceiveHandler,this),uniLib.Global.removeEventListener("IntoFreeGold",this.onMsgReceiveHandler,this)},e.prototype.destroy=function(){this.taskItems=null,this.isTween=!1,this._wanchengEffect&&(uniLib.DisplayUtils.removeFromParent(this._wanchengEffect.display),uniLib.DragonUtils.destoryDragonBonesArmature(this._wanchengEffect,this.effectType+""),this._wanchengEffect=null),egret.Tween.removeTweens(this.item1),egret.Tween.removeTweens(this.item2),egret.Tween.removeTweens(this.group),this.removeEvents(),this.removeChildren(),uniLib.DisplayUtils.removeFromParent(this)},e}(eui.Component);t.GameInTaskPanel=e,__reflect(e.prototype,"paoupgrade.GameInTaskPanel")}(paoupgrade||(paoupgrade={}));var paoupgrade;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="GameInTurnTableSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchEnabled=!0,this.receive.touchEnabled=!1,this.addEvents(),this.getReward(3)},e.prototype.addEvents=function(){uniLib.Global.addEventListener("turntableinfo",this.onUpdateInfo,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandle,this)},e.prototype.removeEvents=function(){uniLib.Global.removeEventListener("turntableinfo",this.onUpdateInfo,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandle,this),this.timer&&this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimerHandler,this)},e.prototype.onUpdateInfo=function(t){this._info=t.param,this.countDown=this._info.countDownSec,this.countDown<=0?(this.timer&&this.timer.stop(),-1==this.countDown?this.destroy():0==this.countDown&&(this.addAnim(),this.turn_table.visible=!1)):(this.turn_table.visible=!0,this.initTime(this.countDown),this.zhuanpan_btn&&(this.zhuanpan_btn.animation.stop(),uniLib.DisplayUtils.removeFromParent(this.zhuanpan_btn.display),this.receive.visible=!1))},e.prototype.initTime=function(t){null==this.timer&&(this.timer=new egret.Timer(1e3),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimerHandler,this)),this.timer.reset(),this.timer.start(),this.turn_table.label=uniLib.StringUtils.formatMMSS(this.countDown)},e.prototype.addAnim=function(){if(null==this.zhuanpan_btn){var t="game_zhuanpan";this.zhuanpan_btn=uniLib.DragonUtils.createDragonBonesDisplay(t+"_ske_json",t+"_tex_json",t+"_tex_png",uniLib.DragonType.ARMATURE)}this.addChildAt(this.zhuanpan_btn.display,0),this.zhuanpan_btn.display.x=37,this.zhuanpan_btn.display.y=42,uniLib.DragonUtils.runDragonBonesArmature(this.zhuanpan_btn,"newAnimation",0),this.receive.visible=!0},e.prototype.onTouchHandle=function(t){0==this.countDown?LobbyModuleMgr.getInstance().showGameInTurn(this._info):uniLib.TipsUtils.showTipsDownToUp("多玩一会儿游戏才能抽奖哦！")},e.prototype.onTimerHandler=function(t){this.countDown>0?(this.countDown--,this.turn_table.label=uniLib.StringUtils.formatMMSS(this.countDown)):(this.timer.stop(),this.addAnim(),this.turn_table.visible=!1,this.receive.visible=!0)},e.prototype.getReward=function(t){var e=new Cmd.GetInfoTurnTableCmd_C;e.opType=t,NetMgr.tcpSend(e)},e.prototype.destroy=function(){this.zhuanpan_btn&&(uniLib.DragonUtils.destoryDragonBonesArmature(this.zhuanpan_btn,"newAnimation"),uniLib.DisplayUtils.removeFromParent(this.zhuanpan_btn.display)),this.removeEvents(),this.removeChildren(),uniLib.DisplayUtils.removeFromParent(this)},e}(eui.Component);t.GameInTurnTable=e,__reflect(e.prototype,"paoupgrade.GameInTurnTable")}(paoupgrade||(paoupgrade={}));var paoupgrade;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="NoviceRedPackageBtnSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchEnabled=!0,this.touchChildren=!1,this.updateData(),uniLib.Global.addEventListener(uniLib.ZqEvent.USER_INFO,this.onUpRedPack,this)},e.prototype.onUpRedPack=function(t){t.param==uniLib.UserInfoEnum.GIFTCOUPON&&this.updateData()},e.prototype.updateData=function(){this.novice_bar.minimum=0;var t=uniLib.UserInfo.giftCoupon;this.novice_bar.value=t,t>3e3?(this.novice_bar.maximum=t,this.pro_lbl.text="3000/3000"):(this.novice_bar.maximum=3e3,this.pro_lbl.text=t+"/3000")},e.prototype.destroy=function(){uniLib.Global.removeEventListener(uniLib.ZqEvent.USER_INFO,this.onUpRedPack,this),this.removeChildren()},e}(eui.Component);t.NoviceRedPackageBtn=e,__reflect(e.prototype,"paoupgrade.NoviceRedPackageBtn")}(paoupgrade||(paoupgrade={}));var paoupgrade;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="PaoBeiItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.pao_text.text=e.gunTime+"倍",this.reward_num.text="x"+e.unlockGold,this.need_num.text="x"+e.unlockDiamon},e}(eui.ItemRenderer);t.PaoBeiItem=e,__reflect(e.prototype,"paoupgrade.PaoBeiItem")}(paoupgrade||(paoupgrade={}));var paoupgrade;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="GameInTaskItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.task_bar.minimum=0},e.prototype.setInfo=function(t){var e=ConfigMgr.getInstance().getTaskCfgById(t.taskId);return this.reward_icon.source="game_prop_json.bag_daoju_"+e.taskReward[0].goodId,commonConfirm.ResUtil.limitImageSize(this.reward_icon,63),e.taskReward[0].goodNbr>=1e4?this.reward_num.text=(e.taskReward[0].goodNbr/1e4).toFixed(2)+"万":this.reward_num.text=e.taskReward[0].goodNbr+"",this.task_title.text=e.taskDesc,this.task_progress.text=t.current+"/"+e.taskCondition,this.task_bar.maximum=e.taskCondition,this.task_bar.value=t.current,t.taskStatus==Cmd.TaskStatus.Task_Status_Complete},e.prototype.destroy=function(){this.removeChildren()},e}(eui.Component);t.GameInTaskItem=e,__reflect(e.prototype,"paoupgrade.GameInTaskItem")}(paoupgrade||(paoupgrade={}));var paoupgrade;!function(t){var e=function(){function t(){}return t.RES_JSON="resource/paoupgrade/paoupgrade.res_7c3fb449.json",t.THM_JSON="resource/paoupgrade/gameEui_b8de3802.json",t.PUB_PAOUPGRADE="pub_paoupgrade",t.PUB_GAMEINTASK="pub_gameintask",t.PUB_PAOBEI="pub_paobei",t}();t.PaopgradeConsts=e,__reflect(e.prototype,"paoupgrade.PaopgradeConsts")}(paoupgrade||(paoupgrade={}));var paoupgrade;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._opening=!0,t._tweening=!1,t.skinName="PaoTaiUpgradeSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addEvents(),this.initData(),this.group.touchChildren=!1,this.group.touchEnabled=!0},i.prototype.addEvents=function(){this.open_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),this.group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),uniLib.Global.addEventListener(uniLib.ZqEvent.USER_INFO,this.onUserInfoChanged,this),uniLib.Global.addEventListener(t.CmdConstant.GET_FISH_GUNINFO,this.onMsgReceiveHandler,this),uniLib.Global.addEventListener(t.CmdConstant.UNLOCK_FISHGUN,this.onMsgReceiveHandler,this)},i.prototype.initData=function(){var t=new Cmd.RequestFishGunInfoCmd_C;NetMgr.tcpSend(t)},i.prototype.onUserInfoChanged=function(t){this._guninfo&&this.updateReward()},i.prototype.onMsgReceiveHandler=function(e){if(e.type==t.CmdConstant.GET_FISH_GUNINFO){var i=e.param;this._guninfo=i.guninfo,this.unlock_gun.text="解锁"+this._guninfo.ntimes+"倍炮",this.unlock_gun.anchorOffsetX=this.unlock_gun.width>>1,this.updateReward()}else if(e.type==t.CmdConstant.UNLOCK_FISHGUN){var n=e.param;this._guninfo=n.guninfo,this.unlock_gun.text="解锁"+this._guninfo.ntimes+"倍炮",this.unlock_gun.anchorOffsetX=this.unlock_gun.width>>1,this.updateReward()}return void 0==this._guninfo.ntimes?(uniLib.DisplayUtils.removeFromParent(this),void this.destroy()):void 0},i.prototype.playFinishEffect=function(){null==this._finishEffect&&(this._finishEffect=uniLib.DragonUtils.createDragonBonesDisplay("finish_ske_json","finish_tex_json","finish_tex_png",uniLib.DragonType.ARMATURE),this._finishEffect.touchEnabled=!1),this._finishEffect.display.x=95,this._finishEffect.display.y=35,this.group.addChild(this._finishEffect.display),uniLib.DragonUtils.runDragonBonesArmature(this._finishEffect,"newAnimation",0)},i.prototype.updateReward=function(){this._guninfo.itemnum>=this._guninfo.cost?(this.unlock_gold.text="领取"+this._guninfo.reward+"金币",this.playFinishEffect(),this.progress_group.visible=!1,this._canReward=!0):(this._finishEffect&&(this._finishEffect.animation.stop(),uniLib.DisplayUtils.removeFromParent(this._finishEffect.display)),this.unlock_gold.text="",this.progress_group.visible=!0,this.progress_txt.text=this._guninfo.itemnum+"/"+this._guninfo.cost,this.pro_bar.minimum=0,this.pro_bar.maximum=this._guninfo.cost,this.pro_bar.value=this._guninfo.itemnum,this._canReward=!1)},i.prototype.onTouchTapHandler=function(e){var i=this;if(e.target==this.open_btn){if(this._tweening)return;this._tweening=!0,this._opening?egret.Tween.get(this.group).to({scaleX:.01,scaleY:.01},200).call(function(){i._opening=!1,i._tweening=!1,i.group.visible=!1}):(this.group.visible=!0,egret.Tween.get(this.group).to({scaleX:1,scaleY:1},200).call(function(){i._opening=!0,i._tweening=!1}))}else if(e.target==this.group)if(this._canReward){var n=new Cmd.UnlockFishGunCmd_C;NetMgr.tcpSend(n)}else LoadPanelTipMgr.getInstance().loadRes(t.PaopgradeConsts.PUB_PAOBEI,function(){var e=new t.PaoBeiPanel(i._guninfo);e.scaleX=LobbyModuleMgr.getInstance().panelScaleX,uniLib.PopUpMgr.addPopUp(e,null,!0,!0,0,uniLib.PopUpEffect.CENTER,874*e.scaleX,544)})},i.prototype.removeEvents=function(){this.open_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),this.group.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),uniLib.Global.removeEventListener(uniLib.ZqEvent.USER_INFO,this.onUserInfoChanged,this),uniLib.Global.removeEventListener(t.CmdConstant.GET_FISH_GUNINFO,this.onMsgReceiveHandler,this),uniLib.Global.removeEventListener(t.CmdConstant.UNLOCK_FISHGUN,this.onMsgReceiveHandler,this)},i.prototype.destroy=function(){this._finishEffect&&(uniLib.DisplayUtils.removeFromParent(this._finishEffect.display),uniLib.DragonUtils.destoryDragonBonesArmature(this._finishEffect,"newAnimation"),this._finishEffect=null),this._tweening=!1,this.removeEvents(),egret.Tween.removeTweens(this.group),this.removeChildren()},i}(eui.Component);t.PaoTaiUpgrade=e,__reflect(e.prototype,"paoupgrade.PaoTaiUpgrade")}(paoupgrade||(paoupgrade={}));var paoupgrade;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._opening=!0,e._tweening=!1,e.skinName="TakeRedPackSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEvents(),this.initData(),this.group.touchChildren=!1,this.group.touchEnabled=!0},e.prototype.addEvents=function(){this.open_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),this.group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),uniLib.Global.addEventListener("get_fish_luckydraw",this.onMsgReceiveHandler,this)},e.prototype.initData=function(){var t=new Cmd.GetFishLuckyDrawInfoLobbyCmd_C;NetMgr.tcpSend(t)},e.prototype.onMsgReceiveHandler=function(t){this._fishinfo=t.param;var e=this._fishinfo.bonus+"";this._fishinfo.bonus>1e4&&(e=this._fishinfo.bonus/1e4+"万"),this.unlock_gun.text=e,this.updateReward()},e.prototype.playFinishEffect=function(){null==this._finishEffect&&(this._finishEffect=uniLib.DragonUtils.createDragonBonesDisplay("finish_ske_json","finish_tex_json","finish_tex_png",uniLib.DragonType.ARMATURE),this._finishEffect.touchEnabled=!1),this._finishEffect.display.x=95,this._finishEffect.display.y=35,this.group.addChild(this._finishEffect.display),uniLib.DragonUtils.runDragonBonesArmature(this._finishEffect,"newAnimation",0)},e.prototype.updateReward=function(){var t=this;this._fishinfo.killNum>=5?(this.unlock_gold.visible=!0,this.playFinishEffect(),this.progress_group.visible=!1,this._opening||(this.group.visible=!0,egret.Tween.get(this.group).to({scaleX:1,scaleY:1},200).call(function(){t._opening=!0,t._tweening=!1}))):(this._finishEffect&&(this._finishEffect.animation.stop(),uniLib.DisplayUtils.removeFromParent(this._finishEffect.display)),this.unlock_gold.visible=!1,this.progress_group.visible=!0,this.progress_txt.text=this._fishinfo.killNum+"/5",this.pro_bar.minimum=0,this.pro_bar.maximum=5,this.pro_bar.value=this._fishinfo.killNum)},e.prototype.onTouchTapHandler=function(t){var e=this;if(t.target==this.open_btn){if(this._tweening)return;this._tweening=!0,this._opening?egret.Tween.get(this.group).to({scaleX:.01,scaleY:.01},200).call(function(){e._opening=!1,e._tweening=!1,e.group.visible=!1}):(this.group.visible=!0,egret.Tween.get(this.group).to({scaleX:1,scaleY:1},200).call(function(){e._opening=!0,e._tweening=!1}))}else t.target==this.group&&LobbyModuleMgr.getInstance().showFishDraw(this._fishinfo)},e.prototype.removeEvents=function(){this.open_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),this.group.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),uniLib.Global.removeEventListener("get_fish_luckydraw",this.onMsgReceiveHandler,this)},e.prototype.destroy=function(){this._finishEffect&&(uniLib.DisplayUtils.removeFromParent(this._finishEffect.display),uniLib.DragonUtils.destoryDragonBonesArmature(this._finishEffect,"newAnimation"),this._finishEffect=null),this._tweening=!1,this.removeEvents(),egret.Tween.removeTweens(this.group),this.removeChildren()},e}(eui.Component);t.TakeRedPack=e,__reflect(e.prototype,"paoupgrade.TakeRedPack")}(paoupgrade||(paoupgrade={}));var paoupgrade;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName="UpgradeOtherAwardSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initUI(),this.addEvents(),this.groupRect=new egret.Rectangle(0,0,this.goodGroup.width,this.goodGroup.height),this.paopao.touchEnabled=!0,this.goodGroup.touchEnabled=!1,this.goodGroup.touchChildren=!1},i.prototype.initUI=function(){this.tableFishGuns=[];for(var t=RES.getRes("TableFishGun_json"),e=0;e<t.length;e++)t[e].otherAward.length>0&&this.tableFishGuns.push(t[e]);var i=this.gunTimeChange(MJLobbyData.getInstance().fishGunBei);this.changeReward(i)},i.prototype.addEvents=function(){this.paopao.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),uniLib.Global.addEventListener(t.CmdConstant.UNLOCK_FISHGUN,this.onMsgReceiveHandler,this)},i.prototype.gunTimeChange=function(t){var e=this.tableFishGuns.length;if(t<=this.tableFishGuns[0].gunTime)return this.tableFishGuns[0].otherAward[0];if(t>this.tableFishGuns[e-1].gunTime)return null;for(var i=0;i<this.tableFishGuns.length-2;i++)if(this.tableFishGuns[i].gunTime<t&&t<=this.tableFishGuns[i+1].gunTime)return this.tableFishGuns[i+1].otherAward[0]},i.prototype.changeReward=function(t){if(null==t)return void this.destroy();this.goodIcon.source="game_prop_json.bag_daoju_"+t.goodId,commonConfirm.ResUtil.limitImageSize(this.goodIcon,60),this.goodIcon.anchorOffsetX=this.goodIcon.width>>1,this.goodIcon.anchorOffsetY=this.goodIcon.height>>1,this.goodItem.source="game_prop_json.bag_daoju_"+t.goodId,commonConfirm.ResUtil.limitImageSize(this.goodItem,100),this.goodItem.anchorOffsetX=this.goodItem.width>>1,this.goodItem.anchorOffsetY=this.goodItem.height>>1;var e=ConfigMgr.getInstance().getGoodCfgById(t.goodId);this.goodName.text=e.goodName,this.goodNum.text="x"+t.goodNbr,this.goodDesc.text=e.goodIntroduction,this.goodNum1.text=t.goodNbr+"",this.goodNum1.anchorOffsetX=this.goodNum1.width>>1},i.prototype.onTouchTapHandler=function(t){var e=this;this.goodGroup.visible=!this.goodGroup.visible,this.goodGroup.visible&&egret.setTimeout(function(){egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,e.stageTouchHandler,e)},this,10)},i.prototype.stageTouchHandler=function(t){var e=this.goodGroup.globalToLocal(t.stageX,t.stageY);this.groupRect.containsPoint(e)||(egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.stageTouchHandler,this),this.goodGroup.visible=!1)},i.prototype.onMsgReceiveHandler=function(t){var e=t.param,i=this.gunTimeChange(e.guninfo.ctimes);this.changeReward(i)},i.prototype.removeEvents=function(){egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.stageTouchHandler,this),this.paopao.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandler,this),uniLib.Global.removeEventListener(t.CmdConstant.UNLOCK_FISHGUN,this.onMsgReceiveHandler,this)},i.prototype.destroy=function(){this.removeEvents(),this.removeChildren(),uniLib.DisplayUtils.removeFromParent(this)},i}(eui.Component);t.UpgradeOtherAward=e,__reflect(e.prototype,"paoupgrade.UpgradeOtherAward")}(paoupgrade||(paoupgrade={}));var paoupgrade;!function(t){var e=function(){function t(){}return t.GET_FISH_GUNINFO="get_fish_guninfo",t.UNLOCK_FISHGUN="unlock_fishgun",t}();t.CmdConstant=e,__reflect(e.prototype,"paoupgrade.CmdConstant")}(paoupgrade||(paoupgrade={}));var PaoUpgradeReciveMgr=function(){function t(){}return t}();__reflect(PaoUpgradeReciveMgr.prototype,"PaoUpgradeReciveMgr");var Cmd;!function(t){function e(t){MJLobbyData.getInstance().fishGunBei=t.guninfo.ctimes,uniLib.Global.dispatchEvent(paoupgrade.CmdConstant.GET_FISH_GUNINFO,t,!0)}function i(t){MJLobbyData.getInstance().fishGunBei=t.guninfo.ctimes,uniLib.Global.dispatchEvent(paoupgrade.CmdConstant.UNLOCK_FISHGUN,t,!0)}t.OnRequestFishGunInfoCmd_S=e,t.OnUnlockFishGunCmd_S=i}(Cmd||(Cmd={}));