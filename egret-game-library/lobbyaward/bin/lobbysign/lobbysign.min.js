var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},lobbysign;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName="LobbyGetAwardSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},i.prototype.destroy=function(){uniLib.PopUpMgr.removePopUp(this),uniLib.DisplayUtils.stopTweenGroup(this.guang)},i.prototype.setData=function(e,i){var n;if(1==i){for(var a=0;a<t.Data.sign[0].signReward.length;a++)if(t.Data.sign[0].signReward[a].dayNum==e){n=t.Data.sign[0].signReward[a].reward;break}}else if(2==i)for(var a=0;a<t.Data.sign[0].cumulativeReward.length;a++)if(t.Data.sign[0].cumulativeReward[a].cumulativeNum==e){n=t.Data.sign[0].cumulativeReward[a].reward;break}uniLib.DisplayUtils.playTweenGroup(this.guang,!0),this._freeGoldMc=uniLib.DragonUtils.createDragonBonesDisplay("mjlb_freegold_effect_ske_json","mjlb_freegold_effect_tex_json","mjlb_freegold_effect_tex_png","MovieClip"),dragonBones.WorldClock.clock.add(this._freeGoldMc),this._freeGoldMc.display.x=uniLib.Global.designWidth/2-this._freeGoldMc.display.width,this._freeGoldMc.display.y=uniLib.Global.designHeight/2-this._freeGoldMc.display.height,this.addChildAt(this._freeGoldMc.display,1),this._freeGoldMc&&this._freeGoldMc.animation.play("freegold",1);var o;for(var s in t.Data.goods)if(s==n.goodsId){o=t.Data.goods[s].goodIcon;break}this.awardimage.source=o;var r;r=n.count,this.jinbiText.text=r,this.okBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.destroy,this)},i}(eui.Component);t.LobbyGetAwardPanel=e,__reflect(e.prototype,"lobbysign.LobbyGetAwardPanel")}(lobbysign||(lobbysign={}));var lobbysign;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName="LobbySignSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i.prototype.initUI=function(){t.SignSendMgr.getUserSignInfo();var e=RES.getRes("TableSignIn_json"),i=0;e.forEach(function(e){e.lobbyId==MJLobbyData.getInstance().lobbyId&&(t.Data.sign[i++]=e)});var n=RES.getRes("TableGoodsConfig_json");n.forEach(function(e){t.Data.goods[e.goodId]=e})},i.prototype.addEvent=function(){this._signBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sign,this),uniLib.Global.addEventListener(t.SignConst.SIGN_INFO,this.setData,this),uniLib.Global.addEventListener(t.SignConst.SIGN_TODAY,this.signDayOfWeek,this),uniLib.Global.addEventListener(t.SignConst.SIGN_CONTINUE,this.getReward,this)},i.prototype.removeEvent=function(){uniLib.Global.removeEventListener(t.SignConst.SIGN_INFO,this.setData,this),uniLib.Global.removeEventListener(t.SignConst.SIGN_TODAY,this.signDayOfWeek,this),uniLib.Global.removeEventListener(t.SignConst.SIGN_CONTINUE,this.getReward,this),this._signBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sign,this)},i.prototype.setData=function(e){var i=e.param;if(i){this._data=i,this._data.bTodayReceived&&(this._signBtn.enabled=!1),this._rewardlist=this._data["continue"],this._signRewardItemList.itemRenderer=t.SignRewardItemPanel,this._signRewardItemList.dataProvider=new eui.ArrayCollection(this._rewardlist),this._dayofweeklsit=[];for(var n=0;7>n;n++)this._dayofweeklsit.push(this._data);this._signDayOfWeekItemList.itemRenderer=t.SignDayOfWeekItemPanel,this._signDayOfWeekItemList.dataProvider=new eui.ArrayCollection(this._dayofweeklsit),this.update()}},i.prototype.update=function(){if(this._data)if(this._totalTxt.text="累计签到"+this._data.continueDay+"天",this._data.continueDay<=3)this._expBr.width=this._data.continueDay/3*130;else if(this._data.continueDay<=5)this._expBr.width=200+(this._data.continueDay-3)/2*100;else if(this._data.continueDay<=7)this._expBr.width=380+(this._data.continueDay-5)/2*105;else{var t=110*(this._data.continueDay-7)/21;t=t>110?110:t,this._expBr.width=560+t}},i.prototype.sign=function(){return this._data.bTodayReceived?void uniLib.TipsUtils.showTipsDownToUp("今日已签到"):void t.SignSendMgr.getSignToday(!0)},i.prototype.getReward=function(e){var i=e.param;this.showAwardPanel(i.continueSignId,2),t.SignSendMgr.getUserSignInfo()},i.prototype.signDayOfWeek=function(e){var i=e.param;this.showAwardPanel(i.curWeek,1),t.SignSendMgr.getUserSignInfo()},i.prototype.showAwardPanel=function(e,i){var n=new t.LobbyGetAwardPanel;n.setData(e,i),uniLib.PopUpMgr.addPopUp(n,null,!0,!0)},i.rewardId=-1,i}(commonpanel.LobbyBaseEuiPanel);t.LobbySignPanel=e,__reflect(e.prototype,"lobbysign.LobbySignPanel")}(lobbysign||(lobbysign={}));var lobbysign;!function(t){var e=function(){function t(){}return t.RES_JSON="resource/lobbysign/lobbysign.res_bb2dd6c0.json",t.THM_JSON="resource/lobbysign/gameEui_9a01ac7c.json",t.LOBBY_SIGN="lobby_sign",t.SIGN_INFO="SIGNINFO_RETURN",t.SIGN_TODAY="SIGNTODAY_DATA",t.SIGN_CONTINUE="SIGN_CONTINUE",t}();t.SignConst=e,__reflect(e.prototype,"lobbysign.SignConst");var i=function(){function t(){}return t.sign={},t.goods={},t.task={},t}();t.Data=i,__reflect(i.prototype,"lobbysign.Data")}(lobbysign||(lobbysign={}));var lobbysign;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._id=-1,t.skinName="SignDayOfWeekItemSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},i.prototype.dataChanged=function(){if(this.info=this.data,this.data&&(this._id=this.itemIndex,t.Data.sign[0]&&t.Data.sign[0].signReward[this.itemIndex])){this._sRewardTabledata=t.Data.sign[0].signReward[this.itemIndex];var e=["星期一","星期二","星期三","星期四","星期五","星期六","星期日"];this.dayTxt.text=e[this.itemIndex],this.goldTxt.text=this._sRewardTabledata.reward.count+"";var i={1e3:1,2e3:2,5e3:3,6e3:4};this.icon.source="mjl_sign_rewards"+i[this._sRewardTabledata.reward.count],this.tick.visible=!1,this.info.signWeek&&this.info.signWeek.length>0&&-1!=this.info.signWeek.indexOf(this.itemIndex+1)&&(this.tick.visible=!0)}},i}(eui.ItemRenderer);t.SignDayOfWeekItemPanel=e,__reflect(e.prototype,"lobbysign.SignDayOfWeekItemPanel")}(lobbysign||(lobbysign={}));var Cmd;!function(t){function e(t,e,i){void 0===i&&(i=!0),uniLib.Global.dispatchEvent(t,e,i)}function i(t){e(lobbysign.SignConst.SIGN_TODAY,t)}function n(t){e(lobbysign.SignConst.SIGN_CONTINUE,t)}t.signDispatch=e,t.OnUserSignTodayLobbyCmd_S=i,t.OnUserSignContinueLobbyCmd_S=n}(Cmd||(Cmd={}));var lobbysign;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._id=-1,t.skinName="SignRewardItemSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},i.prototype.dataChanged=function(){this.data&&(this.info=this.data,this._id=this.data.id,t.Data.sign[0]&&t.Data.sign[0].cumulativeReward[this.itemIndex]&&(this._cRewardTabledata=t.Data.sign[0].cumulativeReward[this.itemIndex],this.info.bCouldReceive&&!this.info.bReceived?this.guangtween(!0):this.guangtween(!1),this.dayTxt.text="累计"+this.info.continueDay+"天",this.goldTxt.text=this._cRewardTabledata.reward.count+t.Data.goods[this._cRewardTabledata.reward.goodsId].goodName,this.bg.source="mjl_sign_rewards"+this._id,this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getReward,this)))},i.prototype.getReward=function(e){return this.data.bCouldReceive?(t.LobbySignPanel.rewardId=this._id,void t.SignSendMgr.getSignToday(!1,this.data.continueDay)):void uniLib.TipsUtils.showTipsDownToUp("当前礼包不可领")},i.prototype.guangtween=function(t){uniLib.DisplayUtils.stopTweenGroup(this.guang),this._guangImg.visible=!1,t&&(this._guangImg.visible=!0,uniLib.DisplayUtils.playTweenGroup(this.guang,!0))},i}(eui.ItemRenderer);t.SignRewardItemPanel=e,__reflect(e.prototype,"lobbysign.SignRewardItemPanel")}(lobbysign||(lobbysign={}));var lobbysign;!function(t){var e=function(){function t(){}return t.getUserSignInfo=function(){var t=new Cmd.UserSignInfoLobbyCmd_C;t.lobbyId=MJLobbyData.getInstance().lobbyId,NetMgr.tcpSend(t)},t.getSignToday=function(t,e){var i;t?i=new Cmd.UserSignTodayLobbyCmd_C:(i=new Cmd.UserSignContinueLobbyCmd_C,i.continueSignId=e),i.lobbyId=MJLobbyData.getInstance().lobbyId,NetMgr.tcpSend(i)},t}();t.SignSendMgr=e,__reflect(e.prototype,"lobbysign.SignSendMgr")}(lobbysign||(lobbysign={}));