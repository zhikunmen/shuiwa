var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},yaoqianshu;!function(t){var e=function(){function t(){}return t.RES_JSON="resource/yaoqianshu/yaoqianshu.res_13e8f3c6.json",t.THM_JSON="resource/yaoqianshu/gameEui_3de05bcc.json",t.PUB_YAOQIANSHU="pub_yaoqianshu",t}();t.YaoQianShuConsts=e,__reflect(e.prototype,"yaoqianshu.YaoQianShuConsts")}(yaoqianshu||(yaoqianshu={}));var yaoqianshu;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.GOLDTREE_YAODONG="yaodong",t.GOLDTREE_JINBISHAO="jinbishao",t.GOLDTREE_JINBIDUO="jinbiduo",t.skinName="YaoQianShuSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addEvents();var t="yaoqianshu";this._anim=uniLib.DragonUtils.createDragonBonesDisplay(t+"_ske_json",t+"_tex_json",t+"_tex_png",uniLib.DragonType.ARMATURE),this._anim.display.x=490,this._anim.display.y=380,this._anim.display.scaleX=this._anim.display.scaleY=1.5,this._anim.display.touchEnabled=!0,this.addChild(this._anim.display),this._glodNum.minimum=0,this._mcardTip.touchEnabled=!1,this.initUI()},i.prototype.addEvents=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandle,this),uniLib.Global.addEventListener(t.CmdConstant.GLODELE_DATA,this.updata,this),uniLib.Global.addEventListener(t.CmdConstant.GLODELE_GETREWARD,this.getRewardResult,this)},i.prototype.removeEvents=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandle,this),uniLib.Global.removeEventListener(t.CmdConstant.GLODELE_DATA,this.updata,this),uniLib.Global.removeEventListener(t.CmdConstant.GLODELE_GETREWARD,this.getRewardResult,this)},i.prototype.onTouchHandle=function(t){var e=this,i=t.target;i==this._closeBtn?uniLib.PopUpMgr.removePopUp(this):i==this._pickUp?MJLobbyData.getInstance().ismcardvalid?this.getReward():this.getMonthCard():i==this._anim.display?(this.playAnim(this.GOLDTREE_YAODONG),MJLobbyData.getInstance().ismcardvalid||(this._mcardTip.visible=!0),this.clear(),this.timer=setTimeout(function(){e.treeShake(e.moneyTreeData.produce),e._mcardTip.visible=!1},1e3)):(i==this._upgrade||i==this._recharge)&&LobbyModuleMgr.getInstance().showMarketPanel(0)},i.prototype.updata=function(t){this.moneyTreeData=t.param;var e=this.moneyTreeData.level;this.treeShake(this.moneyTreeData.produce),Boolean(this.moneyTreeData.receive)?(this._pickUp.currentState="up",this._pickUp.touchEnabled=!0):(this._pickUp.currentState="disabled",this._pickUp.touchEnabled=!1),this._level.text="L"+e,this.getGlod(this.moneyTreeData.produce,e)},i.prototype.getGlod=function(t,e){var i=5*(60*(e-1)+1e3);this._glodNum.maximum=i,this._glodNum.value=t,this._progressTex.textFlow=[{text:t+"",style:{textColor:16777215}},{text:"/"+i,style:{textColor:16761904}}]},i.prototype.getRewardResult=function(t){t.param;uniLib.TipsUtils.showTipsDownToUp("领取了"+this.moneyTreeData.produce+"金币！"),this.initUI()},i.prototype.getMonthCard=function(){var t=new uniLib.MsgBox("月卡用户才能领取，是否立即开通月卡？","","开通",function(){var t=new Cmd.GetMonthCardInfoLobbyCmd_C;t.lobbyId=NetMgr.getLoginCfg().lobbyId,NetMgr.tcpSend(t)},"取消",null,this);uniLib.PopUpMgr.addPopUp(t,null,!0,!0,!1,uniLib.PopUpEffect.CENTER)},i.prototype.getReward=function(){var t=new Cmd.GetMoneyTreeGoldLobby_C;t.lobbyId=NetMgr.getLoginCfg().lobbyId,NetMgr.tcpSend(t)},i.prototype.initUI=function(){var t=new Cmd.GetMoneyTreeDataLobby_C;t.lobbyId=NetMgr.getLoginCfg().lobbyId,NetMgr.tcpSend(t)},i.prototype.treeShake=function(t){t>2.5*(60*(this.moneyTreeData.level-1)+1e3)?this.playAnim(this.GOLDTREE_JINBIDUO):this.playAnim(this.GOLDTREE_JINBISHAO)},i.prototype.playAnim=function(t){this.animationName=t,uniLib.DragonUtils.runDragonBonesArmature(this._anim,t)},i.prototype.clear=function(){this.timer&&clearTimeout(this.timer)},i.prototype.destroy=function(){this.removeEvents(),this._mcardTip.visible=!1,this.clear(),uniLib.DisplayUtils.removeFromParent(this),uniLib.DisplayUtils.removeFromParent(this._anim.display),this.animationName&&uniLib.DragonUtils.destoryDragonBonesArmature(this._anim,this.animationName)},i}(eui.Component);t.YaoQianShuPanel=e,__reflect(e.prototype,"yaoqianshu.YaoQianShuPanel")}(yaoqianshu||(yaoqianshu={}));var yaoqianshu;!function(t){var e=function(){function t(){}return t.GLODELE_DATA="glodele_data",t.GLODELE_GETREWARD="glodele_getReward",t}();t.CmdConstant=e,__reflect(e.prototype,"yaoqianshu.CmdConstant")}(yaoqianshu||(yaoqianshu={}));var YaoQianShuReciveMgr=function(){function t(){}return t}();__reflect(YaoQianShuReciveMgr.prototype,"YaoQianShuReciveMgr");var Cmd;!function(t){function e(t){uniLib.Global.dispatchEvent(yaoqianshu.CmdConstant.GLODELE_DATA,t,!0)}function i(t){0==t.resultCode?uniLib.Global.dispatchEvent(yaoqianshu.CmdConstant.GLODELE_GETREWARD,t,!0):uniLib.TipsUtils.showTipsDownToUp(t.desc)}t.OnGetMoneyTreeDataLobby_S=e,t.OnGetMoneyTreeGoldLobby_S=i}(Cmd||(Cmd={}));