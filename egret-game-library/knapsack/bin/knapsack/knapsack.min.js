var __reflect=this&&this.__reflect||function(a,t,n){a.__class__=t,n?n.push(t):n=[t],a.__types__=a.__types__?n.concat(a.__types__):n},__extends=this&&this.__extends||function(a,t){function n(){this.constructor=a}for(var e in t)t.hasOwnProperty(e)&&(a[e]=t[e]);n.prototype=t.prototype,a.prototype=new n},knapsack;!function(a){var t=function(t){function n(){var a=t.call(this)||this;return a.skinName="ExchangeGoldSkin",a}return __extends(n,t),n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},n.prototype.addEvent=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),uniLib.Global.addEventListener(a.KnapsackConst.BackpackExchangeReturnBackpack,this.updateData,this)},n.prototype.removeEvent=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),uniLib.Global.removeEventListener(a.KnapsackConst.BackpackExchangeReturnBackpack,this.updateData,this)},n.prototype.initUI=function(){this._couponImg.source="mjl_knapsack_json.mjl_knapsack_"+a.KnapsackData.getInstance().knapaskGoodId,this._num=1,this.updateNum(),this._couponText.text=a.Data.goods[a.KnapsackData.getInstance().knapaskGoodId].goodName},n.prototype.updateData=function(n){var e=n.param,s=new Cmd.RewardItem;s.goodId=32,s.goodNbr=100*this._num,LobbyModuleMgr.getInstance().showAwardPanel2(s);e.backpackInfo;a.KnapsackData.getInstance().knapaskGoodnumber=e.backpackInfo.number,0==Math.trunc(a.KnapsackData.getInstance().knapaskGoodnumber)&&t.prototype.removePop.call(this),a.KnapsackData.getInstance().knapaskGoodnumber=e.backpackInfo.number,this._num=1,this.updateNum()},n.prototype.updateNum=function(){this._numText.text=this._num+"",this._goldText.text=100*this._num+""},n.prototype.onClick=function(n){switch(n.target){case this._closeBtn:t.prototype.removePop.call(this);break;case this._exchangeBtn:a.KnapsackSendMgr.ExchangeRequest(this._num,a.KnapsackData.getInstance().knapaskGoodId);break;case this._reduceBtn:this._num>1&&(this._num--,this.updateNum());break;case this._addBtn:this._num<Math.trunc(a.KnapsackData.getInstance().knapaskGoodnumber)&&(this._num++,this.updateNum())}},n.prototype.destroy=function(){t.prototype.destroy.call(this)},n}(commonpanel.LobbyBaseEuiPanel);a.ExchangeGoldPanel=t,__reflect(t.prototype,"knapsack.ExchangeGoldPanel")}(knapsack||(knapsack={}));var knapsack;!function(a){var t=function(t){function n(){var a=t.call(this)||this;return a.skinName="KnapsackItemSkin",a}return __extends(n,t),n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},n.prototype.dataChanged=function(){this._info=this.data,this._numText.text="x"+this._info.number,this._couponImg.source="mjl_knapsack_json.mjl_knapsack_"+this._info.goodId,this._gameText.text=a.Data.goods[this._info.goodId].goodName,a.KnapsackData.getInstance().knapaskGoodId==this._info.goodId?this._selectImg.visible=!0:this._selectImg.visible=!1},n}(eui.ItemRenderer);a.KnapsakItemPanel=t,__reflect(t.prototype,"knapsack.KnapsakItemPanel")}(knapsack||(knapsack={}));var knapsack;!function(a){var t=function(t){function n(){var a=t.call(this)||this;return a.skinName="KnapsackSkin",a}return __extends(n,t),n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},n.prototype.initUI=function(){var t=RES.getRes("TableGoodsConfig_json");t.forEach(function(t){a.Data.goods[t.goodId]=t}),this._couponList.itemRenderer=a.KnapsakItemPanel,a.KnapsackData.getInstance().knapaskGoodId=0},n.prototype.addEvent=function(){uniLib.Global.addEventListener(a.KnapsackConst.BackpackInfoReturnBackpack,this.showData,this),uniLib.Global.addEventListener(a.KnapsackConst.BackpackExchangeReturnBackpack,this.updateData,this),this._couponList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemTap,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},n.prototype.removeEvent=function(){uniLib.Global.removeEventListener(a.KnapsackConst.BackpackInfoReturnBackpack,this.showData,this),uniLib.Global.removeEventListener(a.KnapsackConst.BackpackExchangeReturnBackpack,this.updateData,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this._couponList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemTap,this)},n.prototype.showData=function(a){var t=a.param;this._backpackList=t.backpackList,this.updateList(),this._detailGroup.visible=!1,Array.isArray(this._backpackList)&&(this._couponTips.visible=!1)},n.prototype.updateData=function(t){var n=this;this._newbackpackList=[];var e=t.param,s=e.backpackInfo;this._backpackList.forEach(function(a){a.goodId==s.goodId&&(a.number=s.number),0!=a.number&&n._newbackpackList.push(a)}),this._backpackList=this._newbackpackList,0==e.backpackInfo.number&&(a.KnapsackData.getInstance().knapaskGoodId=0),this.showdetailGroup(),this.updateList(),0!=this._backpackList.length?this._couponTips.visible=!1:this._couponTips.visible=!0},n.prototype.onClick=function(n){switch(n.target){case this._closeBtn:t.prototype.removePop.call(this);break;case this._exchangeBtn:a.KnapsackModuleMgr.getInstance().showExchangeGoldPanel()}},n.prototype.itemTap=function(t){if(this._couponList.selectedItem){var n=this._couponList.selectedItem;a.KnapsackData.getInstance().knapaskGoodId==n.goodId?a.KnapsackData.getInstance().knapaskGoodId=0:(a.KnapsackData.getInstance().knapaskGoodId=n.goodId,a.KnapsackData.getInstance().knapaskGoodnumber=n.number)}this.updateList(),this.showdetailGroup()},n.prototype.updateList=function(){this._couponListArray?(Array.isArray(this._couponListArray.source)&&this._couponListArray.removeAll(),this._couponListArray.replaceAll(this._backpackList)):(this._couponListArray=new eui.ArrayCollection(this._backpackList),this._couponList.dataProvider=this._couponListArray)},n.prototype.showdetailGroup=function(){0!=a.KnapsackData.getInstance().knapaskGoodId?(this._detailGroup.visible=!0,this._couponText.text=a.Data.goods[a.KnapsackData.getInstance().knapaskGoodId].goodName,this._explainText.text=a.Data.goods[a.KnapsackData.getInstance().knapaskGoodId].goodIntroduction,this._explainText.text=this._explainText.text.replace(/\\n/g,"\n"),this._couponImg.source="mjl_knapsack_json.mjl_knapsack_"+a.KnapsackData.getInstance().knapaskGoodId,this._detailTips.visible=!1,a.KnapsackData.getInstance().knapaskGoodnumber<1?this._exchangeBtn.visible=!1:this._exchangeBtn.visible=!0):(this._detailGroup.visible=!1,this._detailTips.visible=!0)},n.prototype.destroy=function(){t.prototype.destroy.call(this)},n}(commonpanel.LobbyBaseEuiPanel);a.KnapsakPanel=t,__reflect(t.prototype,"knapsack.KnapsakPanel")}(knapsack||(knapsack={}));var knapsack;!function(a){var t=function(){function a(){}return a.RES_JSON="resource/knapsack/knapsack.res_13712f73.json",a.THM_JSON="resource/knapsack/gameEui_e1968589.json",a.PUB_KNAPSACK="pub_knapsack",a.SUCCESS=0,a.BackpackInfoReturnBackpack="BackpackInfoReturnBackpack",a.OpenRedPackLobby="OpenRedPackLobby",a.BackpackExchangeReturnBackpack="BackpackExchangeReturnBackpack",a}();a.KnapsackConst=t,__reflect(t.prototype,"knapsack.KnapsackConst");var n=function(){function a(){}return a.goods={},a}();a.Data=n,__reflect(n.prototype,"knapsack.Data")}(knapsack||(knapsack={}));var knapsack;!function(a){var t=function(){function a(){this.PartnerMatchId=0,this.knapaskGoodId=0,this.knapaskGoodnumber=0}return a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a}();a.KnapsackData=t,__reflect(t.prototype,"knapsack.KnapsackData")}(knapsack||(knapsack={}));var Cmd;!function(a){function t(a,t,n){void 0===n&&(n=!0),uniLib.Global.dispatchEvent(a,t,n)}function n(a){a.resultCode||(a.resultCode=knapsack.KnapsackConst.SUCCESS),a.resultCode==knapsack.KnapsackConst.SUCCESS&&t(knapsack.KnapsackConst.BackpackExchangeReturnBackpack,a)}function e(a){a.resultCode||(a.resultCode=knapsack.KnapsackConst.SUCCESS),a.resultCode==knapsack.KnapsackConst.SUCCESS&&t(knapsack.KnapsackConst.BackpackInfoReturnBackpack,a)}a.KnapsackDispatch=t,a.OnBackpackExchangeReturnBackpackCmd_S=n,a.OnBackpackInfoReturnBackpackCmd_S=e}(Cmd||(Cmd={}));var knapsack;!function(a){var t=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.showKnapsakPanel=function(t){LoadPanelTipMgr.getInstance().loadRes(a.KnapsackConst.PUB_KNAPSACK,function(){uniLib.PopUpMgr.addPopUp(a.KnapsakPanel,null,!0,!0,0,uniLib.PopUpEffect.CENTER),t()})},t.prototype.showExchangeGoldPanel=function(){LoadPanelTipMgr.getInstance().loadRes(a.KnapsackConst.PUB_KNAPSACK,function(){uniLib.PopUpMgr.addPopUp(a.ExchangeGoldPanel,null,!0,!0,0,uniLib.PopUpEffect.CENTER)})},t}();a.KnapsackModuleMgr=t,__reflect(t.prototype,"knapsack.KnapsackModuleMgr")}(knapsack||(knapsack={}));var knapsack;!function(a){var t=function(){function a(){}return a.ExchangeRequest=function(a,t){var n=new Cmd.BackpackExchangeRequestBackpackCmd_C,e=new Cmd.BackpackInfo;e.goodId=t,e.number=a,n.backpackInfo=e,NetMgr.tcpSend(n)},a}();a.KnapsackSendMgr=t,__reflect(t.prototype,"knapsack.KnapsackSendMgr")}(knapsack||(knapsack={}));