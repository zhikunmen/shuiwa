var __reflect=this&&this.__reflect||function(t,e,s){t.__class__=e,s?s.push(e):s=[e],t.__types__=t.__types__?s.concat(t.__types__):s},__extends=this&&this.__extends||function(t,e){function s(){this.constructor=t}for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);s.prototype=e.prototype,t.prototype=new s},task;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="GameTaskItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data,s=ConfigMgr.getInstance().getGameTaskCfgById(e.taskId);return null==s?void this.clear():(this.desc_text.text=s.taskDesc,this.progress_text.text=e.current+"/"+s.taskCondition,e.taskStatus>=Cmd.TaskStatus.Task_Status_Complete&&(this.progress_text.text="已完成"),this.progress_text.anchorOffsetX=this.progress_text.width>>1,void(s.taskReward&&(6==s.taskReward[0].goodId?(this.reward_text.text=" x"+s.taskReward[0].goodNbr,this.reward_icon.source="game_task_json.renwu_zuanshi"):32==s.taskReward[0].goodId&&(this.reward_text.text=s.taskReward[0].goodNbr+"",this.reward_icon.source="game_task_json.renwu_jinbi"))))},e.prototype.clear=function(){this.desc_text.text="",this.progress_text.text="",this.reward_text.text="",this.reward_icon.source=null},e.prototype.destroy=function(){},e}(eui.ItemRenderer);t.GameTaskItem=e,__reflect(e.prototype,"task.GameTaskItem")}(task||(task={}));var task;!function(t){var e=function(e){function s(t,s){var a=e.call(this)||this;return a._gameId=t,a._sceneId=s,a.skinName="GameTaskSkin",a}return __extends(s,e),s.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.visible=!1,this.addEvents(),this.x=-1,this.task_list.itemRenderer=task.GameTaskItem,this.initData()},s.prototype.initData=function(){var t=new Cmd.GetGameTaskListLobbyCmd_C;t.lobbyId=NetMgr.getLoginCfg().lobbyId,t.gameId=this._gameId,t.sceneId=this._sceneId,NetMgr.tcpSend(t)},s.prototype.addEvents=function(){uniLib.Global.addEventListener(t.CmdConstant.GAME_TASK_LIST_DATA,this.listUpdata,this),uniLib.Global.addEventListener(t.CmdConstant.UPDATE_GAME_TASK_DATA,this.itemUpdata,this),uniLib.Global.addEventListener(t.CmdConstant.NEXT_GAME_TASK_DATA,this.itemNext,this)},s.prototype.removeEvents=function(){uniLib.Global.removeEventListener(t.CmdConstant.GAME_TASK_LIST_DATA,this.listUpdata,this),uniLib.Global.removeEventListener(t.CmdConstant.UPDATE_GAME_TASK_DATA,this.itemUpdata,this),uniLib.Global.removeEventListener(t.CmdConstant.NEXT_GAME_TASK_DATA,this.itemNext,this)},s.prototype.listUpdata=function(t){var e=t.param,s=e.gameTaskInfo;s&&s.length>0&&(s.length>3&&(s=s.slice(0,2)),this._currentTasks=new eui.ArrayCollection(s),this.task_list.dataProvider=this._currentTasks,this.visible=!0)},s.prototype.itemUpdata=function(t){if(null==this._currentTasks)return void this.initData();for(var e=t.param,s=0;s<this._currentTasks.source.length;s++)if(this._currentTasks.source[s].taskId==e.taskId){this._currentTasks.source[s].current=e.pre,this._currentTasks.source[s].taskStatus=e.receive>0?Cmd.TaskStatus.Task_Status_Received:Cmd.TaskStatus.Task_Status_Progress,this._currentTasks.replaceItemAt(this._currentTasks.source[s],s);break}},s.prototype.itemNext=function(t){if(null==this._currentTasks)return void this.initData();var e=t.param;if(null==this._anim){var s="rwdb";this._anim=uniLib.DragonUtils.createDragonBonesDisplay(s+"_ske_json",s+"_tex_json",s+"_tex_png",uniLib.DragonType.ARMATURE),this._anim.display.x=133,this._anim.display.y=68}if(this.addChild(this._anim.display),uniLib.DragonUtils.runDragonBonesArmature(this._anim,"newAnimation",1),e.followTasks&&e.followTasks.length>0)for(var a=0;a<this._currentTasks.source.length;a++)if(this._currentTasks.source[a].taskId==e.taskId){this._currentTasks.replaceItemAt(e.followTasks[0],a);break}},s.prototype.playAnim=function(t,e){var s=this,a=ConfigMgr.getInstance().getGameTaskCfgById(t),n=0;if(a.taskReward){n=a.taskReward[0].goodNbr;var i=[46,91,136];null==this._bombNum&&(this._bombNum=new egret.BitmapText,this._bombNum.font=RES.getRes("pdk_bomb1_fnt"),this.addChild(this._bombNum),this._bombNum.x=200),this._bombNum.text="+"+n,this._bombNum.y=i[e],this._bombNum.visible=!0,egret.Tween.removeTweens(this._bombNum),egret.Tween.get(this._bombNum).to({y:i[e]-40},120).call(function(){s._bombNum.visible=!1},this)}},s.prototype.destroy=function(){this._bombNum&&egret.Tween.removeTweens(this._bombNum),this._anim&&uniLib.DragonUtils.destoryDragonBonesArmature(this._anim,"newAnimation"),this.removeEvents(),uniLib.DisplayUtils.removeFromParent(this)},s}(eui.Component);t.GameTaskPanel=e,__reflect(e.prototype,"task.GameTaskPanel")}(task||(task={}));var task;!function(t){var e=function(){function t(){}return t.RES_JSON="resource/task/task.res_5ecda8af.json",t.THM_JSON="resource/task/gameEui_c07c7b98.json",t.PUB_GAME_TASK="pub_game_task",t}();t.TaskConsts=e,__reflect(e.prototype,"task.TaskConsts")}(task||(task={}));var task;!function(t){var e=function(){function t(){}return t.GAME_TASK_LIST_DATA="game_task_list_data",t.UPDATE_GAME_TASK_DATA="update_game_task_data",t.NEXT_GAME_TASK_DATA="next_game_task_data",t}();t.CmdConstant=e,__reflect(e.prototype,"task.CmdConstant")}(task||(task={}));var TaskReciveMgr=function(){function t(){}return t}();__reflect(TaskReciveMgr.prototype,"TaskReciveMgr");var Cmd;!function(t){function e(t){0==t.resultCode&&uniLib.Global.dispatchEvent(task.CmdConstant.GAME_TASK_LIST_DATA,t,!0)}function s(t){uniLib.Global.dispatchEvent(task.CmdConstant.UPDATE_GAME_TASK_DATA,t,!0)}function a(t){uniLib.Global.dispatchEvent(task.CmdConstant.NEXT_GAME_TASK_DATA,t,!0)}t.OnGetGameTaskListLobbyCmd_S=e,t.OnGetGameTaskScheduleLobbyCmd_S=s,t.OnGetGameTaskRewardLobbyCmd_S=a}(Cmd||(Cmd={}));