var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);i.prototype=t.prototype,e.prototype=new i},share;!function(e){function t(e,t,i,a,n,o,r,s,d){if(void 0===t&&(t=0),void 0===i&&(i=""),void 0===a&&(a=""),void 0===n&&(n=""),void 0===o&&(o=""),void 0===r&&(r=null),void 0===s&&(s=null),void 0===d&&(d=0),uniLib.Global.isNative){var h=new uniLib.WXShareVo;h.shareWay=d;var p=MJLobbyData.getInstance().lobbyConfig;if(LobbyDataCache.bundleInfo&&LobbyDataCache.bundleInfo.wx_wbappid){var c=uniLib.UserInfo.nickName;c.length>5&&(c=c.slice(0,5)),h.webpageUrl="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+LobbyDataCache.bundleInfo.wx_wbappid+"&redirect_uri=http://"+p.newLink+"/addons/zqgame/gameshare.php?appid="+LobbyDataCache.bundleInfo.wx_wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(uniLib.UserInfo.uid+"|"+(t?t:0)+"|"+c+"|"+Cmd.ShareOpType.click+"_"+i)+"&connect_redirect=1#wechat_redirect"}else h.webpageUrl=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+uniLib.UserInfo.uid+"&nickName="+uniLib.UserInfo.nickName;h.title=n?n:p.shareTitle,h.description=o?o:p.shareContent,uniLib.ZQGameSdk.share(h,function(t){if(t&&0==t.code){var i=new Cmd.UploadShareInfoLittleGameLobbyCmd_CS;i.opType=Cmd.ShareOpType.share,i.shareType=e,i.extData=a,NetMgr.tcpSend(i),r&&r.call(s)}else 1==t.code?uniLib.TipsUtils.showTipsDownToUp("分享取消"):2==t.code&&uniLib.TipsUtils.showTipsDownToUp("分享被拒绝")},this)}}var i=function(){function e(){}return e.RES_JSON="resource/share/share.res_e734272b.json",e.THM_JSON="resource/share/gameEui_575370e2.json",e.PUB_SHARE="pub_share",e.SHARE_INVITEDATA="share_invitedata",e.SHARE_INVITEAWARD="share_inviteaward",e}();e.ShareConst=i,__reflect(i.prototype,"share.ShareConst"),e.shareNativeMessage=t}(share||(share={}));var Cmd;!function(e){function t(e){e.resultCode||uniLib.Global.dispatchEvent(share.ShareConst.SHARE_INVITEDATA,e)}function i(e){e.resultCode||(uniLib.Global.dispatchEvent(share.ShareConst.SHARE_INVITEAWARD,e),wxgame.Global.instance.aldSendEvent("周边系统","分享有礼领取钻石成功"))}e.OnGetInviteInfoLittleGameLobbyCmd_S=t,e.OnGetInviteRewardLittleGameLobbyCmd_S=i}(Cmd||(Cmd={}));var share;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.skinName="LobbySharePanelSkin",e}return __extends(i,t),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEvent()},i.prototype.destroy=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),uniLib.Global.removeEventListener(e.ShareConst.SHARE_INVITEAWARD,this.update,this),uniLib.Global.removeEventListener(e.ShareConst.SHARE_INVITEDATA,this.init,this)},i.prototype.addEvent=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),uniLib.Global.addEventListener(e.ShareConst.SHARE_INVITEAWARD,this.update,this),uniLib.Global.addEventListener(e.ShareConst.SHARE_INVITEDATA,this.init,this);var t=new Cmd.GetInviteInfoLittleGameLobbyCmd_C;NetMgr.tcpSend(t)},i.prototype.init=function(e){var t=e.param;this._rewardStatus=t.rewardStatus,this.updateHead(t.info)},i.prototype.update=function(e){var t=e.param;this._rewardStatus=t.rewardStatus,this.updateHead(t.info);var i=[];t.goods.forEach(function(e,t){var a=new commonConfirm.ReWardDataVo;a.getDataByGoodId(e.goodsId,e.goodsNum),i.push(a)});var a=new commonConfirm.RewardPanel;a.initData(i),uniLib.PopUpMgr.addPopUp(a,null,!0,!1)},i.prototype.updateHead=function(e){var t=this,i=0;e.forEach(function(e,a){var n;n=ConfigMgr.getInstance().getGoodCfgById(e.goods.goodsId),3==e.status?(t["_lab"+a].text="已领",t["_lab"+a].textColor=8947848,i++):n?t["_lab"+a].text=e.goods.goodsNum+n.goodName:t["_lab"+a].text=e.goods.goodsNum+"钻",1!=e.status&&(t["_icon"+a].source=e.headUrl)}),i==e.length&&(this._bigReawrd.text="已领",this._bigReawrd.textColor=8947848)},i.prototype.btnClick=function(e){switch(e.target){case this._icon0:case this._icon1:case this._icon2:case this._icon3:case this._icon4:this.clickShare(e.target);break;case this._getBtn:this.getAward();break;case this._closeBtn:uniLib.PopUpMgr.removePopUp(this)}},i.prototype.clickShare=function(t){if("lobby_share_json.lobby_shareadd"==t.source)if(uniLib.Global.isWxGame()){var i=new uniLib.WXShareVo;i.shareType=Cmd.ShareType.invite,uniLib.ZQGameSdk.share(i),wxgame.Global.instance.aldSendEvent("周边系统","分享有礼跳转分享")}else e.shareNativeMessage(Cmd.ShareType.invite,0,Cmd.ShareType.invite.toString())},i.prototype.getAward=function(){if(1==this._rewardStatus){var t=new commonConfirm.ConfirmPanel("当前没有可以领取的奖励哦!邀请更多好友后再来领奖吧!","",["lobby_share_json.lobby_shareInvite"],function(){if(uniLib.Global.isWxGame()){var t=new uniLib.WXShareVo;t.shareType=Cmd.ShareType.invite,wxgame.ShareMessage.instance.shareAppMessage(t),wxgame.Global.instance.aldSendEvent("周边系统","分享有礼跳转分享")}else e.shareNativeMessage(Cmd.ShareType.invite,0,Cmd.ShareType.invite.toString())});uniLib.PopUpMgr.addPopUp(t,null,!0,!0,0,uniLib.PopUpEffect.CENTER)}else if(2==this._rewardStatus){var i=new Cmd.GetInviteRewardLittleGameLobbyCmd_C;NetMgr.tcpSend(i)}else 3==this._rewardStatus&&uniLib.TipsUtils.showConfirm("今日奖励已领取完","","确定")},i}(eui.Component);e.sharePanel=t,__reflect(t.prototype,"share.sharePanel")}(share||(share={}));