var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},redpackets;!function(e){function t(e,t,i,n,a,s,o,r,d){if(void 0===t&&(t=0),void 0===i&&(i=""),void 0===n&&(n=""),void 0===a&&(a=""),void 0===s&&(s=""),void 0===o&&(o=null),void 0===r&&(r=null),void 0===d&&(d=0),uniLib.Global.isNative){var c=new uniLib.WXShareVo;c.shareWay=d;var p=MJLobbyData.getInstance().lobbyConfig;if(LobbyDataCache.bundleInfo&&LobbyDataCache.bundleInfo.wx_wbappid){var l=uniLib.UserInfo.nickName;l.length>5&&(l=l.slice(0,5)),c.webpageUrl="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+LobbyDataCache.bundleInfo.wx_wbappid+"&redirect_uri=http://"+p.newLink+"/addons/zqgame/gameshare.php?appid="+LobbyDataCache.bundleInfo.wx_wbappid+"&response_type=code&scope=snsapi_base&state="+uniLib.CompressUtil.base64encode(uniLib.UserInfo.uid+"|"+(t?t:0)+"|"+l+"|"+Cmd.ShareOpType.click+"_"+i)+"&connect_redirect=1#wechat_redirect"}else c.webpageUrl=uniLib.ZQGameSdk.defaultWXShareVo.webpageUrl+"?uid="+uniLib.UserInfo.uid+"&nickName="+uniLib.UserInfo.nickName;c.title=a?a:p.shareTitle,c.description=s?s:p.shareContent,uniLib.ZQGameSdk.share(c,function(t){if(t&&0==t.code){var i=new Cmd.UploadShareInfoLittleGameLobbyCmd_CS;i.opType=Cmd.ShareOpType.share,i.shareType=e,i.extData=n,NetMgr.tcpSend(i),o&&o.call(r)}else 1==t.code?uniLib.TipsUtils.showTipsDownToUp("分享取消"):2==t.code&&uniLib.TipsUtils.showTipsDownToUp("分享被拒绝")},this)}}var i=function(){function e(){}return e.RES_JSON="resource/redpackets/redpackets.res_6ec24f0a.json",e.THM_JSON="resource/redpackets/gameEui_aaedc30d.json",e.PUB_REDPACKETS="pub_redpackets",e.SHARE_INVITEDATA="share_invitedata",e.SHARE_INVITEAWARD="share_inviteaward",e.NOTCAN_GETINVITE="notcanGetInvite",e}();e.RedPacketsConst=i,__reflect(i.prototype,"redpackets.RedPacketsConst"),e.shareNativeMessage=t}(redpackets||(redpackets={}));var Cmd;!function(e){function t(e){e.resultCode||uniLib.Global.dispatchEvent(redpackets.RedPacketsConst.SHARE_INVITEDATA,e)}function i(e){e.resultCode||(uniLib.Global.dispatchEvent(redpackets.RedPacketsConst.SHARE_INVITEAWARD,e),wxgame.Global.instance.aldSendEvent("周边系统","分享有礼领取钻石成功"))}e.OnGetInviteInfoLittleGameLobbyCmd_S=t,e.OnGetInviteRewardLittleGameLobbyCmd_S=i}(Cmd||(Cmd={}));var redpackets;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.skinName="redpacketsSkin",e}return __extends(i,t),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEvent()},i.prototype.destroy=function(){this._inviteInfo=null,this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),uniLib.Global.removeEventListener(e.RedPacketsConst.SHARE_INVITEAWARD,this.update,this),uniLib.Global.removeEventListener(e.RedPacketsConst.SHARE_INVITEDATA,this.init,this)},i.prototype.addEvent=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),uniLib.Global.addEventListener(e.RedPacketsConst.SHARE_INVITEAWARD,this.update,this),uniLib.Global.addEventListener(e.RedPacketsConst.SHARE_INVITEDATA,this.init,this);var t=new Cmd.GetInviteInfoLittleGameLobbyCmd_C;NetMgr.tcpSend(t)},i.prototype.init=function(e){this.tips_lbl.textFlow=[{text:"邀请",style:{textColor:15322543}},{text:"新用户玩5局游戏",style:{textColor:14614272}},{text:"领",style:{textColor:15322543}},{text:"1.66元",style:{textColor:14614272}},{text:"及以上随机现金，自动提现！",style:{textColor:15322543}}];var t=e.param;this._inviteInfo=t,this.updateHead()},i.prototype.update=function(t){var i=this;this._isHaveAward=!1;var n=t.param,a=new lobbyaward.LobbyGetAwardPanel;a.setData(n.goods[0].goodsNum,3),uniLib.PopUpMgr.addPopUp(a,null,!0,!0);var s=this._inviteInfo;s.info.forEach(function(e,t){e.id==n.id&&(i._inviteInfo.info[t].status=4),3==i._inviteInfo.info[t].status&&(i._isHaveAward=!0)}),0==this._isHaveAward&&uniLib.Global.dispatchEvent(e.RedPacketsConst.NOTCAN_GETINVITE),this.updateHead(),uniLib.TipsUtils.showTipsDownToUp("如有问题请联系客服")},i.prototype.updateHead=function(){var e=this,t=this._inviteInfo.info;t.forEach(function(t,i){var n;n=ConfigMgr.getInstance().getGoodCfgById(t.goods.goodsId);var a=e["btn_"+i];a&&(32==t.goods.goodsId?a.skin.awardTxt.text=t.goods.goodsNum+"金币":296==t.goods.goodsId?a.skin.awardTxt.text="最高"+t.goods.goodsNum+"元":6==t.goods.goodsId&&(a.skin.awardTxt.text=t.goods.goodsNum+"钻石"),e.setPlayerIconMask(a.skin.head),1==t.status?a.touchEnabled=!0:2==t.status?(a.touchEnabled=!0,a.skin.numTxt.text=t.curGameNbr+"/"+t.allGameNbr+"局",a.skin.head.source=t.headUrl):3==t.status?(a.touchEnabled=!0,a.skin.numTxt.text=t.curGameNbr+"/"+t.allGameNbr+"局",a.skin.awardTxt.text="领取现金",a.skin.head.source=t.headUrl):4==t.status&&(a.touchEnabled=!1,a.skin.numTxt.text=t.curGameNbr+"/"+t.allGameNbr+"局",a.skin.head.source=t.headUrl,a.skin.awardTxt.text="",a.skin.type.source="mjl_redpackets_istrue",a.skin.type0.source="mjl_redpackets_istrue",a.skin.get.visible=!0))})},i.prototype.setPlayerIconMask=function(e){var t=RES.getRes("lb_lobby_headBg_png"),i=new egret.Bitmap;e.parent.addChild(i),i.texture=t,i.width=114,i.height=114,i.x=(e.width-i.width)/2+e.x,i.y=(e.height-i.height)/2+e.y,e.mask=i},i.prototype.btnClick=function(e){switch(e.target){case this.btn_0:case this.btn_1:case this.btn_2:var t=parseInt(e.target.name);if(this._inviteInfo&&this._inviteInfo.info[t]){var i=this._inviteInfo.info[t];if(1==i.status)this.clickShare();else if(2==i.status)uniLib.TipsUtils.showTipsDownToUp("该玩家在任意游戏中完成5局即可领取！");else if(3==i.status){var n=new Cmd.GetInviteRewardLittleGameLobbyCmd_C;n.id=this._inviteInfo.info[t].id,NetMgr.tcpSend(n)}}}},i.prototype.clickShare=function(){if(uniLib.Global.isWxGame()){var t=new uniLib.WXShareVo;t.shareType=Cmd.ShareType.invite,uniLib.ZQGameSdk.share(t)}else e.shareNativeMessage(Cmd.ShareType.invite,0,Cmd.ShareType.invite.toString())},i}(eui.Component);e.RedPacketsPanel=t,__reflect(t.prototype,"redpackets.RedPacketsPanel")}(redpackets||(redpackets={}));