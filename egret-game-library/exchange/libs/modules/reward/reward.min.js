var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},reward;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.index=1,t.skinName="DiamondsReceiveSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this._shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this._shareBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.scroll.addEventListener(egret.Event.CHANGE,this.scrollChange,this),this.diamond_lst.itemRenderer=t.ReceiveDiamondsItem,uniLib.Global.addEventListener(t.CmdConstant.IOSINVITEINFOLITTLE,this.onIosInviteInfoLittle,this),uniLib.Global.addEventListener(t.CmdConstant.IOSINVITEREWARDLITTLE,this.onIosInviteRewardLittle,this),this.loadRankData()},i.prototype.scrollChange=function(t){this.index<4&&this.scroll.viewport.scrollV+this.scroll.height>this.scroll.viewport.contentHeight+100&&(this.scroll.viewport.scrollV=this.scroll.viewport.contentHeight-this.scroll.height,this.index++,this.loadRankData())},i.prototype.loadRankData=function(){var t=new Cmd.GetIosInviteInfoLittleGameLobbyCmd_C;t.lobbyId=NetMgr.getLoginCfg().lobbyId,t.index=this.index,NetMgr.tcpSend(t)},i.prototype.onIosInviteInfoLittle=function(t){this.empty_group.visible=!1;var e=t.param;return null!=e.info&&e.info&&e.info instanceof Array?(1==e.index?this.info=e.info:this.info=this.info.concat(e.info),void(this.diamond_lst.dataProvider=new eui.ArrayCollection(this.info))):void(null==this.info&&(this.empty_group.visible=!0))},i.prototype.onIosInviteRewardLittle=function(t){for(var e=t.param,i=0;i<this.info.length;i++)this.info[i].uid==e.single.uid&&(this.info[i]=e.single);this.diamond_lst.dataProvider=new eui.ArrayCollection(this.info)},i.prototype.onTouchHandler=function(t){switch(t.currentTarget){case this._closeBtn:uniLib.PopUpMgr.removePopUp(this);break;case this._shareBtn:case this._shareBtn2:if(uniLib.Global.isWxGame()){var e=new uniLib.WXShareVo;e.shareType=Cmd.ShareType.ios,uniLib.ZQGameSdk.share(e),wxgame.Global.instance.aldSendEvent("周边系统","领钻石跳转分享")}else share.shareNativeMessage(Cmd.ShareType.ios,0,Cmd.ShareType.ios.toString())}},i.prototype.destroy=function(){uniLib.Global.removeEventListener(t.CmdConstant.IOSINVITEINFOLITTLE,this.onIosInviteInfoLittle,this),uniLib.Global.removeEventListener(t.CmdConstant.IOSINVITEREWARDLITTLE,this.onIosInviteRewardLittle,this),this._closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this._shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this._shareBtn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.removeChildren()},i}(eui.Component);t.DiamondsReceivePanel=e,__reflect(e.prototype,"reward.DiamondsReceivePanel")}(reward||(reward={}));var reward;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return 60==NetMgr.getLoginCfg().lobbyId?t.skinName="TaskView1Skin":t.skinName="TaskViewSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initData()},i.prototype.initData=function(){this.task_lst.itemRenderer=t.TaskItem,uniLib.Global.addEventListener(t.CmdConstant.INTOFREEGOLD,this.onDailyTask,this),uniLib.Global.addEventListener(t.CmdConstant.DAYSTASKREWARD,this.taskNext,this);var e=new Cmd.IntoFreeGoldLobbyCmd_C;NetMgr.tcpSend(e)},i.prototype.onDailyTask=function(t){var e=t.param;e.otherTaskInfo&&e.otherTaskInfo.length>0&&(this._taskInfo=new eui.ArrayCollection(e.otherTaskInfo),this.task_lst.dataProvider=this._taskInfo)},i.prototype.taskNext=function(t){var e=t.param,i=e.followTasks;if(i&&i.length>0){for(var n=0;n<this._taskInfo.source.length;n++)if(e.taskId==this._taskInfo.source[n].taskId){this._taskInfo.replaceItemAt(i[0],n);break}}else for(var s=0;s<this._taskInfo.source.length;s++)if(e.taskId==this._taskInfo.source[s].taskId){this._taskInfo.source[s].taskStatus=Cmd.TaskStatus.Task_Status_Received,this._taskInfo.replaceItemAt(this._taskInfo.source[s],s);break}},i.prototype.destroy=function(){for(var e=0;e<this.task_lst.numChildren;e++){var i=this.task_lst.getChildAt(e);i&&i.destroy()}this.task_lst=null,uniLib.Global.removeEventListener(t.CmdConstant.INTOFREEGOLD,this.onDailyTask,this),uniLib.Global.removeEventListener(t.CmdConstant.DAYSTASKREWARD,this.taskNext,this),this.removeChildren()},i}(eui.Component);t.TaskView=e,__reflect(e.prototype,"reward.TaskView")}(reward||(reward={}));var reward;!function(t){var e=function(e){function i(t,i){void 0===t&&(t=0),void 0===i&&(i=null);var n=e.call(this)||this;return n._defaultMenu=t,n._introduce=i,n.skinName="FuliPanelSkin",n}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.introduce_grp.visible=!1,this.sign_view.visible=!1,this.task_view.visible=!1,this.close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.sign_rbtn.group.addEventListener(egret.Event.CHANGE,this.showTabContent,this),this.sign_rbtn.group.selectedValue=this._defaultMenu,this._introduce&&(this.content.text=this._introduce[0],this.operate.y=this.content.y+this.content.textHeight+28,this.operate.text=this._introduce[1]),this._viewGroup=[this.sign_view,this.task_view,this.introduce_grp],this._viewGroup[this._defaultMenu].visible=!0,this._btnGroup=[this.sign_rbtn,this.task_rbtn,this.introduce_rbtn],this._btnGroup[this._defaultMenu].selected=!0,this.addRedPoint(),uniLib.Global.addEventListener(t.CmdConstant.NOVICEINFO,this.onNoviceInfo,this)},i.prototype.addRedPoint=function(){LobbyRedPointMgr.instance.registerRedPoint(Cmd.MsgType.Act_DaySign,[[this.red1]]),LobbyRedPointMgr.instance.registerRedPoint(Cmd.MsgType.Task_EveryDay,[[this.red2]])},i.prototype.removeRedPoint=function(){LobbyRedPointMgr.instance.unregisterRedPoint(Cmd.MsgType.Act_DaySign),LobbyRedPointMgr.instance.unregisterRedPoint(Cmd.MsgType.Task_EveryDay)},i.prototype.showTabContent=function(t){this._viewGroup[this._defaultMenu].visible=!1;var e=t.target;this._defaultMenu=parseInt(e.selectedValue),this._viewGroup[this._defaultMenu].visible=!0},i.prototype.onTouchHandler=function(t){uniLib.PopUpMgr.removePopUp(this)},i.prototype.onNoviceInfo=function(t){this.sign_view.onNoviceInfo(t.param);for(var e=!1,i=0;i<t.param.length;i++)3==t.param[i].status&&(e=!0);e||(this._viewGroup[this._defaultMenu].visible=!1,this._defaultMenu=1,this._viewGroup[this._defaultMenu].visible=!0,this._btnGroup[this._defaultMenu].selected=!0)},i.prototype.destroy=function(){this._introduce=null,uniLib.Global.removeEventListener(t.CmdConstant.NOVICEINFO,this.onNoviceInfo,this),this._viewGroup=null,this._btnGroup=null,this.removeRedPoint(),this.close_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.sign_rbtn.group.removeEventListener(egret.Event.CHANGE,this.showTabContent,this),this.sign_view.destroy(),this.task_view.destroy(),this.removeChildren()},i}(eui.Component);t.FuLiPanel=e,__reflect(e.prototype,"reward.FuLiPanel")}(reward||(reward={}));var reward;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="ReceiveItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.user_head.source=e.headUrl,this.user_name.text=e.nickName,2==e.status?(this._receiveBtn.visible=!0,this._receiveed.visible=!1,this._receiveBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this)):3==e.status&&(this._receiveBtn.visible=!1,this._receiveed.visible=!0)},e.prototype.onTouchHandler=function(t){var e=new Cmd.GetIosInviteRewardLittleGameLobbyCmd_C;e.lobbyId=NetMgr.getLoginCfg().lobbyId,e.uid=this.data.uid,NetMgr.tcpSend(e)},e}(eui.ItemRenderer);t.ReceiveDiamondsItem=e,__reflect(e.prototype,"reward.ReceiveDiamondsItem")}(reward||(reward={}));var reward;!function(t){var e=function(){function t(){}return t.RES_JSON="resource/reward/reward.res_ef5d825f.json",t.THM_JSON="resource/reward/gameEui_5c085bcc.json",t.PUB_REWARD="pub_reward",t.PUB_FULI="pub_fuli",t.PUB_BUYU_FULI="pub_buyu_fuli",t.ACTIVE_BOX="active_box",t}();t.RewardConsts=e,__reflect(e.prototype,"reward.RewardConsts")}(reward||(reward={}));var reward;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="SignItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data,i=ConfigMgr.getInstance().getGoodCfgById(e.goodId);this.sign_day.text="第"+e.day+"天",this.sign_icon.source="lb_fuli_json."+i.goodIcon,this.sign_good_name.text=i.goodName+"x"+e.goodNbr,7==e.day&&(this.sign_bg.width=386,336==e.goodId&&(this.sign_good_name.text="最高可得"+e.goodNbr+"福卡"));var n=7==e.day?1:2;1==e.status?(this.sign_bg.source="sign_missbg"+n,this.sign_corn.source="sign_misstitle",this.sign_good_name.textColor=10773337,this.sign_mask.visible=!0,this.sign_icon.source="sign_miss"):2==e.status?(this.sign_bg.source="sign_missbg"+n,this.sign_corn.source="sign_misstitle",this.sign_good_name.textColor=10773337,this.sign_mask.visible=!0,this.sign_icon.source="sign_receive"):3==e.status?(this.sign_bg.source="sign_getbg"+n,this.sign_corn.source="sign_gettitle",this.sign_good_name.textColor=16777215,this.sign_mask.visible=!1):4==e.status&&(this.sign_bg.source="sign_missbg"+n,this.sign_corn.source="sign_misstitle",this.sign_good_name.textColor=10773337,this.sign_mask.visible=!1)},e.prototype.setReceived=function(t){var e=7==t?1:2;this.sign_bg.source="sign_missbg"+e,this.sign_corn.source="sign_misstitle",this.sign_good_name.textColor=10773337,this.sign_mask.visible=!0,this.sign_icon.source="sign_receive"},e}(eui.ItemRenderer);t.SignItem=e,__reflect(e.prototype,"reward.SignItem")}(reward||(reward={}));var reward;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.POSX=[0,193,386,579,0,193,386],t.POSY=[40,40,40,40,200,200,200],t.items=[],t.skinName="SignViewSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initData(),uniLib.Global.isNative?this.receive_lbl.visible=!1:(this.receive_lbl.textFlow=(new egret.HtmlTextParser).parse('<font fontfamily="Microsoft YaHei"><u>直接领取</u></font>'),this.receive_lbl.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this)),this.viewVideo_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this)},i.prototype.initData=function(){uniLib.Global.addEventListener(t.CmdConstant.NOVICEREWARD,this.onNoviceReward,this);var e=new Cmd.GetNoviceInfodLobbyCmd_C;e.lobbyId=NetMgr.getLoginCfg().lobbyId,NetMgr.tcpSend(e)},i.prototype.onNoviceInfo=function(e){this.noviceInfo=e;for(var i=!1,n=0;n<this.noviceInfo.length;n++){var s=new t.SignItem;s.data=this.noviceInfo[n],s.x=this.POSX[n],s.y=this.POSY[n],this.addChild(s),this.items.push(s),3==this.noviceInfo[n].status&&(i=!0)}!uniLib.Global.isNative&&(this.receive_lbl.visible=i)},i.prototype.onNoviceReward=function(t){var e=t.param;this.items[e.day-1].setReceived(e.day),this.receive_lbl.visible=!1},i.prototype.onTouchHandler=function(t){if(t.target==this.receive_lbl){var e=new Cmd.GetNoviceRewarddLobbyCmd_C;e.lobbyId=NetMgr.getLoginCfg().lobbyId,e.typ=1,NetMgr.tcpSend(e),wxgame.Global.instance.aldSendEvent("周边系统","登录奖励直接领取")}else if(t.target==this.viewVideo_btn)if(uniLib.Global.isWxGame())if(wxgame.Global.instance.videoAdCanUse)wxgame.Global.instance.createRewardedVideoAd("",this.getRewardDouble,this);else{var i=new uniLib.WXShareVo;i.shareType=Cmd.ShareType.common,wxgame.ShareMessage.instance.shareAppMessage(i,this.getRewardDouble,null,this)}else this.getRewardDouble()},i.prototype.getRewardDouble=function(){var t=new Cmd.GetNoviceRewarddLobbyCmd_C;t.lobbyId=NetMgr.getLoginCfg().lobbyId,t.typ=2,NetMgr.tcpSend(t)},i.prototype.destroy=function(){this.items=null,this.receive_lbl.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),uniLib.Global.removeEventListener(t.CmdConstant.NOVICEREWARD,this.onNoviceReward,this),this.viewVideo_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.removeChildren()},i}(eui.Component);t.SignView=e,__reflect(e.prototype,"reward.SignView")}(reward||(reward={}));var reward;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skipType=0,e.skinName="TaskItemlSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.progress_img.mask=this.progress_mask,this.rev_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.go_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this)},e.prototype.onTouchHandler=function(t){if(t.target==this.rev_btn){this.go_btn.currentState="disabled",this.go_btn.visible=!0,this.go_btn.touchEnabled=!1,this.rev_btn.visible=!1;var e=new Cmd.GetDaysTaskRewardLobbyCmd_C;e.lobbyId=NetMgr.getLoginCfg().lobbyId,e.taskId=this.data.taskId,NetMgr.tcpSend(e),wxgame.Global.instance.aldSendEvent("周边系统","每日任务: "+this.data.taskID+"领取")}else t.target==this.go_btn&&this.skipType>0&&LobbyModuleMgr.getInstance().openPanelBySkipType(this.skipType)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data,i=ConfigMgr.getInstance().getTaskCfgById(e.taskId),n=i.taskDesc;if(this.skipType=i.skipType,n=n.replace(new RegExp("%a","gm"),i.taskCondition+""),this.good_content.text=n,this.good_gress.text=e.current+"/"+i.taskCondition,this.progress_mask.width=360*(e.current/i.taskCondition),i.taskReward){var s=ConfigMgr.getInstance().getGoodCfgById(i.taskReward[0].goodId);this.good_num.text=i.taskReward[0].goodNbr+s.goodName,this.good_icon.source="game_prop_json.bag_daoju_"+i.taskReward[0].goodId,commonConfirm.ResUtil.limitImageSize(this.good_icon,66)}e.taskStatus<=Cmd.TaskStatus.Task_Status_Progress?(this.go_btn.visible=this.skipType>0,this.go_btn.currentState="",this.rev_btn.visible=!1):e.taskStatus==Cmd.TaskStatus.Task_Status_Complete?(this.go_btn.visible=!1,this.rev_btn.visible=!0):e.taskStatus==Cmd.TaskStatus.Task_Status_Received&&(this.rev_btn.visible=!1,this.go_btn.visible=!0,this.go_btn.currentState="disabled",this.go_btn.touchEnabled=!1)},e.prototype.destroy=function(){this.rev_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.go_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this)},e}(eui.ItemRenderer);t.TaskItem=e,__reflect(e.prototype,"reward.TaskItem")}(reward||(reward={}));var reward;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.effects=[],t.skinName="DiamondsPanelSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.groups=[this.itme1,this.itme2,this.itme3,this.itme4],this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this);for(var i=0;i<this.groups.length;i++)this.groups[i].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this);uniLib.Global.addEventListener(t.CmdConstant.DIAMONDINTERFACETIPS,this.onDiamondInterfaceTips,this),this.initData()},i.prototype.initData=function(t){void 0===t&&(t=2);var e=new Cmd.GetDiamondInterfaceTips_C;e.typ=t,NetMgr.tcpSend(e)},i.prototype.onDiamondInterfaceTips=function(t){var e=t.param,i=e.tips;if(null!=i&&0!=i.length){this.clearEffect();for(var n=0;n<i.length;n++)this.addEffect(i[n]-1)}},i.prototype.clearEffect=function(){for(var t=0;t<this.effects.length;t++)this.effects[t].dispose(),this.effects[t].removeChildren(),uniLib.DisplayUtils.removeFromParent(this.effects[t]);this.effects=[]},i.prototype.addEffect=function(t){var e=new eui.WxContain;e.x=e.y=0;var i=new eui.ArmatureComponent;i.resName="yuanquan",i.update(),i.x=88,i.y=89,e.addChild(i);var n=t+1,s=new egret.Bitmap(RES.getRes("reward_icon"+n+"_png"));s.x=(175-s.width)/2,s.y=(178-s.height)/2,e.addChild(s);var o=new egret.Bitmap(RES.getRes("reward_tuijian_png"));o.x=93,o.y=-2,e.addChild(o),this.groups[t].removeChildAt(0),this.groups[t].addChildAt(e,0),this.effects.push(e)},i.prototype.setBackFuns=function(t,e){this._funs=t,this._arg=e},i.prototype.onTouchHandler=function(t){switch(t.currentTarget){case this._closeBtn:uniLib.PopUpMgr.removePopUp(this);break;case this.itme1:this.callFun(0);break;case this.itme2:this.callFun(1);break;case this.itme3:this.callFun(2);break;case this.itme4:this.callFun(3)}},i.prototype.callFun=function(t){this._funs&&this._funs.length>=t&&this._funs[t]?this._funs[t].apply(this,[this._arg[t]]):console.error("没配置第"+t+"个的回调函数")},i.prototype.destroy=function(){this._funs=null,this.clearEffect(),uniLib.Global.removeEventListener(t.CmdConstant.DIAMONDINTERFACETIPS,this.onDiamondInterfaceTips,this),this._closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this);for(var e=0;e<this.groups.length;e++)this.groups[e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this);this.groups[e]=null,this.removeChildren()},i}(eui.Component);t.DiamondsPanel=e,__reflect(e.prototype,"reward.DiamondsPanel")}(reward||(reward={}));var eui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.anchorOffsetX=this.width>>1,this.anchorOffsetY=this.height>>1,this.x+=this.width>>1,this.y+=this.height>>1},e.prototype.init=function(){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancel,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchReleaseOutside,this),this.addEventListener(egret.Event.REMOVED,this.dispose,this)},e.prototype.onTouchBegin=function(){this.scaleX=.9,this.scaleY=.9,RES.hasRes("buttonClick_mp3")&&uniLib.SoundMgr.instance.playSound("buttonClick_mp3")},e.prototype.onTouchEnd=function(){this.scaleX=1,this.scaleY=1},e.prototype.onTouchCancel=function(){this.scaleX=1,this.scaleY=1},e.prototype.onTouchMove=function(){this.scaleX=1,this.scaleY=1},e.prototype.onTouchReleaseOutside=function(){this.scaleX=1,this.scaleY=1},e.prototype.dispose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancel,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.Event.REMOVED,this.dispose,this),this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchReleaseOutside,this)},e}(t.Group);t.WxContain=e,__reflect(e.prototype,"eui.WxContain")}(eui||(eui={}));var reward;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i._taskReward=e,i.skinName="ActiveBoxPanelSkin",i}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._items=[];for(var e=0;e<this._taskReward.length;e++){var n=new i(this._taskReward[e]);this.goods.addChild(n),n.x=e%2*189,2==this._taskReward.length?n.y=88:n.y=177*Math.floor(e/2)}},e.prototype.destroy=function(){if(this._items){for(var t=0;t<this._items.length;t++)this._items[t].destroy();this._items=null}this.removeChildren()},e}(eui.Component);t.ActiveBoxPanel=e,__reflect(e.prototype,"reward.ActiveBoxPanel");var i=function(t){function e(e){var i=t.call(this)||this;return i.initUI(e),i.touchEnabled=!0,i}return __extends(e,t),e.prototype.initUI=function(t){this.info=t,this.gift=new egret.Bitmap,this.gift.texture=RES.getRes("active_reward_json.active_item_bg"),this.addChild(this.gift);var e=new egret.Bitmap;e.texture=RES.getRes("game_prop_json.bag_daoju_"+this.info.goodId),this.addChild(e),commonConfirm.ResUtil.limitImageSize(e,110),e.x=this.gift.width-e.width>>1,e.y=this.gift.height-e.height-34>>1;var i=new egret.TextField;i.fontFamily="Microsoft YaHei",i.textColor=16777215,i.size=24,this.addChild(i);var n=ConfigMgr.getInstance().getGoodCfgById(this.info.goodId);i.text=n.goodName+"x"+this.info.goodNbr,i.x=(this.gift.width-i.width)/2,i.y=this.gift.height-i.height-4},e.prototype.destroy=function(){this.gift&&(egret.Tween.removeTweens(this.gift),this.gift=null)},e}(egret.DisplayObjectContainer);t.RewardItem=i,__reflect(i.prototype,"reward.RewardItem")}(reward||(reward={}));var reward;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.maxValue=0,t.skinName="EnergyViewSkin",t}return __extends(n,e),n.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initData()},n.prototype.initData=function(){uniLib.Global.addEventListener(t.CmdConstant.INTOFREEGOLD,this.onDailyTask,this),uniLib.Global.addEventListener(t.CmdConstant.UPDATE_DAYS_TASK_LOBBY,this.onUpdateDaysTask,this)},n.prototype.onDailyTask=function(t){var e=t.param;if(this.taskInfo=e.taskInfo,null!=this.taskInfo&&this.taskInfo instanceof Array){this.items=[];for(var n=0,s=0;s<this.taskInfo.length;s++){var o=new i(this.taskInfo[s],s+1);this.reward_contain.addChild(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.items.push(o),this.maxValue<o.condition&&(this.maxValue=o.condition),n<this.taskInfo[s].current&&(n=this.taskInfo[s].current)}this.maxValue=this.maxValue+5,this.updateProgress(n);for(var r=0;r<this.items.length;r++)this.items[r].x=this.items[r].condition/this.maxValue*550,this.items[r].y=25}},n.prototype.onUpdateDaysTask=function(t){var e=t.param;this.taskInfo=e.taskInfo;for(var i=0,n=0;n<this.taskInfo.length;n++){for(var s=0;s<this.items.length;s++)this.items[s].taskId==this.taskInfo[n].taskId&&this.items[s].setRewardState(this.taskInfo[n].taskStatus);i<this.taskInfo[n].current&&(i=this.taskInfo[n].current)}this.updateProgress(i)},n.prototype.updateProgress=function(t){this.energy_total.text=null==t?"0":t+"",t>this.maxValue&&(t=this.maxValue),this.energy_pro.width=t/this.maxValue*550},n.prototype.onTouchHandler=function(e){var i=this,n=this.items.indexOf(e.target);if(n>-1)if(this.items[n].taskStatus==Cmd.TaskStatus.Task_Status_Complete){var s=new Cmd.GetDaysTaskRewardLobbyCmd_C;s.lobbyId=NetMgr.getLoginCfg().lobbyId,s.taskId=this.taskInfo[n].taskId,NetMgr.tcpSend(s),this.taskInfo[n].taskStatus=Cmd.TaskStatus.Task_Status_Received,this.items[n].setRewardState(Cmd.TaskStatus.Task_Status_Received)}else LoadPanelTipMgr.getInstance().loadRes(t.RewardConsts.ACTIVE_BOX,function(){var e=ConfigMgr.getInstance().getTaskCfgById(i.items[n].taskId);uniLib.PopUpMgr.addPopUp(t.ActiveBoxPanel,null,!0,!0,0,uniLib.PopUpEffect.CENTER,0,0,e.taskReward)})},n.prototype.destroy=function(){if(this.items){for(var e=0;e<this.items.length;e++)this.items[e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this);this.items=null}uniLib.Global.removeEventListener(t.CmdConstant.UPDATE_DAYS_TASK_LOBBY,this.onUpdateDaysTask,this),uniLib.Global.removeEventListener(t.CmdConstant.INTOFREEGOLD,this.onDailyTask,this),this.removeChildren()},n}(eui.Component);t.EnergyView=e,__reflect(e.prototype,"reward.EnergyView");var i=function(t){function e(e,i){var n=t.call(this)||this;return n.initUI(e,i),n.touchEnabled=!0,n}return __extends(e,t),e.prototype.initUI=function(t,e){this._index=e,this.taskId=t.taskId,this.taskStatus=t.taskStatus,this.gift=new egret.Bitmap,this.gift.texture=RES.getRes("energy_json.gift_"+this._index),this.gift.anchorOffsetX=this.gift.width>>1,this.gift.anchorOffsetY=20,this.addChild(this.gift),this.txt=new egret.BitmapText,this.txt.font=RES.getRes("energy_progress_fnt");var i=ConfigMgr.getInstance().getTaskCfgById(t.taskId);this.condition=i.taskCondition,this.txt.text=i.taskCondition+"",this.addChild(this.txt),this.txt.y=40,this.txt.x=-this.txt.width>>1,this.setRewardState(t.taskStatus)},e.prototype.setRewardState=function(t){egret.Tween.removeTweens(this.gift),this.gift.rotation=0,this.taskStatus=t,t==Cmd.TaskStatus.Task_Status_Unstart?this.gift.texture=RES.getRes("energy_json.gift_"+this._index):t==Cmd.TaskStatus.Task_Status_Complete?(this.gift.texture=RES.getRes("energy_json.gift_"+this._index),egret.Tween.get(this.gift,{loop:!0}).to({rotation:15},100).to({rotation:0},100).to({rotation:-15},100).to({rotation:0},100).wait(400)):t==Cmd.TaskStatus.Task_Status_Received?this.gift.texture=RES.getRes("energy_json.gift_100"):t==Cmd.TaskStatus.Task_Status_Progress&&(this.gift.texture=RES.getRes("energy_json.gift_"+this._index))},e.prototype.destroy=function(){this.gift&&(egret.Tween.removeTweens(this.gift),this.gift=null)},e}(egret.DisplayObjectContainer);t.EnergyItem=i,__reflect(i.prototype,"reward.EnergyItem")}(reward||(reward={}));var reward;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return t&&(i._taskId=t),i.skinName="NewFuliPanelSkin",i}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this._viewGroup=[this.task_view1,this.task_view2,this.task_view3],this._btnGroup=[this.men_rbtn1,this.men_rbtn2,this.men_rbtn3],this.close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.men_rbtn1.group.addEventListener(egret.Event.CHANGE,this.showTabContent,this),uniLib.Global.addEventListener(t.CmdConstant.NEW_ONCETASK_LOBBY,this.onOnceTaskHandler,this),uniLib.Global.addEventListener(t.CmdConstant.NEW_ONCEREWARD_LOBBY,this.onOnceRewardHandler,this),this.initData()},i.prototype.initData=function(){var t=new Cmd.RequestOnceTaskLobbyCmd_C;NetMgr.tcpSend(t)},i.prototype.onOnceTaskHandler=function(t){var e=t.param;this.task_view1.setData(e.fktasks),this.task_view2.setData(e.qhtasks),this.task_view3.setData(e.diamondtasks),this._taskId?this.findTask(e.fktasks)>-1?this.setMenu(0):this.findTask(e.qhtasks)>-1?this.setMenu(1):this.findTask(e.diamondtasks)>-1?this.setMenu(2):this.setMenu(0):this.setMenu(0)},i.prototype.setMenu=function(t){this._defaultMenu=t,this._viewGroup[this._defaultMenu].visible=!0,this._btnGroup[this._defaultMenu].selected=!0,this.men_rbtn1.group.selectedValue=this._defaultMenu,this._pos>3&&this._viewGroup[this._defaultMenu].scrollTTo(147*this._pos)},i.prototype.findTask=function(t){if(null==t||0==t.length)return-1;for(var e=0;e<t.length;e++)if(t[e].taskId==this._taskId)return this._pos=e,e},i.prototype.onOnceRewardHandler=function(t){var e=t.param;this.task_view1.updateTask(e.taskId),this.task_view2.updateTask(e.taskId),this.task_view3.updateTask(e.taskId)},i.prototype.showTabContent=function(t){this._viewGroup[this._defaultMenu].visible=!1;var e=t.target;this._defaultMenu=parseInt(e.selectedValue),this._viewGroup[this._defaultMenu].visible=!0},i.prototype.onTouchHandler=function(t){uniLib.PopUpMgr.removePopUp(this)},i.prototype.destroy=function(){uniLib.Global.removeEventListener(t.CmdConstant.NEW_ONCETASK_LOBBY,this.onOnceTaskHandler,this),uniLib.Global.removeEventListener(t.CmdConstant.NEW_ONCEREWARD_LOBBY,this.onOnceRewardHandler,this),this.close_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.men_rbtn1.group.removeEventListener(egret.Event.CHANGE,this.showTabContent,this);for(var e=0;e<this._viewGroup.length;e++)this._viewGroup[e].destroy();this._viewGroup=null,this._btnGroup=null,this.removeChildren()},i}(eui.Component);t.NewFuLiPanel=e,__reflect(e.prototype,"reward.NewFuLiPanel")}(reward||(reward={}));var reward;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skipType=0,e.skinName="TaskItem2Skin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.progress_img.mask=this.progress_mask,this.rev_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.go_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this)},e.prototype.onTouchHandler=function(t){if(t.target==this.rev_btn){this.go_btn.currentState="disabled",this.go_btn.visible=!0,this.go_btn.touchEnabled=!1,this.rev_btn.visible=!1;var e=new Cmd.GetOnceRewardLobbyCmd_C;e.taskId=this.data.taskId,NetMgr.tcpSend(e),wxgame.Global.instance.aldSendEvent("周边系统","每日任务: "+this.data.taskID+"领取")}else t.target==this.go_btn&&this.skipType>0&&LobbyModuleMgr.getInstance().openPanelBySkipType(this.skipType)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data,i=ConfigMgr.getInstance().getTaskCfgById(e.taskId),n=i.taskDesc;if(this.skipType=i.skipType,n=n.replace(new RegExp("%a","gm"),i.taskCondition+""),this.good_content.text=n,this.good_gress.text=e.current+"/"+i.taskCondition,i.frontTaskCondition&&i.frontTaskCondition.length>0?this.good_icon.source="fish_common_json.fish_"+i.frontTaskCondition[0]:this.good_icon.source="fish_common_json.fish_0",this.good_icon.x=76-this.good_icon.width/2,this.progress_mask.width=286*(e.current/i.taskCondition),i.taskReward){ConfigMgr.getInstance().getGoodCfgById(i.taskReward[0].goodId);this.reward_num.text="x"+i.taskReward[0].goodNbr,this.reward_icon.source="game_prop_json.bag_daoju_"+i.taskReward[0].goodId,commonConfirm.ResUtil.limitImageSize(this.reward_icon,50)}e.taskStatus<=Cmd.TaskStatus.Task_Status_Progress?(this.go_btn.visible=this.skipType>0&&!uniLib.Global.isInGame,this.go_btn.currentState="",this.rev_btn.visible=!1):e.taskStatus==Cmd.TaskStatus.Task_Status_Complete?(this.go_btn.visible=!1,this.rev_btn.visible=!0):e.taskStatus==Cmd.TaskStatus.Task_Status_Received&&(this.rev_btn.visible=!1,this.go_btn.visible=!0,this.go_btn.currentState="disabled",this.go_btn.touchEnabled=!1)},e.prototype.destroy=function(){this.rev_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.go_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this)},e}(eui.ItemRenderer);t.TaskItem2=e,__reflect(e.prototype,"reward.TaskItem2")}(reward||(reward={}));var reward;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName="TaskView2Skin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.task_lst.itemRenderer=t.TaskItem2},i.prototype.setData=function(t){this._taskInfo=new eui.ArrayCollection(t),this.task_lst.dataProvider=this._taskInfo},i.prototype.updateTask=function(t){for(var e=0;e<this._taskInfo.source.length;e++)if(t==this._taskInfo.source[e].taskId){this._taskInfo.source[e].taskStatus=Cmd.TaskStatus.Task_Status_Received,this._taskInfo.replaceItemAt(this._taskInfo.source[e],e);break}},i.prototype.scrollTTo=function(t){this.scroll.viewport.scrollV=t},i.prototype.destroy=function(){for(var t=0;t<this.task_lst.numChildren;t++){var e=this.task_lst.getChildAt(t);e&&e.destroy()}this.task_lst=null,this.removeChildren()},i}(eui.Component);t.TaskView2=e,__reflect(e.prototype,"reward.TaskView2")}(reward||(reward={}));var reward;!function(t){var e=function(){function t(){}return t.NOVICEINFO="NoviceInfo",t.NOVICEREWARD="NoviceReward",t.INTOFREEGOLD="IntoFreeGold",t.DAYSTASKREWARD="DaysTaskReward",t.IOSINVITEINFOLITTLE="IosInviteInfoLittle",t.IOSINVITEREWARDLITTLE="IosInviteRewardLittle",t.DIAMONDINTERFACETIPS="DiamondInterfaceTips",t.NEW_ONCETASK_LOBBY="OnceTaskLobby",t.NEW_ONCEREWARD_LOBBY="OnceRewardLobby",t.UPDATE_DAYS_TASK_LOBBY="UpdateDaysTaskLobby",t}();t.CmdConstant=e,__reflect(e.prototype,"reward.CmdConstant")}(reward||(reward={}));var RewardReciveMgr=function(){function t(){}return t}();__reflect(RewardReciveMgr.prototype,"RewardReciveMgr");var Cmd;!function(t){function e(t){t.resultCode||uniLib.Global.dispatchEvent(reward.CmdConstant.NOVICEINFO,t.noviceInfo)}function i(t){t.resultCode||uniLib.PopUpMgr.removePopUp(reward.FuLiPanel)
}function n(t){t.resultCode||uniLib.Global.dispatchEvent(reward.CmdConstant.INTOFREEGOLD,t)}function s(e){uniLib.Global.dispatchEvent(reward.CmdConstant.DAYSTASKREWARD,e);var i=ConfigMgr.getInstance().getTaskCfgById(e.taskId);if(i&&i.taskReward){for(var n=[],s=0;s<i.taskReward.length;s++){var o=new t.RewardItem;o.goodId=i.taskReward[s].goodId,o.goodNbr=i.taskReward[s].goodNbr,n.push(o)}var r=new commonConfirm.RewardPanel;r.initData2(n),uniLib.Global.isInGame&&LobbyModuleMgr.getInstance().panelScaleX?(r.scaleX=LobbyModuleMgr.getInstance().panelScaleX,uniLib.PopUpMgr.addPopUp(r,null,!0,!0,0,uniLib.PopUpEffect.NOMAL,1280*r.scaleX,720)):uniLib.PopUpMgr.addPopUp(r,null,!0,!1)}}function o(t){uniLib.Global.dispatchEvent(reward.CmdConstant.IOSINVITEINFOLITTLE,t)}function r(t){if(!t.resultCode){uniLib.Global.dispatchEvent(reward.CmdConstant.IOSINVITEREWARDLITTLE,t);var e=t.single.goods;if(e){var i=new commonConfirm.ReWardDataVo;i.getDataByGoodId(e.goodsId,e.goodsNum);var n=new commonConfirm.RewardPanel;n.initData([i]),uniLib.Global.isInGame&&LobbyModuleMgr.getInstance().panelScaleX?(n.scaleX=LobbyModuleMgr.getInstance().panelScaleX,uniLib.PopUpMgr.addPopUp(n,null,!0,!0,0,uniLib.PopUpEffect.NOMAL,1280*n.scaleX,720)):uniLib.PopUpMgr.addPopUp(n,null,!0,!1),wxgame.Global.instance.aldSendEvent("周边系统","领钻石领取成功")}}}function a(t){uniLib.Global.dispatchEvent(reward.CmdConstant.DIAMONDINTERFACETIPS,t)}function h(t){null==t.resultCode&&(t.resultCode=0),0==t.resultCode&&uniLib.Global.dispatchEvent(reward.CmdConstant.NEW_ONCETASK_LOBBY,t)}function d(t){null==t.resultCode&&(t.resultCode=0),0==t.resultCode&&uniLib.Global.dispatchEvent(reward.CmdConstant.NEW_ONCEREWARD_LOBBY,t)}function l(t){uniLib.Global.dispatchEvent(reward.CmdConstant.UPDATE_DAYS_TASK_LOBBY,t)}t.OnGetNoviceInfodLobbyCmd_S=e,t.OnGetNoviceRewarddLobbyCmd_S=i,t.OnIntoFreeGoldLobbyCmd_S=n,t.OnGetDaysTaskRewardLobbyCmd_S=s,t.OnGetIosInviteInfoLittleGameLobbyCmd_S=o,t.OnGetIosInviteRewardLittleGameLobbyCmd_S=r,t.OnGetDiamondInterfaceTips_S=a,t.OnRequestOnceTaskLobbyCmd_S=h,t.OnGetOnceRewardLobbyCmd_S=d,t.OnUpdateDaysTaskLobbyCmd_S=l}(Cmd||(Cmd={}));