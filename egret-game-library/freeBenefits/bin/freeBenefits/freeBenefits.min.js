var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);n.prototype=t.prototype,e.prototype=new n},freeBenefits;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t._plat={},t.onTapCall=function(e){wxgame.Global.instance.aldSendEvent("进入大厅","点击登录按钮"),e&&e.errMsg.indexOf("ok")>=0?(wxgame.Global.instance.aldSendEvent("进入大厅","成功授权"),t._wxBtn.hide(),t.wxLoginSuc(e)):(t._wxBtn.show(),wx.showModal({title:"授权提示",content:"获取用户信息失败，请确认授权！",showCancel:!1}))},t.skinName="AuthoPanelSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),uniLib.Global.addEventListener("GET_PAGE_INFO",this.onInfo,this);var t=new Cmd.GetPageInfoHpMatchCmd_C;t.typ=Cmd.PAGE_TYPE.AUTHORIZE,NetMgr.tcpSend(t),uniLib.Global.isWxGame()&&1==MJLobbyData.getInstance().userInfoSynLobby.loginByOpenId&&(uniLib.ZQGameSdk.Login(this.wxAuthorizeLogin,this.onLogout,this),this.reward_btn.visible=!1)},t.prototype.wxAuthorizeLogin=function(e){if(0==e.code&&(e.data.session&&(this._plat.sign=e.data.session),e.data.payplatid&&(uniLib.Global.payPlatId=e.data.payplatid),e.data.platid&&(this._plat.platid=e.data.platid),wx.createUserInfoButton)){var t=wx.getSystemInfoSync(),n=t.screenWidth/uniLib.Global.screenWidth,i=t.screenHeight/uniLib.Global.screenHeight,o=this.localToGlobal(325,381);this._wxBtn=wx.createUserInfoButton({type:"image",image:MJLobbyData.wxGameResPath+"shc_btn.png?time="+Math.random(),withCredentials:!0,style:{left:(t.screenWidth-this.reward_btn.width*n)/2,top:o.y*i,width:this.reward_btn.width*n,height:this.reward_btn.height*i,lineHeight:40,borderColor:"#ff0000",backgroundColor:"#ff0000",textAlign:"center",fontSize:16,borderWidth:0,borderRadius:4},text:"获取用户信息"}),this._wxBtn.onTap(this.onTapCall)}},t.prototype.onLogout=function(){var e=this;wxgame.Global.instance.aldSendEvent("进入大厅","login失败"),LobbyUtils.instance.dealLoadError("login失败，请重试",function(){e._wxBtn&&e._wxBtn.show()})},t.prototype.wxLoginSuc=function(e){e.userInfo.nickName&&(this._plat.nickname=e.userInfo.nickName),e.userInfo.gender&&(this._plat.gender=e.userInfo.gender),e.userInfo.avatarUrl&&(this._plat.faceurl=e.userInfo.avatarUrl);var t=wx.getLaunchOptionsSync(),n={encryptedData:e.encryptedData,iv:e.iv,subPlatId:0};t.query&&t.query.qudao&&(n.subPlatId=parseInt(t.query.qudao)),wxgame.Global.instance.aldSendEvent("渠道","授权"+n.subPlatId),this._plat.extdata=JSON.stringify(n),this._plat.osname=egret.Capabilities.os,uniLib.Utils.clearLocalStorage(),NetMgr.authoLogout(),uniLib.Global.initPlatInfo(this._plat),LobbyUtils.instance.enterLobbyLoadGroup()},t.prototype.onTouchHandler=function(e){e.target==this.close_btn&&uniLib.PopUpMgr.removePopUp(this)},t.prototype.onInfo=function(e){this.setInfo(e.param)},t.prototype.setInfo=function(e){this.reward_lst.itemRenderer=n,this.reward_lst.dataProvider=new eui.ArrayCollection(e.rewards)},t.prototype.destroy=function(){this.close_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),uniLib.Global.removeEventListener("GET_PAGE_INFO",this.onInfo,this),this._plat=null,this._wxBtn&&(this._wxBtn.offTap(this.onTapCall),this._wxBtn.destroy(),this._wxBtn=null)},t}(eui.Component);e.AuthoPanel=t,__reflect(t.prototype,"freeBenefits.AuthoPanel");var n=function(e){function t(){var t=e.call(this)||this;return t.skinName="AuthoItemSkin",t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this.data,n=ConfigMgr.getInstance().getGoodCfgById(t.goodId);this.desc_lbl.text=n.goodName+"x"+t.goodNbr,this.icon_img.source="lb_autho_panel_json."+n.goodIcon},t}(eui.ItemRenderer);__reflect(n.prototype,"AuthoItem")}(freeBenefits||(freeBenefits={}));var freeBenefits;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="DeskCollectionSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.reward_btn.visible=MJLobbyData.getInstance().dtlaunchaward,this.reward_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this)},t.prototype.onTouchHandler=function(e){var t=new Cmd.GetDesktopLaunchAwardHpMatchCmd_C;NetMgr.tcpSend(t)},t.prototype.destroy=function(){this.reward_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this)},t}(eui.Component);e.DeskCollectionPanel=t,__reflect(t.prototype,"freeBenefits.DeskCollectionPanel")}(freeBenefits||(freeBenefits={}));var freeBenefits;!function(e){var t=function(){function e(){}return e.RES_JSON="resource/freeBenefits.res.json",e.RES_MAHJONG_JSON="resource/freeBenefits_mahjong.res.json",e.RES_BUYU_JSON="resource/freeBenefits/freeBenefits_buyu.res_5d839b5f.json",e.THM_JSON="resource/freeBenefits/gameEui_eec4852f.json",e.PUB_FREEBENEFITS="pub_freeBenefits",e.PUB_DESKCOLLECTION="pub_deskCollection",e.PUB_PUBLICADDRESS="pub_publicAddress",e.PUB_AUTHO="pub_autho",e}();e.FreeBenefitsConsts=t,__reflect(t.prototype,"freeBenefits.FreeBenefitsConsts")}(freeBenefits||(freeBenefits={}));var freeBenefits;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.skinName="FreeBenefitsSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.groups=[this.itme1,this.itme2,this.itme3,this.itme4];for(var e=0;e<this.groups.length;e++)this.groups[e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this);uniLib.Global.isNative?(uniLib.DisplayUtils.removeFromParent(this.itme3),uniLib.DisplayUtils.removeFromParent(this.itme4)):wxgame.Utils.isIos&&uniLib.DisplayUtils.removeFromParent(this.itme4),uniLib.Global.isWxGame()||152==uniLib.Global.platId||uniLib.DisplayUtils.removeFromParent(this.itme2),this.addRedPoint()},n.prototype.addRedPoint=function(){LobbyRedPointMgr.instance.registerRedPoint(Cmd.MsgType.Act_DaySign,[[this.red1]]),152!=uniLib.Global.platId&&LobbyRedPointMgr.instance.registerRedPoint(Cmd.MsgType.Share,[[this.red2]]),uniLib.Global.isWxGame()&&(LobbyRedPointMgr.instance.registerRedPoint(Cmd.MsgType.Subscribe,[[this.red4]]),LobbyRedPointMgr.instance.registerRedPoint(Cmd.MsgType.Desk,[[this.red5]]))},n.prototype.removeRedPoint=function(){LobbyRedPointMgr.instance.unregisterRedPoint(Cmd.MsgType.Act_DaySign),LobbyRedPointMgr.instance.unregisterRedPoint(Cmd.MsgType.Share),LobbyRedPointMgr.instance.unregisterRedPoint(Cmd.MsgType.Subscribe),LobbyRedPointMgr.instance.unregisterRedPoint(Cmd.MsgType.Desk)},n.prototype.setBackFuns=function(e,t){this._funs=e,this._arg=t},n.prototype.onTouchHandler=function(t){switch(t.currentTarget){case this._closeBtn:uniLib.PopUpMgr.removePopUp(this);break;case this.itme1:this.callFun(0);break;case this.itme2:this.callFun(1);break;case this.itme3:this.callFun(2);break;case this.itme4:LoadPanelTipMgr.getInstance().loadRes(e.FreeBenefitsConsts.PUB_DESKCOLLECTION,function(){uniLib.PopUpMgr.addPopUp(e.DeskCollectionPanel,null,!0,!0,0,uniLib.PopUpEffect.CENTER)})}},n.prototype.callFun=function(e){this._funs&&this._funs.length>=e&&this._funs[e]?this._funs[e].apply(this,[this._arg[e]]):console.error("没配置第"+e+"个的回调函数")},n.prototype.destroy=function(){this.removeRedPoint(),this._funs=null,this._closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this);for(var e=0;e<this.groups.length;e++)this.groups[e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this);this.groups[e]=null,this.removeChildren()},n}(eui.Component);e.FreeBenefitsPanel=t,__reflect(t.prototype,"freeBenefits.FreeBenefitsPanel")}(freeBenefits||(freeBenefits={}));var freeBenefits;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="PublicAddressSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.reward_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.copy_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),uniLib.Global.addEventListener("GET_PAGE_INFO",this.onInfo,this);var t=new Cmd.GetPageInfoHpMatchCmd_C;t.typ=Cmd.PAGE_TYPE.PUBLIC_ACCOUNT,NetMgr.tcpSend(t)},t.prototype.onTouchHandler=function(e){if(e.target==this.reward_btn)if(878==MJLobbyData.getInstance().qudao){var t=new Cmd.GetPageRewardHpMatchCmd_C;t.typ=Cmd.PAGE_TYPE.PUBLIC_ACCOUNT,NetMgr.tcpSend(t)}else uniLib.TipsUtils.showTipsDownToUp("从公众号启动小程序才能领取奖励哦！");else e.target==this.copy_btn?(uniLib.ZQGameSdk.nativeCopyStr("haocaipdk"),uniLib.TipsUtils.showTipsDownToUp("复制成功")):e.target==this.close_btn&&uniLib.PopUpMgr.removePopUp(this)},t.prototype.onInfo=function(e){this.setInfo(e.param)},t.prototype.setInfo=function(e){2==e.status?this.reward_btn.enabled=!1:1==e.status&&(this.reward_btn.enabled=!0);for(var t=0;t<e.rewards.length;t++){var n=new eui.Component;n.width=n.height=108;var i=new eui.Image(RES.getRes("publicAddress_json.lb_gzgzh_bg4"));i.scale9Grid=new egret.Rectangle(11,11,2,2),i.width=i.height=108,n.addChild(i);var o=e.rewards[t],r=new eui.Image,s=new eui.BitmapLabel(o.goodNbr+"");s.font=RES.getRes("publicAddress_font_fnt"),s.validateNow(),s.y=n.height-30,s.x=n.width-17*(o.goodNbr+"").length,n.addChild(r),n.addChild(s),6==o.goodId?r.texture=RES.getRes("publicAddress_json.lb_gzgzh_diamond"):32==o.goodId?r.texture=RES.getRes("publicAddress_json.lb_gzgzh_jinbi"):336==o.goodId&&(r.texture=RES.getRes("publicAddress_json.lb_gzgzh_fuka")),r.x=n.width-r.width>>1,r.y=n.height-r.height>>1,this.reward_grp.addChild(n)}},t.prototype.destroy=function(){uniLib.Global.removeEventListener("GET_PAGE_INFO",this.onInfo,this),this.reward_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.copy_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this),this.close_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHandler,this)},t}(eui.Component);e.PublicAddressPanel=t,__reflect(t.prototype,"freeBenefits.PublicAddressPanel")}(freeBenefits||(freeBenefits={}));