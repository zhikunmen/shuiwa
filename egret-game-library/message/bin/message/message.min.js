var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);i.prototype=e.prototype,t.prototype=new i},message;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.listX=[[322.5],[225,445]],t.skinName="EmailVCSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addEvent()},i.prototype.initData=function(e){if(this.data=e,this._prizeTxt.text=e.subject,this._msgTxt.text=e.content,this._fromTxt.text=e.sendName,this._timeTxt.text=this.initTime(e.stamp),e.attachment){this._getBtn.visible=!0;for(var i=0;i<e.attachment.length;i++){var s=new t.PrizeItem;s.x=this.listX[e.attachment.length-1][i],s.y=this._msgTxt.height+this._msgTxt.y+10,this._group.addChild(s),s.initData(e.attachment[i]),this._fromTxt.y=s.y+s.height+10}this._scroll.height=302}else this._getBtn.visible=!1,this._scroll.height=205,this._fromTxt.y=this._msgTxt.height+this._msgTxt.y+10;this._timeTxt.y=this._fromTxt.y+30},i.prototype.initTime=function(t){var e=new Date(1e3*t),i=e.getFullYear()+"-",s=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",n=(e.getDate()<10?"0"+e.getDate():e.getDate())+" ",o=(e.getHours()<10?"0"+e.getHours():e.getHours())+":",r=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes();return i+s+n+o+r},i.prototype.addEvent=function(){this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeEmail,this),this._getBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getPrize,this)},i.prototype.getPrize=function(){var t=new Cmd.GetMailRewardCmd_C;t.id=this.data.id,NetMgr.tcpSend(t);var e=new Cmd.GetListMailCmd_C;e.mailtype=0,NetMgr.tcpSend(e),this._getBtn.visible=!1},i.prototype.closeEmail=function(){uniLib.PopUpMgr.removePopUp(this)},i.prototype.removeEvent=function(){this._closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeEmail,this),this._getBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.getPrize,this)},i.prototype.destroy=function(){var t=new Cmd.DeleteMailCmd_C;t.ids=[this.data.id],NetMgr.tcpSend(t),this.removeEvent(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i}(eui.Component);t.EmailVC=e,__reflect(e.prototype,"message.EmailVC")}(message||(message={}));var message;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="FriendItemSkin",e.addEvent(),e}return __extends(e,t),e.prototype.addEvent=function(){this._getBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getPrize,this)},e.prototype.getPrize=function(){var t=new Cmd.GetMailRewardCmd_C;t.id=this.mailData.id,NetMgr.tcpSend(t)},e.prototype.dataChanged=function(){var t=this.data;this.mailData=t,this._nickName.text=t.sendName,this._msg.text=t.content,this._typeTxt.text="x"+t.chips,1==t.state||2==t.state?(this._getBtn.visible=!0,this._noGet.visible=!1):(this._getBtn.visible=!1,this._noGet.visible=!0)},e.prototype.removeEvent=function(){this._getBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.getPrize,this)},e.prototype.destroy=function(){this.removeEvent(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},e}(eui.ItemRenderer);t.FriendItem=e,__reflect(e.prototype,"message.FriendItem")}(message||(message={}));var message;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._friendData=new eui.ArrayCollection,t._sysData=new eui.ArrayCollection,t.mailType=0,t.skinName="MainVCSkin",t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init(),this.addEvent(),this.sendReq()},i.prototype.sendReq=function(){var t=new Cmd.GetListMailCmd_C;t.mailtype=this.mailType,NetMgr.tcpSend(t)},i.prototype.init=function(){this._friendList.itemRenderer=t.FriendItem,this._friendList.dataProvider=this._friendData,this._friendScroll.viewport=this._friendList,this._sysList.itemRenderer=t.SysItem,this._sysList.dataProvider=this._sysData,this._sysScroll.viewport=this._sysList,this._friendScroll.horizontalScrollBar=null,this._friendScroll.verticalScrollBar=null,this._sysScroll.horizontalScrollBar=null,this._sysScroll.verticalScrollBar=null},i.prototype.addEvent=function(){uniLib.Global.addEventListener(t.MessageConst.GET_MAILLIST,this.setMail,this),uniLib.Global.addEventListener(t.MessageConst.REMOVE_ALL_MAIL,this.showSys,this),uniLib.Global.addEventListener(t.MessageConst.GET_PRIZE,this.showFriend,this),this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeEmail,this),this._getBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mailHandle,this),this._friendBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showFriend,this),this._sysBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showSys,this),this._lookBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mailHandle,this)},i.prototype.showFriend=function(){this._friendPanel.visible=!0,this._sysPanel.visible=!1,this.mailType=1,this.sendReq()},i.prototype.showSys=function(){this._friendPanel.visible=!1,this._sysPanel.visible=!0,this.mailType=0,this.sendReq()},i.prototype.setMail=function(t){this._friendData.source=[],this._friendData.refresh(),this._sysData.source=[],this._sysData.refresh();var e=t.param;e.mailInfo.length>0?(this._noMail.visible=!1,1==this.mailType?(this._getBtn.visible=!0,this._friendData.source=e.mailInfo,this._friendData.refresh()):(this._lookBtn.visible=!0,this._sysData.source=e.mailInfo,this._sysData.refresh())):(this._lookBtn.visible=!1,this._getBtn.visible=!1,this._noMail.visible=!0)},i.prototype.mailHandle=function(){var t=new Cmd.BulkOperationMailCmd_C;t.opType=this.mailType,NetMgr.tcpSend(t)},i.prototype.closeEmail=function(){uniLib.PopUpMgr.removePopUp(this)},i.prototype.removeEvent=function(){uniLib.Global.removeEventListener(t.MessageConst.GET_MAILLIST,this.setMail,this),uniLib.Global.removeEventListener(t.MessageConst.REMOVE_ALL_MAIL,this.showSys,this),uniLib.Global.removeEventListener(t.MessageConst.GET_PRIZE,this.showFriend,this),this._closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeEmail,this),this._getBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.mailHandle,this),this._friendBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showFriend,this),this._sysBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showSys,this),this._lookBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.mailHandle,this)},i.prototype.destroy=function(){this.removeEvent(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i}(eui.Component);t.MainVC=e,__reflect(e.prototype,"message.MainVC")}(message||(message={}));var message;!function(t){var e=function(){function t(){}return t.RES_JSON="resource/message/message.res_a9de5b2e.json",t.THM_JSON="resource/message/gameEui_cfeb8e07.json",t.PUB_MESSAGE="pub_message",t.GET_MAILLIST="Get_MailList",t.REMOVE_ALL_MAIL="REMOVE_ALL_MAIL",t.GET_PRIZE="GET_PRIZE",t}();t.MessageConst=e,__reflect(e.prototype,"message.MessageConst")}(message||(message={}));var message;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="PrizeItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.initData=function(t){99==t.itemid?this._type.source="msg_icon_1":this._type.source="msg_icon_2",this._numTxt.text="x"+t.itemnum,this._type.anchorOffsetX=this._type.width/2,this._type.anchorOffsetY=this._type.height/2},e.prototype.destroy=function(){uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},e}(eui.Component);t.PrizeItem=e,__reflect(e.prototype,"message.PrizeItem")}(message||(message={}));var message;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName="EmailItemSkin",t.addEvent(),t}return __extends(i,e),i.prototype.addEvent=function(){this._getBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openEmail,this),this._lookBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openEmail,this)},i.prototype.getPrize=function(){var t=new Cmd.GetListMailCmd_C;t.mailtype=0,NetMgr.tcpSend(t)},i.prototype.openEmail=function(){var e=new t.EmailVC;uniLib.PopUpMgr.addPopUp(e,null,!0,!0,0,uniLib.PopUpEffect.CENTER),e.initData(this.mailData)},i.prototype.dataChanged=function(){var t=this.data;t.attachment?(this._lookBtn.visible=!1,this._getBtn.visible=!0):(this._lookBtn.visible=!0,this._getBtn.visible=!1),this._titleTxt.text=t.subject,this._msg.text=t.outline,this._timeTxt.text=this.changeHour(t.stamp),this.mailData=t},i.prototype.changeHour=function(t){var e,i=(new Date).getTime(),s=(i/1e3-t)/3600;return e=.1>s?"0小时之前":s>=24?(s/24).toFixed(1)+"天之前":s.toFixed(1)+"小时之前"},i.prototype.removeEvent=function(){this._getBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openEmail,this),this._lookBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openEmail,this)},i.prototype.destroy=function(){this.removeEvent(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},i}(eui.ItemRenderer);t.SysItem=e,__reflect(e.prototype,"message.SysItem")}(message||(message={}));var Cmd;!function(t){function e(t){0==t.resultCode&&uniLib.Global.dispatchEvent(message.MessageConst.GET_MAILLIST,t)}function i(t){0==t.resultCode&&(1==t.opType?uniLib.Global.dispatchEvent(message.MessageConst.GET_PRIZE,t):uniLib.Global.dispatchEvent(message.MessageConst.REMOVE_ALL_MAIL,t))}function s(t){0==t.resultCode&&uniLib.Global.dispatchEvent(message.MessageConst.GET_PRIZE,t)}function n(t){0==t.resultCode&&uniLib.Global.dispatchEvent(message.MessageConst.REMOVE_ALL_MAIL,t)}t.OnGetListMailCmd_S=e,t.OnBulkOperationMailCmd_S=i,t.OnGetMailRewardCmd_S=s,t.OnDeleteMailCmd_S=n}(Cmd||(Cmd={}));