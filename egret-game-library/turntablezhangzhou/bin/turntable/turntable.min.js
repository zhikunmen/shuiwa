var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},turntable;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="TurnTableSkin",t}return __extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this)},n.prototype.addEvent=function(){uniLib.Global.addEventListener(t.TurntableConst.IntoZZTurnTableLobby,this.setData,this),uniLib.Global.addEventListener(t.TurntableConst.ZZTurnTableLobby,this.goLuckDraw,this),uniLib.Global.addEventListener(t.TurntableConst.GetZZTurnTableRecordsLobby,this.showRecord,this),uniLib.Global.addEventListener(t.TurntableConst.OpenRedPackLobby,this.RedPack,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchEvent,this)},n.prototype.removeEvent=function(){uniLib.Global.removeEventListener(t.TurntableConst.IntoZZTurnTableLobby,this.setData,this),uniLib.Global.removeEventListener(t.TurntableConst.ZZTurnTableLobby,this.goLuckDraw,this),uniLib.Global.removeEventListener(t.TurntableConst.GetZZTurnTableRecordsLobby,this.showRecord,this),uniLib.Global.removeEventListener(t.TurntableConst.OpenRedPackLobby,this.RedPack,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchEvent,this)},n.prototype.initUI=function(){var e=RES.getRes("TabletTask_json");e.forEach(function(t){MJLobbyData.getInstance().tabletask[t.id]=t});var n=RES.getRes("TableGoodsConfig_json");n.forEach(function(t){MJLobbyData.getInstance().goods[t.goodId]=t}),this._dailyTasksBtn.selected=!0,this.updateShow(),this.turntable1.alpha=0,egret.Tween.get(this.turntable,{loop:!0}).to({alpha:0},500).to({alpha:1},500),egret.Tween.get(this.turntable1,{loop:!0}).to({alpha:1},500).to({alpha:0},500),this._taskList.itemRenderer=t.TurnTableTaskItemPanel,this._recordList.itemRenderer=t.TurnTableRecordItemPanel},n.prototype.setData=function(t){this.data=t.param,this.data&&(this._integralText.text=this.data.integral+"",this._moneyText.text="红包金额（满10元才能领取）："+this.data.money+"元",this.updateTaskList())},n.prototype.updateTaskList=function(){this._taskListAC?(Array.isArray(this._taskListAC.source)&&this._taskListAC.removeAll(),this._taskListAC.replaceAll(this.data.tasks)):(this._taskListAC=new eui.ArrayCollection(this.data.tasks),this._taskList.dataProvider=this._taskListAC)},n.prototype.goLuckDraw=function(t){var e=t.param;this.data.integral=e.integral,this._integralText.text=this.data.integral+"",this.data.money=e.money,this._moneyText.text="红包金额（满10元才能领取）："+this.data.money+"元",this.beginTurnTable(e)},n.prototype.RedPack=function(t){var e=t.param;this.data.money=this.data.money-e.info.reward,this._moneyText.text="红包金额（满10元才能领取）："+this.data.money.toFixed(2)+"元";var n=new Cmd.RewardItem;n.goodId=353,n.goodNbr=e.info.reward,LobbyModuleMgr.getInstance().showAwardPanel2(n)},n.prototype.getRecord=function(){var t=new Cmd.GetZZTurnTableRecordsLobbyCmd_CS;NetMgr.tcpSend(t)},n.prototype.showRecord=function(t){var e=t.param;this._recordData=e.records,this.updateRecordList()},n.prototype.updateRecordList=function(){Array.isArray(this._recordData)?(this._tipsText.visible=!1,this._recordListAC?(Array.isArray(this._recordListAC.source)&&this._recordListAC.removeAll(),this._recordListAC.replaceAll(this._recordData)):(this._recordListAC=new eui.ArrayCollection(this._recordData),this._recordList.dataProvider=this._recordListAC)):this._tipsText.visible=!0},n.prototype.beginTurnTable=function(t){var e=this;this.cjImg.touchEnabled=!1;var n=0;switch(t.reward.goodId){case 341:n=5;break;case 342:n=3;break;case 343:n=1;break;case 353:n=4;break;case 32:if(388==t.reward.goodNbr){n=6;break}n=2}var r=2160-60*n;egret.Tween.get(this.turnTable).to({rotation:r+15},5800,egret.Ease.sineInOut).to({rotation:r-10},800,egret.Ease.sineInOut).to({rotation:r},500,egret.Ease.sineInOut).call(function(){e.sgEffect.visible=!0,egret.Tween.get(e.sgEffect).to({rotation:360},400).to({alpha:0},400).call(function(){e.sgEffect.visible=!1,e.sgEffect.alpha=1,e.cjImg.touchEnabled=!0,LobbyModuleMgr.getInstance().showAwardPanel2(t.reward);var n=new Cmd.UserInfoGetLobbyCmd_C;n.uid=uniLib.NetMgr.UID,n.lobbyId=NetMgr.getLoginCfg().lobbyId,NetMgr.tcpSend(n)})})},n.prototype.onTouchEvent=function(t){switch(t.target){case this._closebtn:this.destroy();break;case this.cjImg:if(this.data.integral>=10){var e=new Cmd.ZZTurnTableLobbyCmd_CS;NetMgr.tcpSend(e)}else uniLib.TipsUtils.showTipsDownToUp("积分不足，完成任务可获得积分！");break;case this._receiveBtn:if(this.data.money>=10){var e=new Cmd.OpenRedPackLobbyCmd_C;e.lobbyId=MJLobbyData.getInstance().lobbyId,e.typ=3,NetMgr.tcpSend(e)}else uniLib.TipsUtils.showTipsDownToUp("红包金额不满10元！");break;case this._drawRecordBtn:this.getRecord(),this.updateShow();break;case this._dailyTasksBtn:this.updateShow()}},n.prototype.updateShow=function(){this._drawRecordBtn.selected?(this._recordGroup.visible=!0,this._taskGroup.visible=!1):(this._recordGroup.visible=!1,this._taskGroup.visible=!0)},n.prototype.destroy=function(){e.prototype.destroy.call(this),egret.Tween.removeTweens(this.turnTable),egret.Tween.removeTweens(this.turntable),egret.Tween.removeTweens(this.turntable1),egret.Tween.removeTweens(this.sgEffect),this.removeEvent(),uniLib.PopUpMgr.removePopUp(this,uniLib.PopUpEffect.NOMAL)},n}(commonpanel.LobbyBaseEuiPanel);t.TurnTable=e,__reflect(e.prototype,"turntable.TurnTable")}(turntable||(turntable={}));var turntable;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="TurnTableRecordItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){this._info=this.data,this._timeText.text=LobbyUtils.changeTimeToStr(this._info.time)+"获得",this._prizeText.text=MJLobbyData.getInstance().goods[this._info.goodId].goodDesc+this._info.goodNbr,this._prizeText.x=this._timeText.x+this._timeText.width,this.itemIndex%2==0?this._bg.source="mjl_turntable_json.mjl_turntable_item1":this._bg.source="mjl_turntable_json.mjl_turntable_item2"},e}(eui.ItemRenderer);t.TurnTableRecordItemPanel=e,__reflect(e.prototype,"turntable.TurnTableRecordItemPanel")}(turntable||(turntable={}));var turntable;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="TurnTableTaskItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){this._info=this.data,this._taskText.text=MJLobbyData.getInstance().tabletask[this._info.taskId].name,this._processText.text=this._info.nbr+"/"+MJLobbyData.getInstance().tabletask[this._info.taskId].frequency,this.itemIndex%2==0?this._bg.source="mjl_turntable_json.mjl_turntable_item1":this._bg.source="mjl_turntable_json.mjl_turntable_item2"},e}(eui.ItemRenderer);t.TurnTableTaskItemPanel=e,__reflect(e.prototype,"turntable.TurnTableTaskItemPanel")}(turntable||(turntable={}));var turntable;!function(t){var e=function(){function t(){}return t.RES_JSON="resource/turntable/turntable.res_8a8cd4ed.json",t.THM_JSON="resource/turntable/gameEui_d44df6c8.json",t.PUB_TURNTABLE="pub_turntable",t.SUCCESS=0,t.IntoZZTurnTableLobby="IntoZZTurnTableLobby",t.ZZTurnTableLobby="ZZTurnTableLobby",t.GetZZTurnTableRecordsLobby="GetZZTurnTableRecordsLobby",t.OpenRedPackLobby="OpenRedPackLobby",t.CANTURNTABLE="canTurnTable",t}();t.TurntableConst=e,__reflect(e.prototype,"turntable.TurntableConst")}(turntable||(turntable={}));var turntable;!function(t){var e=function(){function t(){this.canTurnTable=!1}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t}();t.TurntableData=e,__reflect(e.prototype,"turntable.TurntableData")}(turntable||(turntable={}));var Cmd;!function(t){function e(t,e,n){void 0===n&&(n=!0),uniLib.Global.dispatchEvent(t,e,n)}function n(t){t.resultCode||(t.resultCode=turntable.TurntableConst.SUCCESS),t.resultCode==turntable.TurntableConst.SUCCESS&&e(turntable.TurntableConst.OpenRedPackLobby,t)}function r(t){t.resultCode||(t.resultCode=turntable.TurntableConst.SUCCESS),t.resultCode==turntable.TurntableConst.SUCCESS&&(e(turntable.TurntableConst.ZZTurnTableLobby,t),0==t.integral&&(turntable.TurntableData.getInstance().canTurnTable=!1,e(turntable.TurntableConst.CANTURNTABLE)))}function a(t){t.resultCode||(t.resultCode=turntable.TurntableConst.SUCCESS),t.resultCode==turntable.TurntableConst.SUCCESS&&e(turntable.TurntableConst.IntoZZTurnTableLobby,t)}function o(t){t.resultCode||(t.resultCode=turntable.TurntableConst.SUCCESS),t.resultCode==turntable.TurntableConst.SUCCESS&&e(turntable.TurntableConst.GetZZTurnTableRecordsLobby,t)}t.TurntableDispatch=e,t.OnOpenRedPackLobbyCmd_S=n,t.OnZZTurnTableLobbyCmd_CS=r,t.OnIntoZZTurnTableLobbyCmd_CS=a,t.OnGetZZTurnTableRecordsLobbyCmd_CS=o}(Cmd||(Cmd={}));var turntable;!function(t){var e=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t}();t.TurntableModuleMgr=e,__reflect(e.prototype,"turntable.TurntableModuleMgr")}(turntable||(turntable={}));var turntable;!function(t){var e=function(){function t(){}return t.ExchangeRequest=function(t,e){var n=new Cmd.BackpackExchangeRequestBackpackCmd_C,r=new Cmd.BackpackInfo;r.goodId=e,r.number=t,n.backpackInfo=r,NetMgr.tcpSend(n)},t}();t.TurntableSendMgr=e,__reflect(e.prototype,"turntable.TurntableSendMgr")}(turntable||(turntable={}));